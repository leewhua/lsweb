var __reflect=this&&this.__reflect||function(t,e,a){t.__class__=e,a?a.push(e):a=[e],t.__types__=t.__types__?a.concat(t.__types__):a},__extends=this&&this.__extends||function(t,e){function a(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)},PopView=function(t){function e(){var e=t.call(this)||this;return e.x=0,e.y=0,e.view=new egret.Sprite,e}return __extends(e,t),e.prototype.show=function(t,e,a){void 0===t&&(t=!1),void 0===e&&(e=!0),void 0===a&&(a=!0);var i=0;t&&(i=500);var n=new egret.Shape;if(n.graphics.beginFill(0,.6),n.graphics.drawRect(0,0,1200,640),this.view.scaleY=Main.scale,this.view.x=600,this.view.y=320,e&&this.addChild(n),this.addChild(this.view),n.alpha=this.view.alpha=0,Global.fadeIn(n),this.view.scaleX=this.view.scaleY=.6,a){var o=egret.Tween.get(this.view);o.wait(i),o.to({alpha:1,scaleX:1,scaleY:Main.scale},500,egret.Ease.backOut)}},e.prototype.out=function(){Global.fadeOut(this);var t=egret.Tween.get(this.view);t.to({scaleX:1.2,scaleY:1.2},400,egret.Ease.cubicIn),t.call(function(){this.parent&&this.parent.removeChild(this)})},e}(egret.Sprite);__reflect(PopView.prototype,"PopView");var GameInfo=function(){function t(){}return t}();GameInfo.enemy_gun=0,GameInfo.play_ren=-1,GameInfo.hb=0,GameInfo.sco=0,GameInfo.gun=0,GameInfo.level=1,GameInfo.guns=[{type:0}],GameInfo.gunsInshop=[{type:1,has:0},{type:2,has:0},{type:3,has:0},{type:4,has:0}],GameInfo.gunSelect=0,GameInfo.gunData=[{type:0,name:"常规",sco:0,star:1,damage:[15,10,5],id:0},{type:1,name:"幽灵射线",sco:200,star:2,damage:[20,15,10],id:0},{type:2,name:"极速终结者",sco:500,star:3,damage:[40,35,30],id:0},{type:3,name:"Merlin-II",sco:1e3,star:4,damage:[60,55,50],id:0},{type:4,name:"艾德曼合金",sco:2e3,star:5,damage:[80,75,70],id:0}],__reflect(GameInfo.prototype,"GameInfo");var EnemyBar=function(t){function e(){var e=t.call(this)||this;e.sco=1,e.scaleY=Main.scale,e.maskShape=new egret.Shape,e.maskShape.graphics.beginFill(0,1),e.maskShape.graphics.drawRect(0,0,-298,28);var a=Global.createBitmapByName("p_line_bg_png"),i=Global.createBitmapByName("p_line_png");e.face=new FaceBar;var n=new egret.TextField;return n.size=26,n.textAlign="right",n.textColor=0,n.width=200,n.y=10,n.x=-350,n.text="****",a.x=-404,a.y=45,i.x=-397,e.maskShape.y=i.y=52,e.maskShape.x=i.x+298,e.face.x=-136,e.addChild(a),e.addChild(i),e.addChild(e.face),e.addChild(e.maskShape),e.addChild(n),i.mask=e.maskShape,e.x=1180,e.y=20,e.search(),e}return __extends(e,t),e.prototype.hit=function(t,e){t=3-t;var a=GameInfo.gunData[e].damage;console.log(e,GameInfo.gunData[e],a[t]),this.sco-=a[t]/100,this.sco<=0&&(this.sco=0),this.maskShape.scaleX=.95*this.sco+.05,0==this.sco&&0==GameInfo.hb&&this.dispatchEvent(new EventObj("event","win",!0))},e.prototype.search=function(){var t=Math.floor(60*Math.random())+1;this.face.loadFace("resource/face/"+t+".jpg");setTimeout(function(){},2e3)},e}(egret.Sprite);__reflect(EnemyBar.prototype,"EnemyBar");var FaceBar=function(t){function e(){var e=t.call(this)||this,a=Global.createBitmapByName("face_bg_png");return e.addChild(a),e}return __extends(e,t),e.prototype.loadFace=function(t){var e=new egret.URLLoader;e.dataFormat=egret.URLLoaderDataFormat.TEXTURE,e.addEventListener(egret.Event.COMPLETE,this.onLoadComplete,this);var a=new egret.URLRequest(t);e.load(a)},e.prototype.onLoadComplete=function(t){var e=t.target,a=e.data,i=new egret.Bitmap(a),n=new egret.Shape;n.graphics.beginFill(0,1),n.graphics.drawCircle(60,60,60),i.x=0,i.y=0,i.width=i.height=128,n.x=4,n.y=4,this.addChild(i),this.addChild(n),i.mask=n,i.alpha=0,Global.fadeIn(i)},e}(egret.Sprite);__reflect(FaceBar.prototype,"FaceBar");var FlyBar=function(t){function e(){var e=t.call(this)||this;e.touchEnabled=!0;var a=Global.createBitmapByName("p_thunder_png");return a.x=a.width/-2,a.y=a.height/-2,e.addChild(a),e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,e.touchBeginHander,e),e.addEventListener(egret.TouchEvent.TOUCH_END,e.touchEndHander,e),e.x=1092,e.y=518,e}return __extends(e,t),e.prototype.touchBeginHander=function(t){this.alpha=.6},e.prototype.touchEndHander=function(t){this.alpha=1},e}(egret.Sprite);__reflect(FlyBar.prototype,"FlyBar");var GrenadeBar=function(t){function e(){var e=t.call(this)||this;e.touchEnabled=!0;var a=Global.createBitmapByName("p_thunder_png");return a.x=a.width/-2,a.y=a.height/-2,e.addChild(a),e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,e.touchBeginHander,e),e.addEventListener(egret.TouchEvent.TOUCH_END,e.touchEndHander,e),e.x=1092,e.y=518,e.scaleY=Main.scale,e}return __extends(e,t),e.prototype.touchBeginHander=function(t){this.alpha=.6,this.dispatchEvent(new EventObj("event","boom",!0))},e.prototype.touchEndHander=function(t){this.alpha=1},e}(egret.Sprite);__reflect(GrenadeBar.prototype,"GrenadeBar");var GunBar=function(t){function e(e,a){void 0===a&&(a=!1);var i=t.call(this)||this;return i.info=a,i.type=e,i.setType(e),i}return __extends(e,t),e.prototype.setType=function(t){for(;this.numChildren>0;)this.removeChildAt(0);this.type=t;var e=Global.createBitmapByName("g"+t+"_png");if(e.x=e.width/-2,e.y=e.height/-2,this.addChild(e),this.info){var a=new egret.TextField;a.size=32,a.textAlign="center",a.textColor=16777215,a.width=117,a.y=20,a.x=170,a.text=GameInfo.gunData[this.type].sco.toString();var i=Global.createBitmapByName("buy_jf_png",170,0),n=new Middle(Global.createBitmapByName("gun_name"+this.type+"_png"),0,-130),o=GameInfo.gunData[this.type].star;this.addChild(i),this.addChild(a),this.addChild(n);for(var s,r=0;5>r;r++)s=o>r?Global.createBitmapByName("buy_star1_png",-100+36*r,100):Global.createBitmapByName("buy_star2_png",-100+36*r,100),this.addChild(s)}},e}(egret.Sprite);__reflect(GunBar.prototype,"GunBar");var GunMiniBar=function(t){function e(e){var a=t.call(this)||this;a.type=e;var i=new egret.Shape;i.graphics.beginFill(0,0),i.graphics.drawRect(-60,-60,120,120);var n=Global.createBitmapByName("g"+e+"_png");return n.scaleX=n.scaleY=.2,n.x=n.width/-2*.2,n.y=n.height/-2*.2,a.addChild(i),a.addChild(n),Global.setBut(a),a.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){this.dispatchEvent(new EventObj("event","select_gun",!0,!1,this.type))},a),a}return __extends(e,t),e.prototype.lock=function(){this.touchEnabled=!1,this.alpha=.3},e}(egret.Sprite);__reflect(GunMiniBar.prototype,"GunMiniBar");var GunRenBar=function(t){function e(e,a){var i=t.call(this)||this;if(i.type=e,i.x=-660,i.y=-280,i.scaleX=i.scaleY=1.8,0==e&&(i.scaleX=-1.8,i.x=-140),1==e){var n=Global.createBitmapByRes("r"+e+"_w_json","r1_stand");i.addChild(n),i.x=-620}else{var n=Global.createBitmapByName("r"+i.type+"_stand_png");i.addChild(n)}return i.setGun(a),i}return __extends(e,t),e.prototype.setGun=function(t){1==this.type?(Global.remove(this.gunSp),this.gunSp=Global.createBitmapByRes("r1_w_json","r1_gun"+t),this.addChildAt(this.gunSp,0)):(Global.remove(this.gunSp),this.gunSp=Global.createMc("r_g"+t+"_json","r_g"+t+"_png","r_g"+t),this.gunSp.gotoAndStop(0),this.addChild(this.gunSp))},e}(egret.Sprite);__reflect(GunRenBar.prototype,"GunRenBar");var JfBar=function(t){function e(){var e=t.call(this)||this;e.sco=1,e.scaleY=Main.scale,e.scoTxt=new egret.TextField;var a=new egret.TextField;a.size=26,a.textAlign="right",a.textColor=16777215,a.width=200,a.y=20,a.x=-310,e.scoTxt.size=26,e.scoTxt.textAlign="right",e.scoTxt.textColor=16777215,e.scoTxt.width=200,e.scoTxt.y=52,e.scoTxt.x=-310;var i=new FaceBar;return e.addChild(i),e.addChild(a),e.addChild(e.scoTxt),e.x=1180,e.y=20,i.scaleX=i.scaleY=.78125,i.x=-100,i.loadFace(Api.user.headimgurl),a.text=Api.user.nickname,e.reSetSco(),e}return __extends(e,t),e.prototype.reSetSco=function(){},e}(egret.Sprite);__reflect(JfBar.prototype,"JfBar");var MineBar=function(t){function e(){var e=t.call(this)||this;e.sco=1,e.scaleY=Main.scale,e.maskShape=new egret.Shape,e.maskShape.graphics.beginFill(0,1),e.maskShape.graphics.drawRect(0,0,298,28);var a=new egret.TextField;a.size=26,a.textAlign="left",a.textColor=0,a.width=200,a.y=10,a.x=150,a.text=Api.user.nickname;var i=Global.createBitmapByName("p_line_bg_png"),n=Global.createBitmapByName("p_line_png"),o=new FaceBar;return i.scaleX=-1,i.x=418,i.y=45,e.maskShape.x=n.x=112,e.maskShape.y=n.y=52,e.addChild(i),e.addChild(n),e.addChild(o),e.addChild(e.maskShape),e.addChild(a),n.mask=e.maskShape,e.x=20,e.y=20,o.loadFace(Api.user.headimgurl),e}return __extends(e,t),e.prototype.hit=function(t,e){t=3-t;var a=GameInfo.gunData[e].damage;console.log("2L",e,GameInfo.gunData[e],a[t]),this.sco-=a[t]/100,this.sco<=0&&(this.sco=0),this.maskShape.scaleX=.95*this.sco+.05,0==this.sco&&this.dispatchEvent(new EventObj("event","lost",!0))},e}(egret.Sprite);__reflect(MineBar.prototype,"MineBar");var PlayRenBar=function(t){function e(e,a,i){void 0===i&&(i=!1);var n=t.call(this)||this;n.type=0,n.speed=3,n.nowLab=null,n.lock=!1,n.a=!0,n.time=0,n.aiStatus=0,n.toX=0,n.aiSc=0,n.gun=a,n.type=e,n.view=new egret.Sprite,n.renSp=new egret.Sprite;var o=.8;return n.sc=o,n.view.scaleX=n.view.scaleY=o,n.a=i,1==i||(n.view.scaleX=-o),n.renSp.x=-150,n.renSp.y=-300,n.addChild(n.view),3>e?(n.gunSp=Global.createMc("r_g"+a+"_json","r_g"+a+"_png","r_g"+a),n.gunSp.x=-150,n.gunSp.y=-300,n.view.addChild(n.renSp),n.view.addChild(n.gunSp)):(n.gunSp=Global.createMc("r3_json","r3_png","r3_bag"),n.ren=Global.createMc("r3_json","r3_png","r3"),n.gunSp.x=-150,n.gunSp.y=-300,n.ren.gotoAndStop(0),n.gunSp.gotoAndStop(0),n.renSp.addChild(n.ren),n.view.addChild(n.gunSp),n.view.addChild(n.renSp)),n.play("stand"),n}return __extends(e,t),e.prototype.removeAll=function(t){t.numChildren>0&&t.removeChildAt(0)},e.prototype.play=function(t){var e,a=this;if(!this.lock&&this.nowLab!=t){if("stand"==t)this.type<3?(e=Global.createBitmapByName("r"+this.type+"_stand_png"),this.removeAll(this.renSp),this.renSp.addChild(e),this.gunSp.gotoAndStop(0)):(this.ren.gotoAndStop(0),this.gunSp&&this.gunSp.gotoAndStop(0));else if("run"==t)if(console.log("run"),this.type<3){var i=Global.createMc("r"+this.type+"_mc_json","r"+this.type+"_mc_png","r"+this.type);i.gotoAndPlay(0,-1),this.gunSp.gotoAndPlay(0,-1),this.removeAll(this.renSp),this.renSp.addChild(i)}else this.ren.gotoAndPlay(0,-1),this.gunSp&&this.gunSp.gotoAndPlay(0,-1);else"shoot"==t?(a.play("stand"),this.lock=!0,this.a?this.dispatchEvent(new EventObj("event","right_shoot",!0)):this.dispatchEvent(new EventObj("event","left_shoot",!0)),setTimeout(function(){a.lock=!1,a.play("stand")},1e3)):"boom"==t?(this.a?this.dispatchEvent(new EventObj("event","right_boom",!0)):this.dispatchEvent(new EventObj("event","left_boom",!0)),e=Global.createBitmapByName("r"+this.type+"_stand_png"),this.removeAll(this.renSp),this.renSp.addChild(e),this.gunSp.gotoAndStop(0),this.lock=!0,setTimeout(function(){a.lock=!1,a.play("stand")},2e3)):"away"==t&&(this.aiStatus=4,this.gunSp.stop(),this.ren.scaleX=-1,this.renSp.x=150,this.ren.play(-1),this.dispatchEvent(new EventObj("event","away",!0,!1,this.gunSp)),this.gunSp=null);this.nowLab=t}},e.prototype.check=function(t){var e=t.x-this.x,a=t.y-this.y;if(e>-40&&40>e){if(a>-220&&-180>a)return 3;if(a>-180&&100>a)return 2;if(a>-100&&0>a)return 1}return 0},e.prototype.getBullet=function(){var t,e,a;return this.a?(t=new BulletBar(-1),e=this.x+-93*this.sc,a=this.y-134*this.sc):(t=new BulletBar,e=this.x+93*this.sc,a=this.y-134*this.sc),t.x=e,t.y=a,t},e.prototype.move=function(t){if(!this.lock){var a=this.speed;if(this.a){var i,n=163/127,o=this.x;-1==t?o-=a:1==t&&(o+=a),o>e.rightX[0]?4!=this.aiStatus&&(o=e.rightX[0]):o<e.rightX[1]&&(o=e.rightX[1]),i=(o-e.rightX[0])/n+e.initY[1],this.x=o,this.y=i,this.play("run")}else{var i,n=186/-108,o=this.x;-1==t?o-=a:1==t&&(o+=a),o<e.leftX[0]?o=e.leftX[0]:o>e.leftX[1]&&4!=this.aiStatus&&(o=e.leftX[1]),i=(o-e.leftX[0])/n+e.initY[0],this.x=o,this.y=i,this.play("run")}}},e.prototype.getScX=function(t){return t*(e.rightX[1]-e.rightX[0])+e.rightX[0]},e.prototype.playAi=function(){if(this.time++,3==this.type&&4!=this.aiStatus&&this.time>200)return void this.play("away");if(!this.lock)if(0==this.aiStatus)this.aiSc>.6?this.aiSc=Math.random():this.aiSc=.6*Math.random()+.4,this.toX=this.getScX(this.aiSc),this.aiStatus=1;else if(1==this.aiStatus){var t=this.toX-this.x;Math.abs(t)<this.speed?this.aiStatus=2:t>0?this.move(1):this.move(-1)}else if(2==this.aiStatus){var e=Math.random();e>.5?this.type<3&&this.aiSc>.6?(this.play("shoot"),Math.random()>.8&&(this.aiStatus=0)):Math.random()>.8&&(this.aiStatus=0):e>.3||(this.aiStatus=0)}else 4==this.aiStatus&&this.move(1)},e}(egret.Sprite);PlayRenBar.leftX=[30,216],PlayRenBar.initY=[560,600],PlayRenBar.rightX=[1150,987],__reflect(PlayRenBar.prototype,"PlayRenBar");var SelectRenBar=function(t){function e(e){var a=t.call(this)||this;a.inActive=!1,a.type=e;var i=Global.createBitmapByName("r_bg_png",-213.5,-214);a.over=Global.createBitmapByName("r_black_png",-165.5,-190);var n=Global.createBitmapByName("r"+e+"_png",-165.5,-190);return a.but=new Middle(Global.createBitmapByName("r_s_png"),0,190),a.addChild(i),a.addChild(n),a.addChild(a.over),a.but.alpha=1,Global.setBut(a.but),a.touchEnabled=!0,a.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){this.dispatchEvent(new EventObj("event","active_ren",!0,!1,this.type))},a),a.but.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){this.dispatchEvent(new EventObj("event","select_ren",!0,!1,this.type))},a),a}return __extends(e,t),e.prototype.active=function(t){this.inActive!=t&&(this.inActive=t,t?(this.addChild(this.but),Global.fadeOut(this.over)):(this.addChild(this.over),Global.fadeIn(this.over),this.but.parent&&this.but.parent.removeChild(this.but)))},e}(egret.Sprite);__reflect(SelectRenBar.prototype,"SelectRenBar");var ShootBar=function(t){function e(){var e=t.call(this)||this;e.scaleY=Main.scale,e.touchEnabled=!0;var a=Global.createBitmapByName("p_shoot_png");return a.x=a.width/-2,a.y=a.height/-2,e.addChild(a),e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,e.touchBeginHander,e),e.addEventListener(egret.TouchEvent.TOUCH_END,e.touchEndHander,e),e.x=997,e.y=558,e}return __extends(e,t),e.prototype.touchBeginHander=function(t){this.alpha=.6,this.dispatchEvent(new EventObj("event","shoot",!0))},e.prototype.touchEndHander=function(t){this.alpha=1},e}(egret.Sprite);__reflect(ShootBar.prototype,"ShootBar");var TipBar=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(egret.Sprite);__reflect(TipBar.prototype,"TipBar");var Action=function(){function t(){}return t.linkTo=function(t,e){void 0===e&&(e=!1),e&&Api.cookie("page",t,{expires:1}),window.location.href=t},t.toCookiePage=function(){var e=Api.cookie("ticket"),a=Api.cookie("page");Api.user_ticket==e&&"exchange"==a&&t.linkTo(a),Api.cookie("ticket",Api.user_ticket,{expires:1})},t}();__reflect(Action.prototype,"Action");var Api=function(){function t(){}return t.load=function(t,e,a,i,n,o,s){void 0===n&&(n=null),void 0===o&&(o=null),void 0===s&&(s=!0),console.log("api load:"+t),a.ran=Math.random()*(new Date).getTime()+(new Date).getTime(),$.ajax({url:e,data:a,success:function(t){n&&n.call(i,t)},error:function(){o?o.call(i):Main._main.dispatchEvent(new EventObj("event","msg_event",!0,!1,MsgPop.at_upgrade))},timeout:8e3,dataType:"json",async:s,type:"POST",complete:function(t,e){"timeout"==e&&Main._main.dispatchEvent(new EventObj("event","msg_event",!0,!1,MsgPop.at_time_out))}})},t.getTicket=function(){var e,a=window.location.href.split("#")[0].split("?")[1];return console.log("getTicket"),a&&a.length>20?(e=a.split(","),t.user_ticket=e[0],t.status_ticket=e[1],console.log(t.user_ticket,t.status_ticket),!0):!1},t.reSetShareUrl=function(){var e=t.user,a=e.headimgurl.split("http://")[1],i=encodeURIComponent(e.nickname),n="",o=$.shareObj;o.link="http://res.leasiondata.cn/lstatic/r/share.html?f="+a+"&n="+i+"&a="+n,$.setWxObj()},t.cookie=function(t,e,a){if(void 0===e&&(e=void 0),void 0===a&&(a=void 0),"undefined"==typeof e){var i=null;if(document.cookie&&""!=document.cookie)for(var n=document.cookie.split(";"),o=0;o<n.length;o++){var s=jQuery.trim(n[o]);if(s.substring(0,t.length+1)==t+"="){i=decodeURIComponent(s.substring(t.length+1));break}}return i}a=a||{},null===e&&(e="",a=$.extend({},a),a.expires=-1);var r="";if(a.expires&&("number"==typeof a.expires||a.expires.toUTCString)){var h;"number"==typeof a.expires?(h=new Date,h.setTime(h.getTime()+24*a.expires*60*60*1e3)):h=a.expires,r="; expires="+h.toUTCString()}var l=a.path?"; path="+a.path:"",p=a.domain?"; domain="+a.domain:"",d=a.secure?"; secure":"";document.cookie=[t,"=",encodeURIComponent(e),r,l,p,d].join("")},t}();Api.city_url="http://0k6.cn/t/goplaycity",Api.user_api_url="http://leasiondata.cn/info",Api.play_url="http://leasiondata.cn/play",Api.user_buy_url="http://play.leasiondata.cn/newplaycity/exprize",Api.user_ticket="d82cf56540134d6f93fb88d3edf5dc50",Api.status_ticket="136c4f5463e047deb8e797c5a94280dc",Api.code_api_url="http://123.59.156.230/newinputcode",Api.verify_path="http://123.59.156.230/lstatic/verify/",Api.buy_list_url="http://play.leasiondata.cn/newplaycity/gift",Api.user=null,Api.browser="weixin",Api.award={type:"cash",count:1},__reflect(Api.prototype,"Api");var Buttom=function(t){function e(e,a,i,n){void 0===a&&(a=null),void 0===i&&(i=0),void 0===n&&(n=0);var o=t.call(this)||this;return o.addChild(e),o.x=i,o.y=n,Global.setBut(o),o}return __extends(e,t),e}(egret.Sprite);__reflect(Buttom.prototype,"Buttom");var EventObj=function(t){function e(e,a,i,n,o){var s=t.call(this,e,i,n,o)||this;return s.name=a,s.data=o,s}return __extends(e,t),e}(egret.Event);__reflect(EventObj.prototype,"EventObj");var ControlBar=function(t){function e(){var e=t.call(this)||this;e.localX=0,e.scaleY=Main.scale,e.touchEnabled=!0;var a=Global.createBitmapByName("c_bg_png");return e.point=new Middle(Global.createBitmapByName("c_m_png")),a.x=a.width/-2,a.y=a.height/-2,e.point.x=0,e.point.y=0,e.addChild(a),e.addChild(e.point),e.x=180,e.y=525,e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,e.touchBeginHander,e),e.addEventListener(egret.TouchEvent.TOUCH_MOVE,e.touchMoveHander,e),e.addEventListener(egret.TouchEvent.TOUCH_END,e.touchEndHander,e),e.addEventListener(egret.TouchEvent.TOUCH_CANCEL,e.touchEndHander,e),e.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,e.touchEndHander,e),e}return __extends(e,t),e.prototype.touchBeginHander=function(t){this.localX=t.localX,this.addEventListener(egret.Event.ENTER_FRAME,this.loop,this)},e.prototype.loop=function(t){this.localX<0?(this.dispatchEvent(new EventObj("event","left",!0)),this.point.x=-18):this.localX>=0&&(this.dispatchEvent(new EventObj("event","right",!0)),this.point.x=18)},e.prototype.touchMoveHander=function(t){this.localX=t.localX},e.prototype.touchEndHander=function(t){this.removeEventListener(egret.Event.ENTER_FRAME,this.loop,this),this.point.x=0,this.dispatchEvent(new EventObj("event","control_end",!0))},e}(egret.Sprite);__reflect(ControlBar.prototype,"ControlBar");var Global=function(){function t(){}return t.createBitmapByRes=function(t,e){var a=new egret.Bitmap,i=RES.getRes(t);return console.log("name::"+e+"::"+t),a.texture=i.getTexture(e),a},t.createBitmapByName=function(t,e,a){void 0===e&&(e=0),void 0===a&&(a=0);var i=new egret.Bitmap,n=RES.getRes(t);return i.texture=n,i.x=e,i.y=a,i},t.fadeIn=function(e,a,i,n){void 0===a&&(a=0),void 0===i&&(i=500),void 0===n&&(n=1),t.tweenFrom(e,a,i,0,0,n,egret.Ease.cubicOut)},t.fadeOut=function(e,a,i,n){void 0===a&&(a=0),void 0===i&&(i=500),void 0===n&&(n=1),t.tweenToHide(e,a,i,0,0,n,egret.Ease.cubicOut)},t.zoomIn=function(e,a,i,n){void 0===a&&(a=0),void 0===i&&(i=500),void 0===n&&(n=.6),t.tweenFrom(e,a,i,0,0,n,egret.Ease.backOut)},t.zoomOut=function(e,a,i,n){void 0===a&&(a=0),void 0===i&&(i=500),void 0===n&&(n=1.5),t.tweenToHide(e,a,i,0,0,n,egret.Ease.cubicIn)},t.tweenToHide=function(t,e,a,i,n,o,s,r){void 0===r&&(r=0);var h=egret.Tween.get(t),l=t.x,p=t.y;l+=i,p+=n,h.wait(e),h.to({alpha:r,scaleX:o,scaleY:o,x:l,y:p},a,s),h.call(function(){t.parent&&t.parent.removeChild(t)})},t.tweenTo=function(t,e,a,i,n,o,s,r){void 0===o&&(o=1),void 0===s&&(s=1),void 0===r&&(r=egret.Ease.cubicOut);var h=egret.Tween.get(t);h.wait(e),r?h.to({alpha:o,scaleX:s,scaleY:s,x:i,y:n},a,r):h.to({alpha:o,scaleX:s,scaleY:s,x:i,y:n},a)},t.tweenFrom=function(t,e,a,i,n,o,s){var r=egret.Tween.get(t),h=t.x,l=t.y;t.scaleX=t.scaleY=o,t.x=h+i,t.y=l+n,r.wait(e),r.to({alpha:1,scaleX:1,scaleY:1,x:h,y:l},a,s)},t.createMc=function(t,e,a){var i=RES.getRes(t),n=RES.getRes(e),o=new egret.MovieClipDataFactory(i,n),s=new egret.MovieClip(o.generateMovieClipData(a));return s},t.remove=function(t){t&&t.parent&&t.parent.removeChild(t)},t.setBut=function(t){t&&(t.touchEnabled=!0,t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){t.alpha=.68},t),t.addEventListener(egret.TouchEvent.TOUCH_END,function(){t.alpha=1},t),t.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,function(){t.alpha=1},t))},t.getArrayItems=function(t,e){var a=new Array;for(var i in t)a.push(t[i]);for(var n=new Array,o=0;e>o&&a.length>0;o++){var s=Math.floor(Math.random()*a.length);n[o]=a[s],a.splice(s,1)}return n},t}();__reflect(Global.prototype,"Global");var Middle=function(t){function e(e,a,i,n,o){void 0===a&&(a=0),void 0===i&&(i=0),void 0===n&&(n=0),void 0===o&&(o=0);var s=t.call(this)||this;return e.x=e.width/-2+n,e.y=e.height/-2+o,s.x=a,s.y=i,s.view=e,s.addChild(e),s}return __extends(e,t),e}(egret.Sprite);__reflect(Middle.prototype,"Middle");var MsgPop=function(t){function e(){var e=t.call(this)||this;return e.view=new egret.Sprite,e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){this.stageWidth=this.stage.stageWidth,this.stageHeight=this.stage.stageHeight},e.prototype.show=function(t){this.stageWidth=this.stage.stageWidth,this.stageHeight=this.stage.stageHeight;var e=new egret.Shape;e.graphics.beginFill(0,.8),e.graphics.drawRect(0,0,this.stageWidth,this.stageHeight),this.view.x=this.stageWidth/2,this.view.y=this.stageHeight/2;var a=new egret.TextField;a.background=!1,a.x=-200,a.width=400,a.textColor=16777215,a.textAlign="center",a.size=32,a.lineSpacing=12,a.text=t,e.alpha=this.view.alpha=0,Global.fadeIn(e),this.addChild(e),this.addChild(this.view),this.view.addChild(a),this.loadBg()},e.prototype.loadBg=function(){var t="resource/shoot/title.png",e=new egret.URLLoader;e.dataFormat=egret.URLLoaderDataFormat.TEXTURE,e.addEventListener(egret.Event.COMPLETE,this.onLoadComplete,this);var a=new egret.URLRequest(t);e.load(a)},e.prototype.onLoadComplete=function(t){var e=t.target,a=e.data,i=new egret.Bitmap(a);i.x=i.width/-2,i.y=i.height/-2*3,this.view.addChildAt(i,0),Global.zoomIn(this.view)},e}(egret.Sprite);MsgPop.not_exist="很抱歉,查询不到此串码，\n您购买的可能非正品!",MsgPop.err_limit="很抱歉,您串码输错的次数已达到上限，\n请30分钟后再扫码进入！",MsgPop.at_anomaly="很抱歉,网络异常. \n请重新再输入串码参与活动.",MsgPop.at_limit="很抱歉,\n您今日输入串码参与活动次数已超过上限. \n请明日继续来哦!",MsgPop.at_used="很抱歉,该串码已被使用. \n再次购买指定产品!更多惊喜哟!",MsgPop.at_lost="很抱歉,领取失败",MsgPop.at_upgrade="很抱歉，系统正在维护\n请稍候再参与活动.",MsgPop.err_link="链接异常\n请重试操作尝试",MsgPop.at_time_out="网络超时\n请检查您的网络再尝试",__reflect(MsgPop.prototype,"MsgPop");var BulletBar=function(t){function e(e){void 0===e&&(e=1);var a=t.call(this)||this;a.speed=20,a.area=[{x:-3.85,y:509.2},{x:113.3,y:437.5},{x:162.75,y:432.45},{x:241.6,y:398.25},{x:305.85,y:432.45},{x:978.65,y:425.6},{x:1040.95,y:455.7},{x:1200,y:518.5}],a.speed=a.speed*e;var i=Global.createBitmapByName("bullet0_png");return i.scaleX=e,i.x=i.width/-2,i.y=i.height/-2,a.addChild(i),a}return __extends(e,t),e.prototype.checkOut=function(){if(this.x+=this.speed,this.x<-50||this.x>1250)return!0;for(var t=1;t<this.area.length;t++){var e=this.area[t].x;if(this.x<e){var a=this.area[t-1].x,i=this.area[t-1].y,n=this.area[t].y,o=(e-a)/(n-i),s=(this.x-a)/o+i;return this.y>=s?!0:!1}}return!0},e.prototype.kill=function(){this.parent&&this.parent.removeChild(this)},e}(egret.Sprite);__reflect(BulletBar.prototype,"BulletBar");var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.count=0,e.fps=0,e.createView(),e}return __extends(e,t),e.prototype.hide=function(){var t=egret.Tween.get(this.slog);t.to({alpha:0,scaleX:.8,scaleY:.8},500,egret.Ease.backIn);var e=egret.Tween.get(this);e.wait(200),e.to({alpha:0},600)},e.prototype.createView=function(){var t=new egret.Shape;t.graphics.beginFill(0,.8),t.graphics.drawRect(0,0,1200,640),this.loadingTxt=new egret.TextField,this.loadingTxt.textAlign="center",this.loadingTxt.width=1200,this.loadingTxt.text="loading...",this.loadingTxt.y=400,this.slog=new Middle(Global.createBitmapByName("title_png")),this.slog.x=600,this.slog.y=300,this.addChild(t),this.addChild(this.slog),this.addChild(this.loadingTxt);var e=egret.Tween.get(t);t.alpha=0,e.to({alpha:1},400);var a=egret.Tween.get(this.slog);this.slog.alpha=0,this.slog.scaleX=this.slog.scaleY=.6,a.wait(200),a.to({alpha:1,scaleX:1,scaleY:1},500,egret.Ease.backOut);var i=egret.Tween.get(this.loadingTxt);this.loadingTxt.alpha=0,i.wait(300),i.to({alpha:1},500),this.addEventListener(egret.Event.ENTER_FRAME,this.loop,this)},e.prototype.loop=function(){if(this.fps++,this.fps%5==0){this.count++,this.count>3&&(this.count=0);for(var t=".",e=0;3>e;e++)t+=e<this.count?".":" ";this.loadingTxt.text="loading"+t}this.fps>=100&&(this.fps=0)},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var Main=function(_super){function Main(){var t=_super.call(this)||this;return t.count=0,t.loaded=0,t.played="wating",Main._main=t,t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t.addEventListener("event",t.eventHandler,t),t}return __extends(Main,_super),Main.prototype.onAddToStage=function(t){console.log("onAddToStage");var e,a,i=window.innerWidth,n=window.innerHeight;i>n?(e=window.innerWidth/1200,a=window.innerHeight/640):(e=window.innerHeight/1200,a=window.innerWidth/640),Main.scale=e/a,this.stage.scaleMode=egret.StageScaleMode.EXACT_FIT,Main.isTest||Api.getTicket()?(Action.toCookiePage(),this.loadUser()):this.dispatchEvent(new EventObj("event","msg_event",!0,!1,MsgPop.err_link))},Main.prototype.eventHandler=function(t){switch(console.log("eventHandler:"+t.name),t.name){case"to_play":Main.isTest?(Math.random()>.5?GameInfo.hb=0:GameInfo.hb=1,this.showPlayPage()):Api.load("play",Api.play_url,{ticket:Api.status_ticket,isplay:1},this,this.playLoad);break;case"to_city":window.location.href=Api.city_url;break;case"to_share":$("#share-pop").fadeIn();break;case"msg_event":this.showMsg(t.data)}t.stopPropagation()},Main.prototype.playLoad=function(t){if(this.touchChildren=!1,"success"==t.result)if(t.more&&"success"==t.more.result){var e=t.more;Api.status_ticket=e.ticket,e.c1ashed?GameInfo.hb=parseInt(e.c1ashed):GameInfo.hb=0,this.showPlayPage()}else this.dispatchEvent(new EventObj("event","msg_event",!0,!1,MsgPop.at_anomaly));else this.dispatchEvent(new EventObj("event","msg_event",!0,!1,MsgPop.at_anomaly))},Main.prototype.showSettingPage=function(t){void 0===t&&(t="select"),this.settingPage=new SettingPage,this.loading?this.addChildAt(this.settingPage,this.numChildren-1):this.addChild(this.settingPage),t?this.settingPage.showPop(t):this.settingPage.showPop("select")},Main.prototype.showPlayPage=function(){this.playPage?this.playPage.showPop("help"):(this.playPage=new PlayPage,this.addChildAt(this.playPage,0),this.playPage.showPop("help")),this.settingPage&&this.settingPage.out(),this.settingPage=null,this.touchChildren=!0},Main.prototype.loadConfig=function(){console.log("loadConfig"),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/shoot.json","resource/")},Main.prototype.onConfigComplete=function(t){console.log("onConfigComplete"),RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.loadGroup("loading")},Main.prototype.onResourceLoadComplete=function(t){console.log("onResourceLoadComplete:"+t.groupName),"loading"==t.groupName?(this.loaded=1,this.loading=new LoadingUI,this.addChild(this.loading),RES.loadGroup("game")):"game"==t.groupName&&(this.loaded=2,-1==GameInfo.play_ren?this.showSettingPage("select"):this.showSettingPage("setting"),this.loading.hide(),this.loading=null)},Main.prototype.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},Main.prototype.onResourceProgress=function(t){},Main.prototype.onGetComplete=function(t){var e=t.currentTarget;console.log("get data : ",e.response)},Main.prototype.onGetIOError=function(t){console.log("get error : "+t)},Main.prototype.onGetProgress=function(t){console.log("get progress : "+Math.floor(100*t.bytesLoaded/t.bytesTotal)+"%")},Main.prototype.loadUser=function(){if(console.log("loadUser"),Main.isTest){Api.user={nickname:"",headimgurl:"http://res.leasiondata.cn/lstatic/demo/logo.jpg"};Api.user;return Api.browser="weixin",void this.loadConfig()}Api.load("load user",Api.user_api_url,{ticket:Api.user_ticket,desc:"info"},this,this.loadUserSuccess)},Main.prototype.loadUserSuccess=function(data){if("success"==data.result){if(data.nickname=decodeURIComponent(data.nickname),data.city=decodeURIComponent(data.city),Api.user=data,!data.more||"success"!=data.more.result)return void this.dispatchEvent(new EventObj("event","msg_event",!0,!1,MsgPop.at_anomaly));GameInfo.play_ren=parseInt(data.more.role)-1,GameInfo.sco=parseInt(data.more.jf),GameInfo.level=parseInt(data.more.level)-1;var json=decodeURIComponent(data.more.weaponinuse);json=eval("("+json+")"),GameInfo.gun=parseInt(json.value),GameInfo.guns=[],json=decodeURIComponent(data.more.weaponlist),json=eval("("+json+")");for(var i=0;i<json.length;i++){var t=parseInt(json[i].value);GameInfo.guns[i]={type:t},t==GameInfo.gun&&(GameInfo.gunSelect=i);for(var n=0;n<GameInfo.gunsInshop.length;n++)if(t==GameInfo.gunsInshop[n].type){GameInfo.gunsInshop[n].has=1;break}}console.log("GameInfo",GameInfo.play_ren,GameInfo.sco,GameInfo.level,GameInfo.gun,GameInfo.guns,GameInfo.gunSelect),""==data.c1ashed?this.loadConfig():this.dispatchEvent(new EventObj("event","msg_event",!0,!1,MsgPop.at_used))}else this.dispatchEvent(new EventObj("event","msg_event",!0,!1,MsgPop.at_anomaly))},Main.prototype.showMsg=function(t){var e=new MsgPop;this.addChild(e),e.show(t)},Main}(egret.DisplayObjectContainer);Main.isTest=!0,Main.scale=1,Main._main=null,__reflect(Main.prototype,"Main");var PlayPage=function(t){function e(){var e=t.call(this)||this;return e.played=0,e.status=0,e.oldPop=null,e.leftBullets=[],e.rightBullets=[],e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e.addEventListener("event",e.eventHandler,e),e}return __extends(e,t),e.prototype.eventHandler=function(t){switch(console.log("eventHandler:"+t.name),t.name){case"show_game_help":this.showPop("help"),t.stopPropagation();break;case"start_321":this.showPop("321"),t.stopPropagation();break;case"play":this.play(),t.stopPropagation();break;case"win":this.toStop("win"),t.stopPropagation();break;case"lost":this.toStop("lost"),t.stopPropagation();break;case"hb":this.toStop("hb"),t.stopPropagation();break;case"end":this.showPop("end"),t.stopPropagation();break;case"start_play":this.status=1,t.stopPropagation();break;case"close_pop":this.closePop(),t.stopPropagation();break;case"left":this.move(-1),t.stopPropagation();break;case"right":this.move(1),t.stopPropagation();break;case"control_end":this.leftRen.play("stand"),t.stopPropagation();break;case"shoot":this.leftRen.play("shoot"),t.stopPropagation();break;case"left_shoot":this.leftShoot(),t.stopPropagation();break;case"right_shoot":this.rightShoot(),t.stopPropagation();break;case"away":var e=t.data;e.x=.8*e.x+this.rightRen.x,e.y=.8*e.y+this.rightRen.y,e.scaleX=e.scaleY=.8,this.addChildAt(e,this.getChildIndex(this.rightRen)-1);var a=egret.Tween.get(e),i=this;a.to({x:450,y:170,scaleX:1,scaleY:1},2e3,egret.Ease.cubicOut),a.call(function(){i.dispatchEvent(new EventObj("event","hb",!0))
}),t.stopPropagation();break;case"boom":this.leftRen.play("boom"),t.stopPropagation()}},e.prototype.play=function(){this.gameSp.touchChildren=!0,this.status=1},e.prototype.toStop=function(t){this.gameSp.touchChildren=!1,this.status=2,"win"==t?this.showPop("win"):"lost"==t?this.showPop("lost"):"hb"==t&&this.showPop("hb")},e.prototype.onAddToStage=function(t){var e,a,i=(this.stage.stageWidth,this.stage.stageHeight,Global.createBitmapByName("p_bg_jpg")),n=Global.createBitmapByName("p_road_png"),o=GameInfo.play_ren,s=GameInfo.gun;GameInfo.hb>0?(e=3,a=0):(e=Math.floor(3*Math.random()),a=Math.floor(5*Math.random())),GameInfo.enemy_gun=a,this.gameSp=new egret.Sprite,this.leftRen=new PlayRenBar(o,s),this.rightRen=new PlayRenBar(e,a,!0),this.leftRen.x=PlayRenBar.leftX[0],this.leftRen.y=PlayRenBar.initY[0],this.rightRen.x=PlayRenBar.rightX[0],this.rightRen.y=PlayRenBar.initY[1],this.rightRen.play("stand"),this.leftRen.play("stand"),this.controlBar=new ControlBar,this.shootBar=new ShootBar,this.grenadeBar=new GrenadeBar,this.mineBar=new MineBar,this.enemyBar=new EnemyBar;n.y=397,this.gameSp.touchChildren=!1,this.addChild(i),this.addChild(this.leftRen),this.addChild(this.rightRen),this.addChild(n),this.addChild(this.gameSp),this.gameSp.addChild(this.controlBar),this.gameSp.addChild(this.shootBar),this.addChild(this.mineBar),this.addChild(this.enemyBar),this.addEventListener(egret.Event.ENTER_FRAME,this.loop,this)},e.prototype.move=function(t){this.leftRen.move(t)},e.prototype.rightShoot=function(){var t=this.rightRen.getBullet();this.addChild(t),this.rightBullets.push(t)},e.prototype.leftShoot=function(){var t=this.leftRen.getBullet();this.addChild(t),this.leftBullets.push(t)},e.prototype.checkHit=function(){var t,e,a,i=[];for(t=0;t<this.leftBullets.length;t++){if(a=!1,e=this.leftBullets[t],e.checkOut())a=!0;else{var n=this.rightRen.check(e);n&&(this.hit(1,n),a=!0)}a?e.kill():i.push(e)}for(this.leftBullets=i,i=[],t=0;t<this.rightBullets.length;t++){if(a=!1,e=this.rightBullets[t],e.checkOut())a=!0;else{var n=this.leftRen.check(e);n&&(this.hit(0,n),a=!0)}a?e.kill():i.push(e)}this.rightBullets=i},e.prototype.hit=function(t,e){0==t?this.mineBar.hit(e,GameInfo.enemy_gun):this.enemyBar.hit(e,GameInfo.gun)},e.prototype.loop=function(t){0==this.status||(1==this.status?(this.rightRen.playAi(),this.checkHit()):2==this.status)},e.prototype.closePop=function(){var t=!1,e=this.oldPop;return e&&(e.out(),t=!0),this.oldPop=null,t},e.prototype.showPop=function(t){console.log("showpop:"+t);var e=this.closePop();"help"==t?this.oldPop=new HelpPop:"321"==t?this.oldPop=new P321Pop:"win"==t?this.oldPop=new WinPop:"lost"==t?this.oldPop=new LostPop:"hb"==t?this.oldPop=new HbPop:"end"==t&&(this.oldPop=new EndPop),this.addChild(this.oldPop),this.oldPop.show(e)},e}(egret.DisplayObjectContainer);__reflect(PlayPage.prototype,"PlayPage");var BuyEndPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.showEnd=function(t){var e,a=Global.createBitmapByName("pop_bg_png",-254,-165);e=t?Global.createBitmapByName("buy_ok_png",-211,-144):Global.createBitmapByName("buy_lost_png",-151,-144);var i=Global.createBitmapByName("to_ok_png",-146,38);Global.setBut(i),this.view.addChild(a),this.view.addChild(e),this.view.addChild(i),this.view.alpha=0,Global.zoomIn(this.view),i.addEventListener(egret.TouchEvent.TOUCH_TAP,function(e){t?this.dispatchEvent(new EventObj("event","buy_sunccess_close",!0)):this.out()},this)},e.prototype.startBuy=function(t){if(this.show(!1),Main.isTest)return void this.showEnd(Math.random()>.5?1:0);var e=t.id;this.buyObj=t,console.log("GameInfo",GameInfo.sco,t),Api.load("buy",Api.user_buy_url,{itemid:e,ticket:Api.user_ticket,desc:"buy"},this,this.buySuccess)},e.prototype.buySuccess=function(t){if("success"==t.result)if(t.reason&&"nojf"==t.reason)this.showEnd(!1);else{var e=this.buyObj.type;GameInfo.guns.push({type:e});for(var a=0;a<GameInfo.gunsInshop.length;a++)GameInfo.gunsInshop[a].type==e&&(GameInfo.gunsInshop[a].has=1);GameInfo.sco=t.restjf,this.dispatchEvent(new EventObj("event","buy_sunccess",!0)),this.showEnd(!0)}else t.reason&&"nojf"==t.reason?this.showEnd(!1):this.dispatchEvent(new EventObj("event","msg_event",!0,!1,MsgPop.at_anomaly))},e.prototype.show=function(e){t.prototype.show.call(this,e,!0,!1)},e}(PopView);__reflect(BuyEndPop.prototype,"BuyEndPop");var EndPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.show=function(e){t.prototype.show.call(this,e);var a=Global.createBitmapByName("win_tip_png",-199,-60),i=Global.createBitmapByName("win_title_png",-64,-144),n=Global.createBitmapByName("to_city_png",-107,46);Global.setBut(n),this.view.addChild(i),this.view.addChild(n),this.view.addChild(a),n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){this.dispatchEvent(new EventObj("event","to_city",!0))},this)},e}(PopView);__reflect(EndPop.prototype,"EndPop");var HbPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.show=function(e){t.prototype.show.call(this,e);var a=Global.createBitmapByName("pop_bg_png",-254,-165),i=Global.createBitmapByName("win_copy_png",-222,-144),n=Global.createBitmapByName("to_city_png",-221,38),o=Global.createBitmapByName("to_share_png",-110,38);Global.setBut(n),Global.setBut(o),this.view.addChild(a),this.view.addChild(i),this.view.addChild(o),n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){this.dispatchEvent(new EventObj("event","to_city",!0))},this),o.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){this.dispatchEvent(new EventObj("event","to_share",!0))},this)},e}(PopView);__reflect(HbPop.prototype,"HbPop");var HelpPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.show=function(e){t.prototype.show.call(this,e);var a=Global.createBitmapByName("pop_bg_png",-254,-165),i=Global.createBitmapByName("p_tip_png",-171,-144),n=Global.createBitmapByName("to_play_png",-146,38);Global.setBut(n),this.view.addChild(a),this.view.addChild(i),this.view.addChild(n),n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){this.dispatchEvent(new EventObj("event","start_321",!0))},this)},e}(PopView);__reflect(HelpPop.prototype,"HelpPop");var LostPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.show=function(e){t.prototype.show.call(this,e);var a=Global.createBitmapByName("pop_bg_png",-254,-165),i=Global.createBitmapByName("win_jf_copy_png",-152,-144),n=Global.createBitmapByName("to_city_png",-221,38),o=Global.createBitmapByName("to_share_png",-110,38);Global.setBut(n),Global.setBut(o),this.view.addChild(a),this.view.addChild(i),this.view.addChild(o),n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){this.dispatchEvent(new EventObj("event","to_city",!0))},this),o.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){this.dispatchEvent(new EventObj("event","to_share",!0))},this)},e}(PopView);__reflect(LostPop.prototype,"LostPop");var P321Pop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.show=function(e){t.prototype.show.call(this,!1,!1);var a=this,i=new egret.TextField,n=new egret.TextField,o=new egret.TextField;i.size=n.size=o.size=120,i.textAlign=n.textAlign=o.textAlign="center",i.textColor=n.textColor=o.textColor=16777215,i.text="3",n.text="2",o.text="1";var s=new Middle(i),r=new Middle(n),h=new Middle(o);s.x=r.x=h.x=0,s.y=r.y=h.y=0,a.view.addChild(s);var l=egret.Tween.get(s);l.to({scaleX:3,scaleY:3,alpha:0},500),l.call(function(){var t=egret.Tween.get(r);t.wait(500),a.view.addChild(r),t.to({scaleX:3,scaleY:3,alpha:0},500),t.call(function(){var t=egret.Tween.get(h);t.wait(500),a.view.addChild(h),t.to({scaleX:3,scaleY:3,alpha:0},500),t.call(function(){this.dispatchEvent(new EventObj("event","play",!0))})})})},e}(PopView);__reflect(P321Pop.prototype,"P321Pop");var SelectGunPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.show=function(e){t.prototype.show.call(this,e,!1);var a,i,n=Global.createBitmapByName("s_bg_png",-588,-180),o=Global.createBitmapByName("settting_my_png",384,-94);0==GameInfo.level?i=Global.createBitmapByName("setting_level"+GameInfo.level+"_title_png",-240,-94):(a=Global.createBitmapByName("setting_level"+GameInfo.level+"_png",-180,-118),i=Global.createBitmapByName("setting_level"+GameInfo.level+"_title_png",-120,-94)),this.leftBtn=new Middle(Global.createBitmapByName("s_a_png"),-180,55),this.rightBtn=new Middle(Global.createBitmapByName("s_a_png"),491,55),this.rightBtn.scaleX=-1;var s=Global.createBitmapByName("buy_line_png",-188,-41),r=Global.createBitmapByName("to_play_png",-72,165),h=Global.createBitmapByName("to_shop_png",213,165);this.ren=new GunRenBar(GameInfo.play_ren,GameInfo.gun),this.gun=new GunBar(GameInfo.gun),this.gun.x=162,this.gun.y=70,Global.setBut(this.leftBtn),Global.setBut(this.rightBtn),Global.setBut(r),Global.setBut(h),this.view.addChild(n),this.view.addChild(o),a&&this.view.addChild(a),this.view.addChild(i),this.view.addChild(s),this.view.addChild(this.ren),this.view.addChild(this.gun),this.view.addChild(r),this.view.addChild(h),this.leftBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){this.select(-1)},this),this.rightBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){this.select(1)},this),r.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){this.dispatchEvent(new EventObj("event","to_play",!0))},this),h.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){this.dispatchEvent(new EventObj("event","to_shop",!0))},this),this.select(0)},e.prototype.select=function(t){var e=GameInfo.guns,a=GameInfo.gunSelect;console.log(e,a),-1==t?a-=1:1==t&&(a+=1),console.log(a,e.length),0>a&&(a=0),a>=e.length&&(a=e.length-1),GameInfo.gunSelect=a;var i=GameInfo.guns[a].type;GameInfo.gun=i,this.gun.setType(i),this.ren.setGun(i),e.length>1&&a>0?this.view.addChild(this.leftBtn):Global.remove(this.leftBtn),a<e.length-1?this.view.addChild(this.rightBtn):Global.remove(this.rightBtn)},e}(PopView);__reflect(SelectGunPop.prototype,"SelectGunPop");var SelectPop=function(t){function e(){var e=t.call(this)||this;return e.addEventListener("event",e.eventHandler,e),e}return __extends(e,t),e.prototype.eventHandler=function(t){switch(console.log("eventHandler:"+t.name),t.name){case"select_ren":GameInfo.play_ren=t.data,this.dispatchEvent(new EventObj("event","to_setting",!0)),t.stopPropagation();break;case"active_ren":for(var e=t.data,a=0;a<this.rens.length;a++)a==e?this.rens[a].active(!0):this.rens[a].active(!1);t.stopPropagation()}},e.prototype.show=function(e){t.prototype.show.call(this,e,!1);var a=Global.createBitmapByName("r_s_tip_png",-172,250),i=new SelectRenBar(0),n=new SelectRenBar(1),o=new SelectRenBar(2);this.rens=[i,n,o],i.x=-362,n.x=-8,o.x=376,i.y=n.y=o.y=20,this.view.addChild(a),this.view.addChild(i),this.view.addChild(n),this.view.addChild(o)},e}(PopView);__reflect(SelectPop.prototype,"SelectPop");var ShopPop=function(t){function e(){var e=t.call(this)||this;return e.selectGun=-1,e.offs=[0,5,10,15,20,30,40,60,80,100],e.addEventListener("event",e.eventHandler,e),e}return __extends(e,t),e.prototype.eventHandler=function(t){switch(console.log("eventHandler:"+t.name),t.name){case"buy_sunccess":this.activeOther();break;case"select_gun":var e=t.data;this.gun.setType(e),t.stopPropagation()}},e.prototype.activeOther=function(){var t=this.listSp,e=Global.createBitmapByName("buy_store_bg_png");t.addChild(e);for(var a,i=GameInfo.gunsInshop,n=0;n<i.length;n++)a=new GunMiniBar(i[n].type),i[n].has&&a.lock(),a.x=n%3*135+67.5,a.y=120*Math.floor(n/3)+60,t.addChild(a),-1==this.selectGun&&(this.selectGun=i[n].type);this.gun=new GunBar(this.selectGun,!0)},e.prototype.showEnd=function(){var t=Global.createBitmapByName("s_bg_png",-588,-180),e=Global.createBitmapByName("buy_store_name_png",-345,-135),a=new egret.Sprite;a.x=-496,a.y=-90;var i,n=Global.createBitmapByName("buy_store_bg_png"),o=Global.createBitmapByName("to_buy2_png",56,163),s=Global.createBitmapByName("to_back2_png",213,163),r=GameInfo.gunsInshop;this.listSp=a,a.addChild(n);for(var h=0;h<r.length;h++)i=new GunMiniBar(r[h].type),r[h].has&&i.lock(),i.x=h%3*135+67.5,i.y=120*Math.floor(h/3)+60,a.addChild(i),-1==this.selectGun&&(this.selectGun=r[h].type);this.gun=new GunBar(this.selectGun,!0),this.gun.x=214,this.gun.y=20,Global.setBut(o),Global.setBut(s),this.view.addChild(t),this.view.addChild(e),this.view.addChild(a),this.view.addChild(this.gun),this.view.addChild(o),this.view.addChild(s),o.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){var e=new BuyEndPop;this.addChild(e),e.startBuy(GameInfo.gunData[this.gun.type]),this.dispatchEvent(new EventObj("event","to_buy",!0))},this),s.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){this.dispatchEvent(new EventObj("event","to_setting",!0))},this);var l=egret.Tween.get(this.view);l.wait(500),l.to({alpha:1,scaleX:1,scaleY:Main.scale},500,egret.Ease.backOut)},e.prototype.loadListSuccess=function(t){if(console.log("loadListSuccess"),"success"==t.result){for(var e=this.offs[GameInfo.level],a=0;a<t.items.length;a++){var i=t.items[a].id,n=t.items[a].value;GameInfo.gunData[n].id=i,GameInfo.gunData[n].sco=t.items[a].cost-e}console.log("loadListSuccess2"),this.showEnd()}else this.dispatchEvent(new EventObj("event","msg_event",!0,!1,MsgPop.at_anomaly))},e.prototype.show=function(e){t.prototype.show.call(this,e,!0,!1);var a={result:"success",items:[{id:"0",value:"1",cost:"0"}]};this.loadListSuccess(a)},e}(PopView);__reflect(ShopPop.prototype,"ShopPop");var WinPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.show=function(e){t.prototype.show.call(this,e);var a=Global.createBitmapByName("pop_bg_png",-254,-165),i=Global.createBitmapByName("win_jf_copy2_png",-190,-144),n=Global.createBitmapByName("to_city_png",-221,38),o=Global.createBitmapByName("to_share_png",-100,38);Global.setBut(n),Global.setBut(o),this.view.addChild(a),this.view.addChild(i),this.view.addChild(o),n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){this.dispatchEvent(new EventObj("event","to_city",!0))},this),o.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){this.dispatchEvent(new EventObj("event","to_share",!0))},this)},e}(PopView);__reflect(WinPop.prototype,"WinPop");var SettingPage=function(t){function e(){var e=t.call(this)||this;return e.status=0,e.oldPop=null,e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e.addEventListener("event",e.eventHandler,e),e}return __extends(e,t),e.prototype.eventHandler=function(t){switch(console.log("eventHandler:"+t.name),t.name){case"buy_sunccess":this.jfBar.reSetSco();break;case"buy_sunccess_close":this.showPop("setting");break;case"buy_gun":t.stopPropagation();break;case"to_shop":this.showPop("shop"),t.stopPropagation();break;case"to_select":this.showPop("select"),t.stopPropagation();break;case"to_setting":this.showPop("setting"),t.stopPropagation();break;case"reset_sco":this.jfBar.reSetSco(),t.stopPropagation()}},e.prototype.out=function(){var t=egret.Tween.get(this);t.to({y:-640},400,egret.Ease.cubicIn),t.call(function(){this.parent&&this.parent.removeChild(this)})},e.prototype.showPop=function(t){var e=this.closePop();"select"==t?this.oldPop=new SelectPop:"setting"==t?this.oldPop=new SelectGunPop:"shop"==t&&(this.oldPop=new ShopPop),this.addChildAt(this.oldPop,1),this.oldPop.show(e)},e.prototype.closePop=function(){var t=!1,e=this.oldPop;if(e){var a=egret.Tween.get(e);a.to({y:-640},400,egret.Ease.cubicIn),a.call(function(){e.parent&&e.parent.removeChild(e)}),t=!0}return this.oldPop=null,t},e.prototype.onAddToStage=function(t){var e=(this.stage.stageWidth,this.stage.stageHeight,Global.createBitmapByName("bg_jpg")),a=Global.createBitmapByName("logo_png",20,20),i=Global.createBitmapByName("title_png",420,26);this.jfBar=new JfBar;var n=new egret.Sprite;n.x=1180,n.y=20,a.scaleY=Main.scale,this.addChild(e),this.addChild(a),this.addChild(i),this.addChild(n),this.addChild(this.jfBar)},e}(egret.DisplayObjectContainer);__reflect(SettingPage.prototype,"SettingPage");
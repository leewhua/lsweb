var __reflect=this&&this.__reflect||function(t,e,n){t.__class__=e,n?n.push(e):n=[e],t.__types__=t.__types__?n.concat(t.__types__):n},__extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.sc=1.28,e.points={p25:{x:180,y:580},p26:{x:56,y:250},p27:{x:50,y:580},p28:{x:60,y:230},p29:{x:60,y:570},p30:{x:60,y:350},p31:{x:40,y:750},p32:{x:80,y:612},p33:{x:80,y:690},p34:{x:45,y:630}},RES.getResAsync(Main.product_type+"_copy_json",e.getType,e),e}return __extends(e,t),e.prototype.getType=function(t){for(var e=[],n=0;n<t.length;n++){var i=t[n].level;e[i]||(e[i]=[]),e[i].push(t[n])}console.log(e);var o=new Date,a=this.pattern(o,"yyyy-MM-dd"),s=this.pattern(o,"HH:mm"),r=o.getDay(),l=new Date(a).getTime();0==r&&(r=7);for(var h={w1:1,w2:2,w3:3,w4:4,w5:5,w6:6,w7:7},n=e.length-1;n>=0;n--)if(e[n])for(var p=0;p<e[n].length;p++){var d,c,u=e[n][p];if(console.log("d:"+o,s,u.date[0],u.date[1],u.time[0],u.time[1],r,h[u.date[0]]),u.date[0])if(h[u.date[0]]){if(console.log("www:"+r,h[u.date[0]]),r<h[u.date[0]]){console.log("o1");continue}}else if(d=new Date(u.date[0]).getTime(),console.log("www:"+o,d),d>l){console.log("o2");continue}if(u.date[1]){if(h[u.date[1]]){if(r>h[u.date[1]]){console.log("o3");continue}}else if(c=new Date(u.date[1]).getTime(),console.log("www2:"+l,c),l>c){console.log("o4");continue}}else if(u.date[0])if(h[u.date[0]]){if(r!=h[u.date[0]]){console.log("o5");continue}}else if(d=new Date(u.date[0]).getTime(),console.log("www3:"+l,d),l!=d){console.log("o6");continue}if(u.time[0]&&s<u.time[0])console.log("o7");else{if(!(u.time[1]&&s>u.time[1])){var g=u.data,M=Math.floor(Math.random()*g.length);return this.type=parseInt(g[M]),this.loadBg(),void console.log("find:"+u,u.data,this.type,M)}console.log("o8")}}},e.prototype.createView=function(t){var e;e=27==this.type||29==this.type||30==this.type||31==this.type?Main.createBitmapByRes(Main.product_type+"_json","logo-white"):Main.createBitmapByRes(Main.product_type+"_json","logo-blue"),e.x=500,e.y=20;t.scaleX=t.scaleY=this.sc;var n=egret.Tween.get(t);t.alpha=0,n.to({alpha:1},600),this.addChild(t),this.addChild(e),this.loadCopy()},e.prototype.loadCopy=function(){var t=this.type,e="resource/loading/copy/"+t+".png",n=new egret.URLLoader;n.dataFormat=egret.URLLoaderDataFormat.TEXTURE,n.addEventListener(egret.Event.COMPLETE,this.onLoadCopyComplete,this);var i=new egret.URLRequest(e);n.load(i)},e.prototype.loadBg=function(){var t="resource/loading/copy/"+this.type+".jpg",e=new egret.URLLoader;e.dataFormat=egret.URLLoaderDataFormat.TEXTURE,e.addEventListener(egret.Event.COMPLETE,this.onLoadComplete,this);var n=new egret.URLRequest(t);e.load(n)},e.prototype.onLoadCopyComplete=function(t){var e=t.target,n=e.data,i=new egret.Bitmap(n),o=egret.Tween.get(i),a=0,s=0;i.alpha=0,i.scaleX=i.scaleY=this.sc,i.y=s,i.x=a+10,o.to({x:a,alpha:1},800,egret.Ease.quadOut),this.addChild(i)},e.prototype.onLoadComplete=function(t){var e=t.target,n=e.data;this.createView(new egret.Bitmap(n))},e.prototype.pattern=function(t,e){var n={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours()%12==0?12:t.getHours()%12,"H+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),S:t.getMilliseconds()},i={0:"/u65e5",1:"/u4e00",2:"/u4e8c",3:"/u4e09",4:"/u56db",5:"/u4e94",6:"/u516d"};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length))),/(E+)/.test(e)&&(e=e.replace(RegExp.$1,(RegExp.$1.length>1?RegExp.$1.length>2?"/u661f/u671f":"/u5468":"")+i[t.getDay()+""]));for(var o in n)new RegExp("("+o+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?n[o]:("00"+n[o]).substr((""+n[o]).length)));return e},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var Ball=function(t){function e(){var e=t.call(this)||this;return e._sx=0,e._sy=0,e.oldX=0,e.oldY=0,e.ball=Main.createBitmapByName("ball_png"),e.blurBall=Main.createBitmapByName("ball2_png"),e.flash=new Middle(Main.createBitmapByName("ball-flash_png")),e.ball.x=e.ball.width/-2,e.ball.y=e.ball.height/-2,e.blurBall.x=e.blurBall.width/-2,e.blurBall.y=e.blurBall.height/-2,e.flash.x=0,e.flash.y=0,e.addChild(e.ball),e.addChild(e.blurBall),e.blurBall.alpha=0,e}return __extends(e,t),e.prototype.initXY=function(t,e){this.sx=t,this.sy=e,this.oldX=t,this.oldY=e,this.checkBlue(),console.log("initXY")},Object.defineProperty(e.prototype,"sx",{get:function(){return this._sx},set:function(t){this.oldX=this._sx,this._sx=t,this.x=t,this.checkBlue()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sy",{get:function(){return this._sy},set:function(t){this.oldY=this._sy,this._sy=t,this.y=t},enumerable:!0,configurable:!0}),e.prototype.boom=function(){this.addChildAt(this.flash,0),Main.zoomOut(this.flash,0,200,1.6),console.log("boom")},e.prototype.checkBlue=function(){var t=this._sx-this.oldX,e=this._sy-this.oldY,n=t*t+e*e;n/=10,n=Math.min(n,1),this.blurBall.alpha=n},e}(egret.Sprite);__reflect(Ball.prototype,"Ball");var EventObj=function(t){function e(e,n,i,o,a){var s=t.call(this,e,i,o,a)||this;return s.name=n,s}return __extends(e,t),e}(egret.Event);__reflect(EventObj.prototype,"EventObj");var Help=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){var e=new egret.Shape;e.graphics.beginFill(0,.7),e.graphics.drawRect(0,0,640,1015);var n=new Middle(Main.createBitmapByName("ok_png")),i=new Middle(Main.createBitmapByName("help_png"));i.x=320,i.y=507.5,n.x=320,n.y=820,this.addChild(e),this.addChild(i),this.addChild(n),e.touchEnabled=!0,n.touchEnabled=!0,Main.setBut(n),i.alpha=0,n.alpha=0,Main.zoomIn(i,0,400,.6),Main.zoomIn(n,200,400,.6),n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){this.parent&&this.parent.removeChild(this)},this)},e}(egret.Sprite);__reflect(Help.prototype,"Help");var Keeper=function(t){function e(){var e=t.call(this)||this;return e.wating(),e}return __extends(e,t),e.prototype.clearNow=function(){this.nowMov&&this.removeChild(this.nowMov),this.nowMov=null},e.prototype.wating=function(){this.clearNow(),this.nowMov=Main.createMc(Main.product_type+"-dengdai_json",Main.product_type+"-dengdai_png","dengdai"),this.nowMov.x=-130,this.nowMov.y=-200,this.nowMov.play(-1),this.addChild(this.nowMov),console.log(Main.product_type+"-dengdai_json",Main.product_type+"-dengdai_png","dengdai")},e.prototype.left_top=function(){this.clearNow(),this.nowMov=Main.createMc(Main.product_type+"-left_json",Main.product_type+"-left_png","left"),this.nowMov.x=-258,this.nowMov.y=-360,this.nowMov.play(1),this.addChild(this.nowMov)},e.prototype.left_bottom=function(){this.clearNow(),this.nowMov=Main.createMc(Main.product_type+"-left-lost_json",Main.product_type+"-left-lost_png","left-lost"),this.nowMov.x=-258,this.nowMov.y=-280,this.nowMov.play(1),this.addChild(this.nowMov)},e.prototype.right_top=function(){this.clearNow(),this.nowMov=Main.createMc(Main.product_type+"-right_json",Main.product_type+"-right_png","right"),this.nowMov.x=-114,this.nowMov.y=-300,this.nowMov.play(1),this.addChild(this.nowMov)},e.prototype.right_bottom=function(){this.clearNow(),this.nowMov=Main.createMc(Main.product_type+"-right-lost_json",Main.product_type+"-right-lost_png","right-lost"),this.nowMov.x=-114,this.nowMov.y=-280,this.nowMov.play(1),this.addChild(this.nowMov)},e}(egret.Sprite);__reflect(Keeper.prototype,"Keeper");var End=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){var e=(Math.floor(4*Math.random()),new egret.Shape);e.graphics.beginFill(0,.8),e.graphics.drawRect(0,0,640,1015);var n,i=new Middle(Main.createBitmapByName("win-bar_png")),o=new Middle(Main.createBitmapByName("to-city_png"));console.log("Main.award.count::"+Main.award.count),"thanks"==Main.award.type?(n=Main.createBitmapByName("thanks_png"),n.x=n.width/-2,n.y=n.height/-2):"cash"==Main.award.type?(n=Main.createBitmapByName(Main.award.count.toString()+"_png"),n.x=n.width/-2,n.y=n.height/-2):(n=Main.createBitmapByName("p-10_png"),n.x=n.width/-2,n.y=n.height/-2-76),i.x=320,i.y=520,o.x=320,o.y=920,e.touchEnabled=!0,i.addChild(n),Main.setBut(o),this.addChild(e),this.addChild(i),this.addChild(o),i.alpha=0,o.alpha=0,Main.zoomIn(i,0,400,.6),Main.zoomIn(o,200,400,.6),o.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){window.location.href="http://res.leasiondata.cn/lstatic/kzwyqs/jifen/playcity.html"},this)},e}(egret.Sprite);__reflect(End.prototype,"End");var Main=function(_super){function Main(){var t=_super.call(this)||this;return t.count=0,t.loaded=0,t.errMsg="",Main._main=t,t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t.addEventListener("event",t.eventHandler,t),t.addEventListener(egret.Event.ENTER_FRAME,t.loop,t),t}return __extends(Main,_super),Main.prototype.loop=function(){if(this.count++,this.count>80&&this.loaded){this.removeEventListener(egret.Event.ENTER_FRAME,this.loop,this),this.showScene();var t=this,e=egret.Tween.get(this.loadingView);e.to({y:-1040},600,egret.Ease.circIn),e.call(function(){t.loadingView&&(t.removeChild(t.loadingView),t.loadingView=null)})}},Main.prototype.eventHandler=function(t){switch(t.name){case"next":break;case"to_shop":break;case"clear_old":}},Main.prototype.onAddToStage=function(t){var e=window.innerWidth/640,n=window.innerHeight/1040;Main.scale=e/n,this.stage.scaleMode=egret.StageScaleMode.EXACT_FIT,this.getData()?this.loadUser():Main.showLost(21)},Main.prototype.loadConfig=function(){console.log("loadConfig"),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/config.json","resource/")},Main.prototype.showScene=function(){console.log("showScene"),this.scene=new Scene,this.stage.addChildAt(this.scene,0)},Main.prototype.clearOld=function(){this.old&&this.old.parent&&this.removeChild(this.old),this.old=null},Main.prototype.onConfigComplete=function(t){console.log("onConfigComplete"),RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),"yd"==Main.product_type?RES.loadGroup("yd_logo"):"tk"==Main.product_type?RES.loadGroup("tk_logo"):"bv"==Main.product_type&&RES.loadGroup("bv_logo")},Main.prototype.onResourceLoadComplete=function(t){console.log("onResourceLoadComplete:"+t.groupName),"c"==t.groupName?"yd"==Main.product_type?RES.loadGroup("yd"):"tk"==Main.product_type?RES.loadGroup("tk"):"bv"==Main.product_type&&RES.loadGroup("bv"):"yd"==t.groupName||"tk"==t.groupName||"bv"==t.groupName?this.loadLuck():("yd_logo"==t.groupName||"tk_logo"==t.groupName||"bv_logo"==t.groupName)&&(this.loadingView=new LoadingUI,this.addChild(this.loadingView),RES.loadGroup("c"))},Main.createBitmapByRes=function(t,e){var n=new egret.Bitmap,i=RES.getRes(t);return console.log("name::"+e+"::"+t),n.texture=i.getTexture(e),n},Main.createBitmapByName=function(t){var e=new egret.Bitmap,n=RES.getRes(t);return e.texture=n,e},Main.zoomIn=function(t,e,n,i){Main.tweenTo(t,e,n,0,0,.6,egret.Ease.backOut)},Main.zoomOut=function(t,e,n,i){Main.tweenToHide(t,e,n,0,0,i,egret.Ease.cubicIn)},Main.tweenToHide=function(t,e,n,i,o,a,s){var r=egret.Tween.get(t),l=t.x,h=t.y;l+=i,h+=o,r.wait(e),r.to({alpha:0,scaleX:a,scaleY:a,x:l,y:h},n,s),r.call(function(){t.parent&&t.parent.removeChild(t)})},Main.tweenTo=function(t,e,n,i,o,a,s){var r=egret.Tween.get(t),l=t.x,h=t.y;t.scaleX=t.scaleY=a,t.x=l+i,t.y=h+o,r.wait(e),r.to({alpha:1,scaleX:1,scaleY:1,x:l,y:h},n,s)},Main.createMc=function(t,e,n){var i=RES.getRes(t),o=RES.getRes(e),a=new egret.MovieClipDataFactory(i,o),s=new egret.MovieClip(a.generateMovieClipData(n));return s},Main.setBut=function(t){t&&(t.touchEnabled=!0,t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){t.alpha=.68},t),t.addEventListener(egret.TouchEvent.TOUCH_END,function(){t.alpha=1},t),t.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,function(){t.alpha=1},t))},Main.prototype.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},Main.prototype.onResourceProgress=function(t){},Main.prototype.getData=function(){var url=window.location.href.split("#")[0].split("?")[1],ut;return console.log("loadUser"),Main.product_type=eval("$.product_type"),Main.isTest?!0:url&&url.length>20?(ut=url.split(","),Main.user_ticket=ut[0],Main.status_ticket=ut[1],console.log(Main.user_ticket,Main.status_ticket),!0):!1},Main.prototype.loadUser=function(){if(console.log("loadUser"),Main.isTest)return void this.loadConfig();var t=this;$.ajax({url:Main.api,data:{ticket:Main.user_ticket,desc:"test",url4wxjssdk:window.location.href.split("#")[0]},success:function(e){1==e.msg?(Main.user=e.data,Main.weather=e.weather,Main.weather.text=decodeURIComponent(Main.weather.text),Main.location.city=decodeURIComponent(e.weather.city),console.log(Main.location,Main.weather.text),e.wxconfig&&($.wxConfig=e.wxconfig,$.initWx()),t.loadConfig()):"invalid ticket3"==e.data?Main.showLost(21):setTimeout(function(){t.loadUser()},1e3)},error:function(){Main.showLost(404)},timeout:8e3,dataType:"json",async:!0,type:"POST",complete:function(t,e){"timeout"==e&&Main.showLost(404)}})},Main.prototype.onGetComplete=function(t){var e=t.currentTarget;console.log("get data : ",e.response)},Main.prototype.onGetIOError=function(t){},Main.prototype.onGetProgress=function(t){},Main.prototype.showMsg=function(t){console.log("showLost");var e=new egret.Sprite,n=new egret.Shape;n.graphics.beginFill(0,.8),n.graphics.drawRect(0,0,640,1040);var i=new egret.TextField;i.background=!1,i.width=600,i.textColor=16777215,i.textAlign="center",i.size=36,i.text=t,i.y=500,i.x=20,e.addChild(n),e.addChild(i),this.addChild(e),e.alpha=0;var o=egret.Tween.get(e);o.to({alpha:1},400)},Main.prototype.showLost=function(t){console.log("showLost",t);var e=new egret.Sprite,n=new egret.Shape;n.graphics.beginFill(0,.8),n.graphics.drawRect(0,0,640,1040);var i,o=new egret.TextField;o.background=!1,o.width=600,o.textColor=16777215,o.textAlign="center",o.size=36,e.addChild(n),0==t?i=Main.createBitmapByName("lost_png"):21==t?(o.text="错误的链接，请重新扫码...",e.addChild(o)):1==t?i=Main.createBitmapByName("lost_png"):2==t?i=Main.createBitmapByName("lost_png"):3==t?i=Main.createBitmapByName("scanned_png"):4==t?i=Main.createBitmapByName("lost_png"):5==t?i=Main.createBitmapByName("lost_png"):11==t?i=Main.createBitmapByName("max_png"):22==t?(i=Main.createBitmapByName("max-lost_png"),console.log("max-lost_pngmax-lost_pngmax-lost_png:"+i)):33==t?o.text="码已经被抽过了...":404==t?window.location.href="http://res.leasiondata.cn/lstatic/lsruleupgrade.html":o.text="网络异常，请稍后再扫...",this.errMsg&&(o.text=o.text+":"+this.errMsg),o.y=500,o.x=20,i&&(i=new Middle(i),i.x=320,i.y=600,e.addChild(i)),this.addChild(e),e.alpha=0;var a=egret.Tween.get(e);a.to({alpha:1},400)},Main.prototype.loadLuck=function(){console.log("loadLuck");var t=this;return Main.isTest?(Main.save_ticket="test...",Main.award={type:"thanks",count:0},this.loaded=1,void Main.trackEvent("loading_ok")):(console.log(Main.status_ticket),void $.ajax({url:Main.api,data:{ticket:Main.status_ticket,desc:"抽中红包"},success:function(e){if(1==e.msg)if(e.data.repeat&&1==e.data.repeat)Main.showLost(22);else{if(Main.award=e.data,Main.save_ticket=e.data.ticket,"cash"==e.data.type){var n=parseInt(e.data.count)/100;Main.award.count=Math.round(n),Main.win=!0}else Main.award.count=10,Main.win=!1;t.loaded=1}else 2==e.msg&&"scanned"==e.result?Main.showLost(3):"invalid ticket3"==e.data?Main.showLost(1):Main.showLost(5)},error:function(){Main.showLost(404)},timeout:8e3,dataType:"json",async:!0,type:"POST",complete:function(t,e){"timeout"==e&&Main.showLost(404)}}))},Main.showLost=function(t){Main._main.showLost(t)},Main.showMsg=function(t){Main._main.showMsg(t)},Main.track=function(t){},Main.trackEvent=function(t){},Main}(egret.DisplayObjectContainer);Main.api="http://leasiondata.cn/luck/playtoo",Main.user_ticket="d82cf56540134d6f93fb88d3edf5dc50",Main.status_ticket="136c4f5463e047deb8e797c5a94280dc",Main.save_ticket="136c4f5463e047deb8e797c5a94280dc",Main.product_type="tk",Main.user=null,Main._main=null,Main.scale=1,Main.win=!0,Main.isTest=!0,Main.location={country:null,province:null,city:null},Main.weather={city:"上海",text:"多云",code:"4",temperature:"20"},Main.award={uid:null,nickname:null,type:"cash",count:1},__reflect(Main.prototype,"Main");var Middle=function(t){function e(e){var n=t.call(this)||this;return e.x=e.width/-2,e.y=e.height/-2,n.addChild(e),n}return __extends(e,t),e}(egret.Sprite);__reflect(Middle.prototype,"Middle");var Player=function(t){function e(){var e=t.call(this)||this;return e.wating(),e}return __extends(e,t),e.prototype.clearNow=function(){this.nowMov&&this.removeChild(this.nowMov),this.nowMov=null},e.prototype.wating=function(){this.clearNow(),this.nowMov=Main.createMc(Main.product_type+"-shemen_json",Main.product_type+"-shemen_png","shemen"),this.nowMov.gotoAndStop(1),this.nowMov.x=-320,this.nowMov.y=-500,this.addChild(this.nowMov)},e.prototype.shoot=function(){this.clearNow(),this.nowMov=Main.createMc(Main.product_type+"-shemen_json",Main.product_type+"-shemen_png","shemen"),this.nowMov.play(1),this.nowMov.x=-320,this.nowMov.y=-500,this.addChild(this.nowMov)},e.prototype.win=function(){this.clearNow(),this.nowMov=Main.createMc(Main.product_type+"-huanhu_json",Main.product_type+"-huanhu_png","huanhu"),this.nowMov.x=-180,this.nowMov.y=-500,this.nowMov.play(-1),this.addChild(this.nowMov)},e.prototype.lost=function(){this.clearNow(),this.nowMov=Main.createBitmapByName(Main.product_type+"-lost_png"),this.nowMov.x=-130,this.nowMov.y=-370,this.addChild(this.nowMov)},e}(egret.Sprite);__reflect(Player.prototype,"Player");var Scene=function(t){function e(){var e=t.call(this)||this;return e.count=0,e.inLuck=!1,e.inHelp=!1,e.inPlay=!1,e.ballX=320,e.ballY=680,e.delayCall=!1,e.saveOk=!1,e.flashCount=0,e.flashIndex=1,e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e.addEventListener("event",e.eventHandler,e),e}return __extends(e,t),e.prototype.eventHandler=function(t){switch(t.name){case"close_help":console.log("close_help");break;case"play_end":console.log("play_end"),this.end=new End,this.addChild(this.end);break;case"to_shop":}console.log(t.type+":"+t.name)},e.prototype.onAddToStage=function(t){var e=(this.stage.stageWidth,this.stage.stageHeight,Main.createBitmapByName(Main.product_type+"-bg_jpg")),n=Main.createBitmapByName("men_png"),i=new egret.Sprite,o=Main.createBitmapByName("wang1_png"),a=Main.createBitmapByName("wang2_png"),s=Main.createBitmapByName("wang3_png"),r=Main.createBitmapByName("wang4_png");this.w1=o,this.w2=a,this.w3=s,this.w4=r,n.x=75,n.y=212,o.x=85,o.y=218,a.x=85,a.y=302,s.x=325,s.y=218,r.x=325,r.y=300,this.ballShade=new Middle(Main.createBitmapByName("ball-shade_png")),this.ballShade.x=320,this.ballShade.y=760,this.ballShade.alpha=0,this.point=Main.createMc("point_json","point_png","point"),this.point.alpha=0,this.point.play(-1),this.start=new Middle(Main.createBitmapByName("start_png")),this.home_title=new Middle(Main.createBitmapByName(Main.product_type+"-home-title_png")),this.help_btn=new Middle(Main.createBitmapByName("help-btn_png")),this.tips=new Tips,this.player=new Player,this.keeper=new Keeper,this.ball=new Ball,this.tips.x=320,this.tips.y=920,this.keeper.x=320,this.keeper.y=475,this.player.x=320,this.player.y=843,this.ball.initXY(320,680),this.start.x=320,this.start.y=868,this.home_title.x=320,this.home_title.y=680,this.help_btn.x=320,this.help_btn.y=960,this.addChild(e),this.addChild(i),this.addChild(o),this.addChild(a),this.addChild(s),this.addChild(r),this.addChild(n),this.addChild(this.point),this.addChild(this.keeper),this.addChild(this.home_title),this.addChild(this.start),this.addChild(this.help_btn),this.addChild(this.tips),this.start.touchEnabled=!0,this.start.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){this.startPlay()},this),this.help_btn.touchEnabled=!0,this.help_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){this.showHelp()},this),Main.setBut(this.start),o.touchEnabled=!0,o.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){this.shoot(0)},this),a.touchEnabled=!0,a.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){this.shoot(1)},this),s.touchEnabled=!0,s.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){this.shoot(2)},this),r.touchEnabled=!0,r.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){this.shoot(3)},this)},e.prototype.ballFly=function(t){var e,n,i=500,o=this,a=.6;this.ball.initXY(320,680),this.ball.scaleX=this.ball.scaleY=1,0==t?(e=egret.Tween.get(this.ball),e.wait(100),e.to({scaleX:a,scaleY:a},i),e.call(function(){o.playEnd()}),n=egret.Tween.get(this.ball),n.wait(100),n.to({sx:180,sy:260},i,egret.Ease.backOut)):1==t?(e=egret.Tween.get(this.ball),e.wait(100),e.to({scaleX:a,scaleY:a},i),e.call(function(){o.playEnd()}),n=egret.Tween.get(this.ball),n.wait(100),n.to({sx:140,sy:400},i,egret.Ease.backOut)):2==t?(e=egret.Tween.get(this.ball),e.wait(100),e.to({scaleX:a,scaleY:a},i),e.call(function(){o.playEnd()}),n=egret.Tween.get(this.ball),n.wait(100),n.to({sx:450,sy:270},i,egret.Ease.backOut)):3==t&&(e=egret.Tween.get(this.ball),e.wait(100),e.to({scaleX:a,scaleY:a},i),e.call(function(){o.playEnd()}),n=egret.Tween.get(this.ball),n.wait(100),n.to({sx:480,sy:410},i,egret.Ease.backOut)),e=egret.Tween.get(this.ballShade),e.to({scaleX:.6,scaleY:.6,alpha:0},i)},e.prototype.playEnd=function(){this.ball.boom();var t=this;setTimeout(function(){t.delayCall=!0,t.showEnd()},2e3),Main.win?(this.player.win(),this.tips.win(200)):(this.player.lost(),this.tips.lost(200))},e.prototype.shoot=function(t){return this.delayCall=!1,this.saveOk=!1,this.point.parent&&this.removeChild(this.point),this.inPlay?(this.inPlay=!1,Main.win?this.keeperPlay(this.getOther(t)):this.keeperPlay(t),this.ballFly(t),this.player.shoot(),this.saveLuck(),!0):!1},e.prototype.getOther=function(t){var e=[0,1,2,3];e.splice(t,1);var n=Math.floor(e.length*Math.random());return e[n]},e.prototype.keeperPlay=function(t){var e=this;setTimeout(function(){0==t?e.keeper.left_top():1==t?e.keeper.left_bottom():2==t?e.keeper.right_top():3==t&&e.keeper.right_bottom()},300)},e.prototype.startPlay=function(){Main.zoomOut(this.start,0,400,1.2),Main.zoomOut(this.home_title,100,400,1.2),Main.zoomOut(this.help_btn,200,400,1.2),this.addChild(this.ballShade),this.addChild(this.ball),this.addChild(this.player),this.ball.alpha=0,this.player.alpha=0,Main.zoomIn(this.ballShade,600,400,.6),Main.zoomIn(this.ball,600,400,.6),Main.zoomIn(this.player,600,400,.6),this.tips.wating(700);this.inPlay=!0,this.flash()},e.prototype.flash=function(){var t=this["w"+this.flashIndex];this.flashCount=0,this.fadeOut(t),this.point.alpha=1,this.point.x=t.x+(t.width-140)/2,this.point.y=t.y+(t.height-140)/2},e.prototype.startFlash=function(){this.point.alpha=0},e.prototype.flashNext=function(){this.flashIndex++,this.flashIndex>4&&(this.flashIndex=1),this.flash()},e.prototype.fadeIn=function(t){var e=this,n=egret.Tween.get(t);n.to({alpha:1},200),n.call(function(){e.flashCount++,e.inPlay?e.flashCount<1?e.fadeOut(t):e.flashNext():e.startFlash()})},e.prototype.fadeOut=function(t){var e=this,n=egret.Tween.get(t);n.wait(600),n.to({alpha:0},200),n.call(function(){e.fadeIn(t)})},e.prototype.showEnd=function(){if(this.delayCall&&this.saveOk){var t=new End;this.addChild(t)}},e.prototype.showHelp=function(){var t=new Help;this.addChild(t)},e.prototype.saveLuck=function(){var t=this;if(!this.inLuck)return this.inLuck=!0,Main.isTest?void(t.saveOk=!0):void $.ajax({url:Main.api,data:{ticket:Main.save_ticket,desc:"抽中红包"},success:function(e){1==e.msg?(t.saveOk=!0,t.showEnd()):2==e.msg?Main.showLost(33):4==e.msg?Main.showLost(11):5==e.msg?Main.showLost(2):"invalid ticket3"==e.data?Main.showLost(2):Main.showLost(100)},error:function(){Main.showLost(404)},timeout:8e3,dataType:"json",async:!0,type:"POST",complete:function(t,e){"timeout"==e&&Main.showLost(404)}})},e}(egret.DisplayObjectContainer);__reflect(Scene.prototype,"Scene");var Tips=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.clearNow=function(){this.nowMov&&Main.zoomOut(this.nowMov,0,400,1.2),this.nowMov=null},e.prototype.hide=function(){this.clearNow()},e.prototype.wating=function(t){this.clearNow(),this.nowMov=new Middle(Main.createBitmapByName("play-tip_png")),this.nowMov.alpha=0,Main.zoomIn(this.nowMov,t,400,.6),this.addChild(this.nowMov)},e.prototype.lost=function(t){this.clearNow(),this.nowMov=new Middle(Main.createBitmapByName("lost-copy_png")),this.nowMov.alpha=0,Main.zoomIn(this.nowMov,t,400,.6),this.addChild(this.nowMov)},e.prototype.win=function(t){this.clearNow(),this.nowMov=new Middle(Main.createBitmapByName("win-copy_png")),this.nowMov.alpha=0,Main.zoomIn(this.nowMov,t,400,.6),this.addChild(this.nowMov)},e}(egret.Sprite);__reflect(Tips.prototype,"Tips");
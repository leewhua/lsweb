var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},EventObj=function(t){function e(e,i,n,a,o){var s=t.call(this,e,n,a,o)||this;return s.name=i,s}return __extends(e,t),e}(egret.Event);__reflect(EventObj.prototype,"EventObj");var Fly=function(t){function e(){var e=t.call(this)||this;return e.wating(),e}return __extends(e,t),e.prototype.clearNow=function(){this.nowMov&&this.removeChild(this.nowMov),this.nowMov=null},e.prototype.wating=function(){this.clearNow(),this.nowMov=Main.createMc("shemen_json","shemen_png","shemen"),this.nowMov.gotoAndStop(1),this.nowMov.x=-320,this.nowMov.y=-500,this.addChild(this.nowMov)},e.prototype.shoot=function(){this.clearNow(),this.nowMov=Main.createMc("shemen_json","shemen_png","shemen"),this.nowMov.play(1),this.nowMov.x=-320,this.nowMov.y=-500,this.addChild(this.nowMov)},e.prototype.win=function(){this.clearNow(),this.nowMov=Main.createMc("huanhu_json","huanhu_png","huanhu"),this.nowMov.x=-180,this.nowMov.y=-500,this.nowMov.play(-1),this.addChild(this.nowMov)},e.prototype.lost=function(){this.clearNow(),this.nowMov=Main.createBitmapByName("lost_png"),this.nowMov.x=-130,this.nowMov.y=-370,this.addChild(this.nowMov)},e}(egret.Sprite);__reflect(Fly.prototype,"Fly");var GameScene=function(t){function e(){var e=t.call(this)||this;return e.aw=2300,e.ah=1533,e.viewWidth=1015,e.viewHeigh=640,e.points=[{x:877.15,y:281.6},{x:1694.65,y:442.55},{x:582.4,y:678.25},{x:663.95,y:645.05},{x:906.1,y:662.1},{x:1251.2,y:699.1},{x:1713.65,y:661.1},{x:709.2,y:843.15},{x:1088.15,y:929.2},{x:1394.2,y:843.15},{x:1536.15,y:997.2},{x:625.95,y:1152.25},{x:1536.15,y:1200.25}],e.status=0,e.sco=0,e.fullSco=7,e.lostTime=5e3,e.playTime=3e4,e.initAngle=null,e.gammaOff=16,e.betaOff=20,e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e.addEventListener("event",e.eventHandler,e),e}return __extends(e,t),e.prototype.eventHandler=function(t){switch(t.name){case"close_help":console.log("close_help");break;case"play_end":console.log("play_end");break;case"to_shop":}console.log(t.type+":"+t.name)},e.prototype.play321=function(){var t=this,e=new Middle(Main.createBitmapByName("3_png")),i=new Middle(Main.createBitmapByName("2_png")),n=new Middle(Main.createBitmapByName("1_png"));t.view.addChild(e);var a=egret.Tween.get(e);a.to({scaleX:3,scaleY:3,alpha:0},500),a.call(function(){var e=egret.Tween.get(i);e.wait(500),t.view.addChild(i),e.to({scaleX:3,scaleY:3,alpha:0},500),e.call(function(){var e=egret.Tween.get(n);e.wait(500),t.view.addChild(n),e.to({scaleX:3,scaleY:3,alpha:0},500),e.call(function(){t.start()})})})},e.prototype.start=function(){0==this.status&&(this.sco=0,this.status=1,this.startTime=(new Date).getTime(),this.addEventListener(egret.Event.ENTER_FRAME,this.playLoop,this),this.setSco())},e.prototype.playLoop=function(t){var e=(new Date).getTime()-this.startTime;e=this.playTime-e,0>=e&&(e=0),0==e&&1==this.status&&this.showEnd(),this.timeTxt.text=this.add0(Math.floor(e/1e3))},e.prototype.add0=function(t){return 10>t?"0"+t:t.toString()},e.prototype.setSco=function(){if(this.scoPro&&this.sco>=1&&this.sco<=this.scoPro.length){var t=Main.createBitmapByName("c-guan_png"),e=Math.floor(this.sco-1);t.x=this.scoPro[e].x,t.y=this.scoPro[e].y,this.view.removeChild(this.scoPro[e]),this.scoPro[e]=t,this.view.addChild(t)}this.scoTxt.text="￥"+this.sco.toString()},e.prototype.koEnd=function(){this.status=1,this.flyBar.x=0,this.flyBar.y=0,this.fly.gotoAndStop(1),this.view.addChild(this.flyBar),this.sco>=this.fullSco&&this.showWin()},e.prototype.shoot=function(){1==this.status&&(this.status=2,this.fly.play(1))},e.prototype.showEnd=function(){this.status=4,this.sco>0?this.showWin():this.showLost()},e.prototype.showLost=function(){this.status=6;var t=new Middle(Main.createBitmapByName("game_lost_bg_png")),e=Main.createBitmapByName("lost-copy_png"),i=new Middle(Main.createBitmapByName("game_again_png"));i.y=t.height/2,e.x=-e.width/2,e.y=-e.height/2,Main.setBut(i),t.scaleX=Main.scale,t.addChild(e),t.addChild(i),this.view.addChild(t),i.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){Main._main.dispatchEvent(new EventObj("event","game_again"))},this),t.alpha=0,Main.zoomIn(t,0,400,.6)},e.prototype.showWin=function(){this.status=5;var t=this,e=new Middle(Main.createBitmapByName("game_end_png")),i=new egret.TextField,n=new egret.TextField,a=new egret.TextField,o=new Middle(Main.createBitmapByName("receive_png")),s=new Middle(Main.createBitmapByName("game_share_png"));e.scaleX=Main.scale,Main.setBut(o),Main.setBut(s),i.textAlign="center",n.textAlign="center",a.textAlign="center",i.size=50,i.textColor=16731733,i.x=-100,i.y=-56,i.width=200,n.size=32,n.textColor=15538979,n.width=400,n.x=-200,n.y=116,a.width=1e3,a.x=-500,a.y=180,i.text="¥"+this.sco,n.text="干得漂亮",a.text="恭喜您累计赢得"+this.sco+"元现金红包",e.addChild(i),e.addChild(n),e.addChild(a),this.view.addChild(e),this.view.addChild(o),e.y=-40,o.y=230,s.y=230,s.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){Main._main.dispatchEvent(new EventObj("event","to_share"))},this),o.addEventListener(egret.TouchEvent.TOUCH_TAP,function(e){t.saveLuck()},this),e.alpha=0,o.alpha=0,s.alpha=0,Main.zoomIn(e,0,400,.6),Main.zoomIn(o,200,400,.6),this.receive=o,this.share=s,this.copyTxt=n,this.tipTxt=a},e.prototype.showTip=function(){var t=this,e=new Middle(Main.createBitmapByName("game_lost_bg_png")),i=Main.createBitmapByName("game_tip_png"),n=new Middle(Main.createBitmapByName("start_png"));n.y=e.height/2,i.x=-i.width/2,i.y=-i.height/2,Main.setBut(n),n.touchEnabled=!0,e.addChild(i),e.addChild(n),this.view.addChild(e),n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(i){Main.zoomOut(e,0,400,1.2),setTimeout(function(){t.play321()},600)},this),e.alpha=0,Main.zoomIn(e,0,400,.6)},e.prototype.showFlyEnd=function(){var t=this;this.flyBar.x=-this.sc.x,this.flyBar.y=-this.sc.y,this.sc.addChild(this.flyBar);var e=this.checkKo(this.flyBar.x,this.flyBar.y);this.log&&(this.log.text+=Math.round(this.flyBar.x)+":"+Math.round(this.flyBar.y)+":"+e),e>-1?this.showKo(e):setTimeout(function(){t.koEnd()},600)},e.prototype.checkKo=function(t,e){for(var i=0;i<this.proList.length;i++){var n=this.proList[i];if(t>=n.x&&t<=n.x+n.width&&e>=n.y&&e<=n.y+n.height)return i}return-1},e.prototype.showKo=function(t){var e=this;this.jia1.alpha=this.winPro.alpha=0,Main.zoomIn(this.winPro,300,500,.6),Main.zoomIn(this.jia1,1500,500,.6),setTimeout(function(){Main.zoomOut(e.winPro,0,400,1.2)},1200),setTimeout(function(){Main.zoomOut(e.jia1,0,400,1.2),e.koEnd()},2e3);var i=this.proList.splice(t,1)[0];setTimeout(function(){i.alpha=0,setTimeout(function(){i.alpha=1,setTimeout(function(){i.alpha=0,setTimeout(function(){i.alpha=1,setTimeout(function(){i.alpha=0,i.parent&&i.parent.removeChild(i)},50)},50)},50)},50)},1e3),0==this.sco?this.sco=1.5:1.5==this.sco?this.sco=2:this.sco+=1,this.setSco(),this.view.addChild(this.winPro),this.view.addChild(this.jia1)},e.prototype.onAddToStage=function(t){this.stage.stageWidth,this.stage.stageHeight;this.winPro=new Middle(Main.createBitmapByName("game_pro_png")),this.jia1=new Middle(Main.createBitmapByName("jia1_png")),this.jia1.y=-200,this.view=new egret.Sprite,this.sc=new egret.Sprite,this.view.rotation=90,this.view.x=320,this.view.y=507;var e=Main.createBitmapByName("bg_jpg"),i=Main.createBitmapByName("copy_png"),n=Main.createBitmapByName("logo_png"),a=Main.createBitmapByName("m-ico_png"),o=Main.createBitmapByName("count-down_png");this.aw=e.width,this.ah=e.height,this.setSc(0,0),this.scoTxt=new egret.TextField,this.scoTxt.textColor=16764928,this.scoTxt.size=35,this.scoTxt.textAlign="left",this.scoTxt.width=100,this.setSco(),this.timeTxt=new egret.BitmapText,this.timeTxt.font=RES.getRes("count_font_fnt"),this.timeTxt.text=Math.floor(this.playTime/1e3).toString(),a.x=-482,a.y=-294,this.scoTxt.x=-440,this.scoTxt.y=-291,n.x=356,n.y=-317,this.timeTxt.x=410,this.timeTxt.y=-208,o.x=410,o.y=-165,i.x=350,i.y=212;var s=Main.createBitmapByName("game_star_png"),h=Main.createBitmapByName("game_over_png");h.scaleX=h.scaleY=2,h.x=-507,h.y=-320,s.x=-44,s.y=-44,this.flyBar=new egret.Sprite,this.fly=Main.createMc("fly_json","fly_png","fly"),this.fly.addEventListener(egret.Event.COMPLETE,this.showFlyEnd,this),this.fly.x=-1,this.fly.y=-59,this.flyBar.addChild(this.fly),this.addChild(this.view),this.view.addChild(this.sc),this.sc.addChild(e),this.view.addChild(this.flyBar),this.view.addChild(h),this.view.addChild(i),this.view.addChild(n),this.view.addChild(a),this.view.addChild(o),this.view.addChild(this.scoTxt),this.view.addChild(this.timeTxt),this.view.addChild(s),this.proList=[],this.prosIn=Main.getArrayItems([0,1,2,3,4,5,6,7,8,9,10,11,12],7),this.scoPro=[],console.log(this.prosIn);for(var r=0;r<this.prosIn.length;r++){var l=this.prosIn[r],d=Main.createBitmapByName("p"+(l+1)+"_png");d.x=this.points[l].x,d.y=this.points[l].y+20,this.sc.addChild(d),this.proList.push(d);var c=Main.createBitmapByName("g-guan_png");c.x=150+30*r-this.view.y,c.y=20-this.view.x,this.view.addChild(c),this.scoPro.push(c)}this.view.touchEnabled=!0,this.view.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){this.shoot()},this),console.log("game show");var p=this;setTimeout(function(){p.showTip()},600),this.log=new egret.TextField,this.log.width=1e3,this.log.x=-500,this.log.y=-200,this.log.text="000000",this.initMotion()},e.prototype.initMotion=function(){if(window.DeviceMotionEvent){var t=this;window.addEventListener("deviceorientation",function(e){t.deviceorientationHandler(e)},!0)}},e.prototype.deviceorientationHandler=function(t){var e=t.beta,i=t.gamma;(1==this.status||2==this.status)&&(null==this.initAngle?this.initAngle={beta:e,gamma:i}:this.setSc((this.initAngle.beta-e)%360,(this.initAngle.gamma-i)%360))},e.prototype.setSc=function(t,e){var i=t/this.betaOff,n=e/this.gammaOff;i=Math.min(i,1),i=Math.max(i,-1),n=Math.min(n,1),n=Math.max(n,-1);var a=(this.aw-this.viewWidth)/2,o=(this.ah-this.viewHeigh)/2;this.sc.x=this.aw/-2+a*i,this.sc.y=this.ah/-2+o*n},e.prototype.saveOk=function(){var t=Main.user;t.c2times=t.c2times-1,Main.zoomOut(this.receive,0,400,1.2),this.view.addChild(this.share),Main.zoomIn(this.share,600,400,.6),this.copyTxt.text="领取成功",this.tipTxt.text="红包将于24小时内到账"},e.prototype.saveLuck=function(){var t=this;return Main.isTest?void t.saveOk():void $.ajax({url:Main.api,data:{ticket:Main.status_ticket,desc:"挑战红包",amount:this.sco},success:function(e){if("success"==e.result){var i=e.more;"success"==i.result?i.reason&&0==i.reason.indexOf("failedtransfer")?Main.showLost(31):(Main.status_ticket=i.ticket,t.saveOk()):Main.showLost(2)}else Main.showLost(2)},error:function(){Main.showLost(404)},timeout:8e3,dataType:"json",async:!0,type:"POST",complete:function(t,e){"timeout"==e&&Main.showLost(404)}})},e}(egret.DisplayObjectContainer);__reflect(GameScene.prototype,"GameScene");var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.count=0,e.fps=0,e.createView(),e}return __extends(e,t),e.prototype.hide=function(){var t=egret.Tween.get(this.slog);t.to({alpha:0,scaleX:.8,scaleY:.8},500,egret.Ease.backIn);var e=egret.Tween.get(this);e.wait(200),e.to({alpha:0},600)},e.prototype.createView=function(){var t=new egret.Shape;t.graphics.beginFill(0,.8),t.graphics.drawRect(0,0,640,1015),this.loadingTxt=new egret.TextField,this.loadingTxt.textAlign="center",this.loadingTxt.width=640,this.loadingTxt.text="loading...",this.loadingTxt.y=580,this.slog=new Middle(Main.createBitmapByName("slog_png")),this.slog.scaleX=this.slog.scaleY=.6,this.slog.x=320,this.slog.y=460,this.addChild(t),this.addChild(this.slog),this.addChild(this.loadingTxt);var e=egret.Tween.get(t);t.alpha=0,e.to({alpha:1},400);var i=egret.Tween.get(this.slog);this.slog.alpha=0,this.slog.scaleX=this.slog.scaleY=.5,i.wait(200),i.to({alpha:1,scaleX:.6,scaleY:.6},500,egret.Ease.backOut);var n=egret.Tween.get(this.loadingTxt);this.loadingTxt.alpha=0,n.wait(300),n.to({alpha:1},500),this.addEventListener(egret.Event.ENTER_FRAME,this.loop,this)},e.prototype.loop=function(){if(this.fps++,this.fps%5==0){this.count++,this.count>3&&(this.count=0);for(var t=".",e=0;3>e;e++)t+=e<this.count?".":" ";this.loadingTxt.text="loading"+t}this.fps>=100&&(this.fps=0)},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var LuckScene=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){var e=(this.stage.stageWidth,this.stage.stageHeight,Main.createBitmapByName("luck_bg_jpg"));this.winbar=new Middle(Main.createBitmapByName("win_bar_png")),this.receive=new Middle(Main.createBitmapByName("receive_png"));var i=new Middle(Main.createBitmapByName("help_png")),n=new Middle(Main.createBitmapByName("slog_png")),a=Main.createBitmapByName("logo_png");this.luckTxt=new egret.TextField,this.luckTxt.width=320,this.luckTxt.textColor=15538979,this.luckTxt.textAlign="center",this.luckTxt.text="您已获得1元红包！",this.luckTxt.size=32,this.luckTxt.x=-160,this.luckTxt.y=108,this.butCopy=new egret.TextField,this.butCopy.textAlign="center",this.butCopy.width=500,this.butCopy.textColor=16777215,this.butCopy.size=32,this.butCopy.text="点击领取\n还有机会赢得更多现金红包";var o=new Middle(this.butCopy);o.x=320,o.y=760,o.alpha=0,this.winbar.addChild(this.luckTxt),this.addChild(e),this.addChild(n),this.addChild(this.winbar),this.addChild(o),this.addChild(this.receive),this.addChild(i),this.addChild(a),n.x=320,n.y=220,this.winbar.x=320,this.winbar.y=540,this.receive.x=320,this.receive.y=860,i.x=320,i.y=960,n.alpha=this.winbar.alpha=this.receive.alpha=i.alpha=0,Main.zoomIn(n,500,400,.6),Main.zoomIn(this.winbar,600,400,.6),Main.zoomIn(o,700,400,.6),Main.zoomIn(this.receive,800,400,.6),Main.zoomIn(i,900,400,.6),Main.setBut(this.receive),this.receive.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){this.receive.touchEnabled=!1,this.loadLuck()},this),Main.setBut(i),i.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){Main._main.dispatchEvent(new EventObj("event","help"))},this)},e.prototype.saveOk=function(){console.log("saveOk"),this.luckTxt.text="领取成功",Main.zoomOut(this.butCopy.parent,100,400,1.6),Main.zoomOut(this.receive,200,400,1.6);var t=new egret.TextField;t.textAlign="center",t.width=500,t.textColor=16777215,t.size=32,t.text="您已经成功领取1元红包";var e=new Middle(t);e.x=320,e.y=760,e.alpha=0;var i=new egret.TextField;i.textAlign="center",i.width=500,i.textColor=16777215,i.size=20,i.text="红包将于24小时内到账";var n=new Middle(i);n.x=320,n.y=800,e.alpha=n.alpha=0,Main.zoomIn(e,400,400,.6),Main.zoomIn(n,500,400,.6),this.addChild(e),this.addChild(n),setTimeout(function(){Main._main.dispatchEvent(new EventObj("event","to_map"))},2e3)},e.prototype.loadUser=function(){console.log("loadUser");var t=this;$.ajax({url:Main.user_api,data:{ticket:Main.user_ticket,desc:"test"},success:function(e){"success"==e.result?(e.nickname=decodeURIComponent(e.nickname),e.city=decodeURIComponent(e.city),Main.user=e,t.saveOk()):Main.showLost(2)},error:function(){Main.showLost(400)},timeout:8e3,dataType:"json",async:!0,type:"POST",complete:function(t,e){"timeout"==e&&Main.showLost(502)}})},e.prototype.loadLuck=function(){var t=this;return Main.isTest?void t.saveOk():void $.ajax({url:Main.api,data:{ticket:Main.status_ticket,desc:"蓄能红包"},success:function(e){if("success"==e.result){var i=e.more;"success"==i.result?i.reason&&i.reason.indexOf("failedtransfer")>0||(Main.status_ticket=i.ticket,t.loadUser()):Main.showLost(2)}else Main.showLost(2)},error:function(){Main.showLost(404)},timeout:8e3,dataType:"json",async:!0,type:"POST",complete:function(t,e){"timeout"==e&&Main.showLost(404)}})},e}(egret.DisplayObjectContainer);__reflect(LuckScene.prototype,"LuckScene");var Main=function(t){function e(){var i=t.call(this)||this;return i.nowScene="luck",i.nowLoad="",e._main=i,i.addEventListener(egret.Event.ADDED_TO_STAGE,i.onAddToStage,i),i.addEventListener(egret.Event.RESIZE,i.reSizeHander,!0),i.addEventListener("event",i.eventHandler,i),i}return __extends(e,t),e.prototype.reSizeHander=function(t){var i=window.innerWidth/640,n=window.innerHeight/1040;e.scale=i/n,console.log("reSizeHander")},e.prototype.eventHandler=function(t){switch(console.log("eventHandler",t.name),t.name){case"help":this.showHelp();break;case"start":break;case"to_game":this.nowScene="game",this.startLoad();break;case"to_map":this.nowScene="map",this.startLoad();break;case"game_again":this.showSceneFun();break;case"to_share":$(".wx").fadeIn()}},e.prototype.onAddToStage=function(t){window.innerWidth/640,window.innerHeight/1040;e.scale=1,this.stage.scaleMode=egret.StageScaleMode.EXACT_FIT,this.getData()?this.loadUser():e.showLost(0),$(".wx").click(function(){$(".wx").fadeOut()})},e.prototype.loadConfig=function(){console.log("loadConfig"),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/config.json","resource/")},e.prototype.outOld=function(){if(this.old){var t=this.old,e=egret.Tween.get(this.old);e.to({y:-1015},600,egret.Ease.circIn),e.call(function(){t.parent&&t.parent.removeChild(t)}),this.old=null}},e.prototype.showScene=function(){var t=this;this.hideLoading(),setTimeout(function(){t.showSceneFun()},800)},e.prototype.showSceneFun=function(){console.log("showScene"),this.now&&(this.old=this.now),this.outOld(),"luck"==this.nowScene?this.now=new LuckScene:"game"==this.nowScene?this.now=new GameScene:"map"==this.nowScene&&(this.now=new MapScene),this.addChildAt(this.now,0)},e.prototype.clearOld=function(){this.old&&this.old.parent&&this.removeChild(this.old),this.old=null},e.prototype.onConfigComplete=function(t){console.log("onConfigComplete"),RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.loadGroup("loading")},e.prototype.onResourceLoadComplete=function(t){console.log("onResourceLoadComplete:"+t.groupName),this.nowLoad="","loading"==t.groupName?(this.startLoad(),"map"==this.nowScene&&this.showMsgPop()):"luck"==t.groupName?this.showScene():"map"==t.groupName?this.showScene():"game"==t.groupName&&this.showScene()},e.prototype.showHelp=function(){$.showHelp()},e.prototype.showMsgPop=function(){var t=new MsgPop;this.addChild(t)},e.prototype.showLoading=function(){this.loadingView||(this.loadingView=new LoadingUI,this.addChild(this.loadingView))},e.prototype.hideLoading=function(){this.loadingView&&(this.loadingView.hide(),this.loadingView=null)},e.prototype.startLoad=function(){this.showLoading(),this.nowLoad!=this.nowScene&&(this.nowLoad=this.nowScene,console.log("this.nowScene:"+this.nowScene),"luck"==this.nowScene?RES.loadGroup("luck"):"game"==this.nowScene?RES.loadGroup("game"):"map"==this.nowScene&&RES.loadGroup("map")),console.log("startLoad："+this.nowScene)},e.createBitmapByRes=function(t,e){var i=new egret.Bitmap,n=RES.getRes(t);return console.log("name::"+e+"::"+t),i.texture=n.getTexture(e),i},e.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},e.zoomIn=function(t,i,n,a){e.tweenTo(t,i,n,0,0,a,egret.Ease.backOut)},e.zoomOut=function(t,i,n,a){e.tweenToHide(t,i,n,0,0,a,egret.Ease.cubicIn)},e.tweenToHide=function(t,e,i,n,a,o,s){var h=egret.Tween.get(t),r=t.x,l=t.y;r+=n,l+=a,h.wait(e),h.to({alpha:0,scaleX:o,scaleY:o,x:r,y:l},i,s),h.call(function(){t.parent&&t.parent.removeChild(t)})},e.tweenTo=function(t,e,i,n,a,o,s){var h=egret.Tween.get(t),r=t.x,l=t.y;t.scaleX=t.scaleY=o,t.x=r+n,t.y=l+a,h.wait(e),h.to({alpha:1,scaleX:1,scaleY:1,x:r,y:l},i,s)},e.createMc=function(t,e,i){var n=RES.getRes(t),a=RES.getRes(e),o=new egret.MovieClipDataFactory(n,a),s=new egret.MovieClip(o.generateMovieClipData(i));return s},e.setBut=function(t){t&&(t.touchEnabled=!0,t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){t.alpha=.68},t),t.addEventListener(egret.TouchEvent.TOUCH_END,function(){t.alpha=1},t),t.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,function(){t.alpha=1},t))},e.prototype.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},e.prototype.onResourceProgress=function(t){},e.prototype.getData=function(){var t,i=window.location.href.split("#")[0].split("?")[1];return console.log("loadUser"),e.isTest?!0:i&&i.length>20?(t=i.split(","),e.user_ticket=t[0],e.status_ticket=t[1],console.log(e.user_ticket,e.status_ticket),!0):!1},e.reSetShareUrl=function(){var t,i=e.user,n=i.more,a=n.mytotal;t=0==i.mysort?0:Math.floor((i.more.total-i.more.mysort)/(i.more.total-1)*100);var o=n.mytotal,s=i.headimgurl.split("http://")[1],h=encodeURIComponent(i.nickname),r=$.shareObj;r.link="http://res.leasiondata.cn/lstatic/p/share.html?f="+s+"&n="+h+"&t="+a+"&w="+t+"&m="+o,r.copy=i.nickname+"酒量战胜全国"+t+"%酒友！赢取"+o+"元现金红包！买青啤原浆开罐扫码与他一战！",$.setWxObj()},e.prototype.loadUser=function(){if(console.log("loadUser"),e.isTest)return this.nowScene="game",this.loadConfig(),void(e.user={nickname:"jeff",headimgurl:"http://wx.qlogo.cn/mmopen/6BD2qP9V7sout0oux0ts55Pns1xtEpOl7icGF5GV68YdruILNBBCJvMMFCy0Wbbl7zFiaibjfibaIlKFcYIhRM6ntCU37lhk8amY/0"});var t=this;$.ajax({url:e.user_api,data:{ticket:e.user_ticket,desc:"test"},success:function(i){if("success"==i.result){i.nickname=decodeURIComponent(i.nickname),i.city=decodeURIComponent(i.city),e.user=i;i.more;""==i.c1ashed?t.nowScene="luck":t.nowScene="map",t.loadConfig(),e.reSetShareUrl()}else e.showLost(2)},error:function(){e.showLost(400)},timeout:8e3,dataType:"json",async:!0,type:"POST",complete:function(t,i){"timeout"==i&&e.showLost(502)}})},e.prototype.onGetComplete=function(t){var e=t.currentTarget;console.log("get data : ",e.response)},e.prototype.onGetIOError=function(t){},e.prototype.onGetProgress=function(t){},e.prototype.showLost=function(t){console.log("showLost");var e=new egret.Sprite,i=new egret.Shape;i.graphics.beginFill(0,.8),i.graphics.drawRect(0,0,640,1040);var n=new egret.TextField;n.background=!1,n.width=600,n.textColor=16777215,n.textAlign="center",n.size=36,0==t?n.text="错误的链接，请重新扫码...":1==t?n.text="已过期，请重新扫码...":2==t?n.text="网络异常，请重新扫码...":3==t?n.text="码已经被抽过了...":31==t?n.text="您已领过奖品":400==t?n.text="表示系统繁忙，请稍后再试...":502==t?n.text="访问超时，请重新扫码...":n.text="已过期，请重新扫码...",n.y=500,n.x=20,e.addChild(i),e.addChild(n),this.addChild(e),e.alpha=0;var a=egret.Tween.get(e);a.to({alpha:1},400)},e.showLost=function(t){e._main.showLost(t)},e.getArrayItems=function(t,e){var i=new Array;for(var n in t)i.push(t[n]);for(var a=new Array,o=0;e>o&&i.length>0;o++){var s=Math.floor(Math.random()*i.length);a[o]=i[s],i.splice(s,1)}return a},e}(egret.DisplayObjectContainer);Main.isTest=!0,Main.user_api="http://leasiondata.cn/info",Main.api="http://leasiondata.cn/play",Main.user_ticket="d82cf56540134d6f93fb88d3edf5dc50",Main.status_ticket="136c4f5463e047deb8e797c5a94280dc",Main.user={nickname:"",headimgurl:""},Main._main=null,Main.scale=1,Main.location={country:null,province:null,city:null},Main.award={uid:null,nickname:null,type:"cash",count:1},__reflect(Main.prototype,"Main");var MapScene=function(t){function e(){var e=t.call(this)||this;if(e.mapInfo={level:2,count:14,now:7,fly:7,playCount:1,top:0},e.flyCount=7,Main.isTest)e.mapInfo.level=Math.floor(3*Math.random()),e.mapInfo.count=16+Math.floor(15*Math.random()),e.mapInfo.now=7+Math.floor(2*Math.random()),e.mapInfo.fly=e.mapInfo.now,e.mapInfo.fly=7,e.mapInfo.fly>=7?e.mapInfo.playCount=1+Math.floor(2*Math.random()):e.mapInfo.playCount=0;else{var i=Main.user;i=i.more;var n;e.mapInfo.count=i.mytotal,e.mapInfo.now=i.todaytotal,e.mapInfo.playCount=i.c2times,e.mapInfo.playCount>0?e.mapInfo.fly=e.flyCount:e.mapInfo.fly=i.mytotal%e.flyCount,0==i.mysort?e.mapInfo.top=0:e.mapInfo.top=Math.floor((i.total-i.mysort)/(i.total-1)*100),n=e.mapInfo.top>=90?3:e.mapInfo.top>=50?2:1,e.mapInfo.level=n,Main.reSetShareUrl()}return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e.addEventListener("event",e.eventHandler,e),e}return __extends(e,t),e.prototype.eventHandler=function(t){switch(t.name){case"close_help":console.log("close_help");break;case"play_end":console.log("play_end");break;case"to_shop":}console.log(t.type+":"+t.name)},e.prototype.onAddToStage=function(t){var e,i,n=(this.stage.stageWidth,this.stage.stageHeight,new egret.Sprite),a=Main.createBitmapByName("luck_bg_jpg");e=this.mapInfo.playCount>0?Main.createBitmapByName("map-bg2_jpg"):Main.createBitmapByName("map-bg_jpg"),console.log("bar::"+e),i=3==this.mapInfo.level?Main.createBitmapByName("map-bian-j_png"):2==this.mapInfo.level?Main.createBitmapByName("map-bian-y_png"):Main.createBitmapByName("map-bian-t_png");var o,s=Main.createBitmapByName("map-line-gary_png"),h=Main.createBitmapByName("map-line-red_png"),r=new egret.Shape,l=new egret.Sprite,d=Main.createBitmapByName("map_road_png"),c=new egret.Sprite,p=new Middle(Main.createBitmapByName("map-share_png")),g=Main.createBitmapByName("pro-mini_png"),u=Main.createBitmapByName("fly-mini_png"),c=new egret.Sprite,m=new egret.TextField;m.textAlign="center",m.width=550,m.textColor=0,m.size=24;var y=new egret.TextField;y.textAlign="right",y.width=120,y.textColor=0,y.size=16,y.text="您已累计喝下";var w=new egret.TextField;w.textAlign="left",w.width=50,w.textColor=0,w.size=16,w.text="罐鲜啤";var v=new egret.TextField;v.textAlign="right",v.width=100,v.textColor=0,v.size=16,v.text="今天喝下第";var f=new egret.TextField;f.textAlign="left",f.width=20,f.textColor=0,f.size=16,f.text="罐";var x=new egret.TextField;x.textAlign="center",x.width=447,x.textColor=15538979,x.size=24,x.text="战胜全国"+this.mapInfo.top+"%的酒友";var M=new egret.TextField;M.textAlign="right",M.width=50,M.textColor=0,M.size=18,M.text="还差";var _=new egret.TextField;_.textAlign="left",_.width=200,_.textColor=0,_.size=18,_.text="罐就能挑战大红包咯";var C=new egret.BitmapText;C.font=RES.getRes("count_font_fnt"),C.text=this.mapInfo.now.toString(),C.scaleX=C.scaleY=.8;var T=new egret.BitmapText;T.font=RES.getRes("count_font_fnt"),T.text=this.mapInfo.count.toString();var E=new egret.BitmapText;E.font=RES.getRes("count_font_fnt"),E.text=(this.flyCount-this.mapInfo.fly).toString();var B=new egret.Sprite;B.addChild(M),B.addChild(_),B.addChild(E);var S=new egret.TextField;S.textAlign="center",S.width=447,S.textColor=0,S.size=18;var L=new egret.TextField;L.textAlign="center",L.width=256,L.textColor=16777215,L.size=33,L.x=-128,L.y=-18,this.mapInfo.playCount>0?(o=new Middle(Main.createBitmapByName("game-but_png")),L.text="挑战大红包X"+this.mapInfo.playCount,o.addChild(L)):(o=new Middle(Main.createBitmapByName("game-but2_png")),L.textColor=11119017,L.text="挑战大红包X"+this.mapInfo.playCount,o.addChild(L));var b=new Middle(Main.createBitmapByName("help_png")),k=new Middle(Main.createBitmapByName("map-hongbao_png")),I=new Middle(Main.createBitmapByName("map-yinzhang_png"));this.mapInfo.playCount>0?S.text="马上挑战，赢现金红包！":S.text="7 天鲜啤 开罐扫码有奖\n累计7 罐 更有超大现金红包等你挑战！";var O=Main.user;O.nickname=decodeURIComponent(O.nickname),m.text=O.nickname,m.y=72,y.x=260-y.width,T.x=y.x+y.width+5,w.x=T.x+5+T.width,T.y=98,y.y=116,w.y=116,x.x=50,x.y=136,E.y=-15,M.x=-140,E.x=M.x+5+M.width,_.x=E.x+5+E.width,f.x=508,C.x=f.x-5-C.width,v.x=C.x-5-v.width,C.y=20,v.y=34,f.y=34,p.x=273.5,p.y=190,S.x=50,S.y=230,l.x=47,l.y=62,g.x=450,g.y=717,u.x=520,u.y=800,i.x=-8,i.y=-54,c.x=224,c.y=-40,o.x=274,o.y=806,n.x=90,n.y=276,s.x=-36,s.y=42,h.x=-36,h.y=42,B.x=274,B.y=860,n.addChild(s),n.addChild(h),n.addChild(r),n.addChild(d),this.addChild(a),this.addChild(l),l.addChild(e),l.addChild(i),l.addChild(n),l.addChild(c),l.addChild(u),l.addChild(g),l.addChild(m),l.addChild(y),l.addChild(T),l.addChild(w),l.addChild(v),l.addChild(C),l.addChild(f),l.addChild(x),l.addChild(p),l.addChild(S),l.addChild(o),b.x=320,b.y=990,this.addChild(b),h.mask=r,this.face=c,this.loadFace(O.headimgurl);var R=[{x:186,y:376},{x:287,y:352},{x:376,y:333},{x:429,y:434},{x:366,y:508},{x:328,y:583},{x:302,y:678}],A=[],N=["mini-fly1","mini-fly2","mini-fly3"],z=[{x:34,y:46},{x:22,y:56},{x:12,y:39}];k.x=R[6].x,k.y=R[6].y,I.x=k.x+80,I.y=k.y+40,k.alpha=0,I.alpha=0,o.alpha=0,o.visible=!1,l.addChild(k),l.addChild(I);for(var F,P=this,j=0;j<this.mapInfo.fly;j++){F=Math.floor(Math.random()*N.length);var U=Main.createMc(N[F]+"_json",N[F]+"_png",N[F]);console.log(N[F],F),A.push(U),console.log("r::"+F+":"+j+":"+z[F]+":"+R[j]),U.x=R[j].x-z[F].x,U.y=R[j].y-z[F].y,l.addChild(U),U.visible=!1,setTimeout(function(t){var e=t;e==P.mapInfo.fly-1?e==P.flyCount-1?(Main.zoomIn(k,0,400,1.6),setTimeout(function(){A[e].visible=!0,A[e].play(1),o.visible=!0,Main.zoomIn(I,300,400,1.6),Main.zoomIn(o,600,400,1.6)},300)):setTimeout(function(){A[e].visible=!0,A[e].play(1),o.visible=!0,B.alpha=0,l.addChild(B),Main.zoomIn(o,400,400,1.6),Main.zoomIn(B,600,400,1.6)},300):(A[e].visible=!0,A[e].play(1))},300*j+800,[j])}Main.setBut(p),p.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){Main._main.dispatchEvent(new EventObj("event","to_share"))},this),this.mapInfo.playCount>0&&(Main.setBut(o),o.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){Main._main.dispatchEvent(new EventObj("event","to_game"))},this)),Main.setBut(b),b.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){Main._main.dispatchEvent(new EventObj("event","help"))},this)},e.prototype.loadFace=function(t){var e=new egret.URLLoader;e.dataFormat=egret.URLLoaderDataFormat.TEXTURE,e.addEventListener(egret.Event.COMPLETE,this.onLoadFaceComplete,this);var i=new egret.URLRequest(t);e.load(i)},e.prototype.onLoadFaceComplete=function(t){var e=t.target,i=e.data,n=new egret.Bitmap(i),a=egret.Tween.get(n);n.alpha=0,n.width=98,n.height=98,a.to({alpha:1},400);var o=new egret.Shape;o.graphics.beginFill(0),o.graphics.drawCircle(48,48,48),n.mask=o,this.face.addChild(n),this.face.addChild(o)},e}(egret.DisplayObjectContainer);__reflect(MapScene.prototype,"MapScene");var Middle=function(t){function e(e){var i=t.call(this)||this;return e.x=e.width/-2,e.y=e.height/-2,i.addChild(e),i}return __extends(e,t),e}(egret.Sprite);__reflect(Middle.prototype,"Middle");var MsgPop=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){var e=new egret.Shape;e.graphics.beginFill(0,.9),e.graphics.drawRect(0,0,640,1015);var i=new Middle(Main.createBitmapByName("out_png"));i.x=320,i.y=507.5;var n=new egret.TextField;n.width=480,n.textColor=16777215,n.textAlign="center",n.text="您的二维码已被抽奖\n若有任何疑问请联系客服",n.size=32,n.lineSpacing=12,n.x=-240,n.y=-180,this.addChild(e),this.addChild(i),i.addChild(n),i.alpha=0,e.alpha=0,Main.tweenTo(e,0,400,0,0,1,egret.Ease.cubicOut),Main.zoomIn(i,200,400,.6),this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){this.parent&&this.parent.removeChild(this)},this)},e}(egret.Sprite);__reflect(MsgPop.prototype,"MsgPop");var Win=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e.addEventListener("event",e.eventHandler,e),e}return __extends(e,t),e.prototype.eventHandler=function(t){switch(t.name){case"close_help":console.log("close_help");break;case"play_end":console.log("play_end");break;case"to_shop":}console.log(t.type+":"+t.name)},e.prototype.onAddToStage=function(t){this.stage.stageWidth,this.stage.stageHeight},e}(egret.DisplayObjectContainer);__reflect(Win.prototype,"Win");
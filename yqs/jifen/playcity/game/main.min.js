var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},End=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){var e=new egret.Shape,i=Main.createBitmapByName("w"+Main.win+"_png");e.graphics.beginFill(0,.68),e.graphics.drawRect(0,0,640,1010);var a=Main.createBitmapByName("lingjiang_png"),n=Main.createBitmapByName("close_png");n.x=520,n.y=120;var s=new egret.Sprite,o=Main.createBitmapByName("guang_png"),r=new egret.Sprite;o.x=-o.width/2,o.y=-o.height/2,s.addChild(o),s.x=320,s.y=505,i.height=i.height*Main.scale,i.x=-i.width/2,i.y=i.height/-2,r.addChild(i),r.x=320,r.y=450,a.x=(640-a.width)/2,a.y=450-i.y+20,this.addChild(e),this.addChild(s),this.addChild(r),Main.win>1?this.addChild(a):this.addChild(n),e.alpha=0,s.alpha=0,r.alpha=0,r.scaleX=r.scaleY=.6,a.alpha=0;var h=egret.Tween.get(e);h.to({alpha:1},300);var h=egret.Tween.get(s);h.wait(100).to({alpha:1},300);var h=egret.Tween.get(r);h.wait(200).to({alpha:1,scaleX:1,scaleY:1},300,egret.Ease.backOut);var h=egret.Tween.get(a);h.wait(300).to({alpha:1},300),o.touchEnabled=!0,Main.setBut(a),a.touchEnabled=!0,a.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){var e=0;(2==Main.win||3==Main.win)&&(e=1),window.location.href="../receive.html?token="+Main.token+"&oid="+Main.oid+"&type="+e},this),n.touchEnabled=!0,n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){this.parent&&this.parent.removeChild(this)},this),setInterval(function(){s.rotation+=2},100)},e}(egret.Sprite);__reflect(End.prototype,"End");var Help=function(t){function e(){var e=t.call(this)||this;return e.initView(),e}return __extends(e,t),e.prototype.initView=function(){var t=new egret.Shape;t.graphics.beginFill(0,.68),t.graphics.drawRect(0,0,640,1010);var e=Main.createBitmapByName("close-help_png"),i=Main.createBitmapByName("help-copy_png");i.x=68,i.y=220,e.x=236,e.y=645,this.addChild(t),this.addChild(i),this.addChild(e),Main.setBut(e);var a=this;this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){a.parent&&a.parent.removeChild(a)},this)},e}(egret.Sprite);__reflect(Help.prototype,"Help");var LoadingUI=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=500,this.textField.width=600,this.textField.height=100,this.textField.textColor=6710886,this.textField.textAlign="center",this.textField.text="Loading..."},e.prototype.setProgress=function(t,e){},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var Main=function(_super){function Main(){var t=_super.call(this)||this;return t.count=0,t.loaded=0,Main._main=t,t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t}return __extends(Main,_super),Main.prototype.onAddToStage=function(t){var e=window.innerWidth/640,i=window.innerHeight/1040;if(Main.scale=e/i,this.stage.scaleMode=egret.StageScaleMode.EXACT_FIT,Main.isTest||this.getData()){this.loadUser();var a=this;setInterval(function(){a.loadUser()},3e4)}else Main.showLost("没有用户信息，请返回。")},Main.getQueryString=function(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)","i"),i=window.location.search.substr(1).match(e);return null!=i?decodeURIComponent(i[2]):null},Main.prototype.loadConfig=function(){console.log("loadConfig"),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/config.json","resource/")},Main.prototype.showScene=function(){console.log("showScene"),this.scene=new Scene,this.stage.addChildAt(this.scene,0)},Main.prototype.clearOld=function(){this.old&&this.old.parent&&this.removeChild(this.old),this.old=null},Main.prototype.onConfigComplete=function(t){console.log("onConfigComplete"),RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.loadGroup("sc")},Main.prototype.onResourceLoadComplete=function(t){console.log("onResourceLoadComplete:"+t.groupName),this.scene=new Scene,this.stage.addChildAt(this.scene,0),this.stage.removeChild(this.loadingView)},Main.createBitmapByRes=function(t,e){var i=new egret.Bitmap,a=RES.getRes(t);return console.log("name::"+e+"::"+t),i.texture=a.getTexture(e),i},Main.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},Main.tweenTo=function(t,e,i,a,n,s,o){var r=egret.Tween.get(t),h=t.x,p=t.y,l=t.width,d=t.height;t.scaleX=t.scaleY=s,t.x=h+a+(1-s)/2*l,t.y=p+n+(1-s)/2*d,r.wait(e),r.to({alpha:1,scaleX:1,scaleY:1,x:h,y:p},i,o)},Main.createMc=function(t,e,i){var a=RES.getRes(t),n=RES.getRes(e),s=new egret.MovieClipDataFactory(a,n),o=new egret.MovieClip(s.generateMovieClipData(i));return o},Main.setBut=function(t){t&&(t.touchEnabled=!0,t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){t.alpha=.68},t),t.addEventListener(egret.TouchEvent.TOUCH_END,function(){t.alpha=1},t),t.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,function(){t.alpha=1},t))},Main.prototype.onResourceLoadError=function(t){this.onResourceLoadComplete(t)},Main.prototype.onResourceProgress=function(t){this.loadingView.setProgress(t.itemsLoaded,t.itemsTotal)},Main.prototype.getData=function(){window.location.href.split("#")[0].split("?")[1];return console.log("loadUser"),Main.token=Main.getQueryString("token"),Main.isTest||Main.token?!0:!1},Main.prototype.loadUser=function(){if(console.log("loadUser",Main.userApi),Main.isTest)return Main.user.name="test",Main.user.uid="100",Main.user.profile="",Main.user.point=100,void this.loadConfig();var _this1=this;$.post(Main.userApi,{token:Main.token},function(result){var data=eval("("+result+")");data.error?(console.log(data.error_code,data.error),_this1.showLost("错误的用户信息。")):(Main.user.name=data.name,Main.user.uid=data.uid,Main.user.profile=data.profile_image_url,Main.user.point=data.point,_this1.loadConfig())})},Main.prototype.onGetComplete=function(t){var e=t.currentTarget;console.log("get data : ",e.response)},Main.prototype.onGetIOError=function(t){},Main.prototype.onGetProgress=function(t){},Main.prototype.showLost=function(t){console.log("showLost");var e=new egret.Sprite,i=new egret.Shape;i.graphics.beginFill(0,.8),i.graphics.drawRect(0,0,640,1040);var a=new egret.TextField;a.background=!1,a.width=600,a.textColor=16777215,a.textAlign="center",a.size=36,a.text=t,a.y=500,a.x=20,e.addChild(i),e.addChild(a),this.addChild(e),e.alpha=0;var n=egret.Tween.get(e);n.to({alpha:1},400),setTimeout(function(){window.location.href="http://0k6.cn/a/gotoplaycity"},2e3)},Main.showLost=function(t){Main._main.showLost(t)},Main.track=function(t){},Main.trackEvent=function(t){},Main}(egret.DisplayObjectContainer);Main.shopUrl="",Main.win=0,Main.oid="",Main.isTest=!0,Main.userApi="http://play.leasiondata.cn/lsplaycity/user_info",Main.api="http://play.leasiondata.cn/lsplaycity/luck",Main.token="d82cf56540134d6f93fb88d3edf5dc50",Main.product_type="tk",Main.user={},Main._main=null,Main.scale=1,Main.luck={},Main.location={country:null,province:null,city:null},Main.award={uid:null,nickname:null,type:"cash",count:.88},__reflect(Main.prototype,"Main");var Scene=function(t){function e(){var e=t.call(this)||this;return e.inLuck=0,e.speed1=0,e.speed2=0,e.speed3=0,e.sa1=0,e.sa2=0,e.sa3=0,e.stop1=100,e.stop2=100,e.stop3=100,e.pList=[],e.gCount=9,e.stopA=10,e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){var e=(this.stage.stageWidth,this.stage.stageHeight);this.pointText=new egret.TextField,this.pointText.textFlow=[{text:"剩余积分：",style:{textColor:3368601,size:22}},{text:Main.user.point,style:{textColor:3368601,size:26}}],this.pointText.x=250,this.pointText.y=208,this.points=[0,0,0],this.list=[],this.list[0]=[Main.createBitmapByName("g0_png"),Main.createBitmapByName("g1_png"),Main.createBitmapByName("g2_png"),Main.createBitmapByName("g3_png"),Main.createBitmapByName("g4_png"),Main.createBitmapByName("g5_png"),Main.createBitmapByName("g6_png"),Main.createBitmapByName("g7_png"),Main.createBitmapByName("g8_png"),Main.createBitmapByName("g0_png"),Main.createBitmapByName("g1_png"),Main.createBitmapByName("g2_png")],this.list[1]=[Main.createBitmapByName("g5_png"),Main.createBitmapByName("g4_png"),Main.createBitmapByName("g3_png"),Main.createBitmapByName("g2_png"),Main.createBitmapByName("g1_png"),Main.createBitmapByName("g0_png"),Main.createBitmapByName("g8_png"),Main.createBitmapByName("g7_png"),Main.createBitmapByName("g6_png"),Main.createBitmapByName("g5_png"),Main.createBitmapByName("g4_png"),Main.createBitmapByName("g3_png")],this.list[2]=[Main.createBitmapByName("g6_png"),Main.createBitmapByName("g8_png"),Main.createBitmapByName("g7_png"),Main.createBitmapByName("g4_png"),Main.createBitmapByName("g3_png"),Main.createBitmapByName("g5_png"),Main.createBitmapByName("g1_png"),Main.createBitmapByName("g2_png"),Main.createBitmapByName("g0_png"),Main.createBitmapByName("g6_png"),Main.createBitmapByName("g8_png"),Main.createBitmapByName("g7_png")],this.pList=[[8,0,1,2,3,4,5,6,7],[4,3,2,1,0,8,7,6,5],[7,5,6,3,2,4,8,1,0]];var i;this.playBar=new egret.Sprite,this.bar1=new egret.Sprite,this.bar2=new egret.Sprite,this.bar3=new egret.Sprite,this.help=new Help;var a=Main.createBitmapByName("help-but_png");for(a.x=420,a.y=880,i=0;i<this.list[0].length;i++)this.list[0][i].scaleY=Main.scale,this.list[1][i].scaleY=Main.scale,this.list[2][i].scaleY=Main.scale,this.list[0][i].x=60-this.list[0][i].width/2,this.list[0][i].y=100*i+50-this.list[0][i].height/2,this.list[1][i].x=60-this.list[1][i].width/2,this.list[1][i].y=100*i+50-this.list[1][i].height/2,this.list[2][i].x=60-this.list[2][i].width/2,this.list[2][i].y=100*i+50-this.list[2][i].height/2,this.bar1.addChild(this.list[0][i]),this.bar2.addChild(this.list[1][i]),this.bar3.addChild(this.list[2][i]);var n=new egret.Shape;n.graphics.beginFill(0,1),n.graphics.drawRect(0,0,440,302);var s=Main.createBitmapByName("bg_jpg");s.x=0,s.y=0;var o=Main.createBitmapByName("man_png"),r=Main.createBitmapByName("over_png");o.x=0,o.y=e-o.height;var h=Main.createBitmapByName("sc_png"),p=Main.createBitmapByName("start_png");h.y=-38,p.x=380,p.y=688,this.but=p,this.playBar.x=115,this.playBar.y=314,n.x=105,n.y=314,r.x=112,r.y=304,this.bar2.x=150,this.bar3.x=300,this.playBar.addChild(this.bar1),this.playBar.addChild(this.bar2),this.playBar.addChild(this.bar3),this.addChild(s),this.addChild(h),this.addChild(this.playBar),this.addChild(n),this.addChild(r),this.addChild(this.pointText),this.addChild(p),this.playBar.mask=n,this.addChild(o),this.addChild(a),this.addChild(this.help);Main.setBut(p),p.touchEnabled=!0,p.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){this.play(),console.log("start_png")},this),a.touchEnabled=!0,a.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){this.addChild(this.help)},this)},e.prototype.setMove=function(t,e,i,a,n){var s=100*this.gCount;return 0>=n?this.points[e]=this.points[e]+(n-this.points[e])/this.stopA:(a+=(i-a)/100,this.points[e]+=a),t.y=this.points[e]%s,a},e.prototype.play=function(){if(0==this.inLuck){this.but.touchEnabled=!1;this.speed1=-80-80*Math.random(),this.speed2=-80-80*Math.random(),this.speed3=-80-80*Math.random(),this.addEventListener(egret.Event.ENTER_FRAME,this.loop,this),this.inLuck=1,this.loadLuck()}console.log("play")},e.prototype.initBar=function(){this.removeEventListener(egret.Event.ENTER_FRAME,this.loop,this),this.speed1=0,this.speed2=0,this.speed3=0,this.sa1=0,this.sa2=0,this.sa3=0,this.stop1=100,this.stop2=100,this.stop3=100,this.inLuck=0,console.log("initBar")},e.prototype.toWin=function(){var t,e,i,a,n=Main.win;0==n?(t=Math.random(),.33>t?(e=0,i=Math.floor(Math.random()*(this.gCount-1))+1,a=Math.floor(Math.random()*(this.gCount-1))+1):.66>t?(i=0,e=Math.floor(Math.random()*(this.gCount-1))+1,a=Math.floor(Math.random()*(this.gCount-1))+1):(a=0,e=Math.floor(Math.random()*(this.gCount-1))+1,i=Math.floor(Math.random()*(this.gCount-1))+1)):e=i=a=n,console.log(e,i,a),this.setStop1(e);var s=this;setTimeout(function(){s.setStop2(i)},1e3),setTimeout(function(){s.setStop3(a)},2e3),setTimeout(function(){s.showEnd()},5e3),this.pointText.textFlow=[{text:"剩余积分：",style:{textColor:3368601,size:22}},{text:Main.user.point,style:{textColor:3368601,size:26}}]},e.prototype.showEnd=function(){var t=this;this.but.touchEnabled=!0,this.end=new End,this.addChild(this.end),setTimeout(function(){t.initBar()},500)},e.prototype.setStop1=function(t){var e=this.pList[0][t],i=100*this.gCount;this.stop1=Math.round((this.sa1*this.stopA+this.points[0])/900)*i-100*e},e.prototype.setStop2=function(t){var e=this.pList[1][t],i=100*this.gCount;this.stop2=Math.round((this.sa2*this.stopA+this.points[1])/900)*i-100*e},e.prototype.setStop3=function(t){var e=this.pList[2][t],i=100*this.gCount;this.stop3=Math.round((this.sa3*this.stopA+this.points[2])/900)*i-100*e},e.prototype.loop=function(){this.sa1=this.setMove(this.bar1,0,this.speed1,this.sa1,this.stop1),this.sa2=this.setMove(this.bar2,1,this.speed2,this.sa2,this.stop2),this.sa3=this.setMove(this.bar3,2,this.speed3,this.sa3,this.stop3)},e.prototype.loadLuck=function(){console.log("loadLuck");var t=new Date,e=this;if(Main.isTest){Main.luck={type:-1};var i={p1:6,p2:5,p3:4,p4:8,p5:7,p6:3,p7:2,p8:1,p9:0},a=9;Main.win=i["p"+a];var n=(new Date).getTime()-t.getTime();return void(2e3>n?setTimeout(function(){e.toWin()},1e3):e.toWin())}2!=this.inLuck&&(this.inLuck=2,$.ajax({url:Main.api,data:{token:Main.token,ran:Math.random()*(new Date).getTime()},error:function(){Main.showLost("出现错误，请稍后尝试")},success:function(i){if(1==i.response){Main.user.point=Main.user.point-i.price,Main.luck=i;var a={p1:6,p2:5,p3:4,p4:8,p5:7,p6:3,p7:2,p8:1,p9:0};Main.win=a["p"+i.pid],console.log(Main.win),Main.oid=i.oid;var n=(new Date).getTime()-t.getTime();2e3>n?setTimeout(function(){e.toWin()},1e3):e.toWin()}else 2==i.response?Main.showLost(i.message):i.error_code?Main.showLost(i.error):Main.showLost("出现错误，请稍后尝试")},dataType:"json",async:!0,type:"POST"}))},e}(egret.DisplayObjectContainer);__reflect(Scene.prototype,"Scene");
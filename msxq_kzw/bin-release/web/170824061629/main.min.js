var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},MarkerItemView=function(_super){function MarkerItemView(){var t=_super.call(this)||this;return t.showMenu=!1,t.initView(),t.touchEnabled=!0,t.addEventListener(egret.TouchEvent.TOUCH_TAP,t.touchClickHandler,t),t.addEventListener(egret.Event.ADDED_TO_STAGE,t.addStageHandler,t),t}return __extends(MarkerItemView,_super),MarkerItemView.prototype.addStageHandler=function(){this.alpha=0,this.scaleY=this.scaleX=0,egret.Tween.get(this).to({alpha:1,scaleX:1,scaleY:1},1e3)},MarkerItemView.prototype.touchClickHandler=function(t){this.data&&this.data.type>1&&PopManager.showPop("ThreePop",this.data.type)},MarkerItemView.prototype.initView=function(){this.txtName=new egret.TextField,this.txtName.background=!0,this.txtName.fontFamily="宋体",this.txtName.size=23,this.txtName.y=-60,this.addChild(this.txtName)},MarkerItemView.prototype.setData=function(t){this.data=t,t&&(this.txtName.text=t.name+"",this.txtName.x=-this.txtName.textWidth/2,this.txtName.backgroundColor=this.getTextColor(),this.monster=Global.createMc("monster_json","monster_png","m1"),this.addChild(this.monster),this.monster.anchorOffsetX=this.monster.width/2,this.monster.anchorOffsetY=this.monster.height/2,this.refreshPos())},MarkerItemView.prototype.getTextColor=function(){if(this.data){if(console.log(this.data.type),1==this.data.type)return 11722734;if(2==this.data.type)return 16766720;if(3==this.data.type)return 16776960;if(4==this.data.type)return 15643828}return 11674146},MarkerItemView.prototype.refreshPos=function(){if(this.data&&MapManager.instance.Gmap){var p=eval("MapManager.instance.Gmap.pointToPixel(new BMap.Point("+this.data.lng+","+this.data.lat+"))");this.x=p.x*(StageUtils.SW/StageUtils.LW),this.y=p.y*(StageUtils.SH/StageUtils.LH),console.log(p.x,p.y,this.x,this.y),this.monster&&this.monster.play(-1)}},MarkerItemView}(egret.DisplayObjectContainer);__reflect(MarkerItemView.prototype,"MarkerItemView");var SelfMarkerView=function(_super){function SelfMarkerView(){var t=_super.call(this)||this,e=new egret.Shape;e.graphics.beginFill(38655,.15),e.graphics.drawCircle(0,0,300),e.graphics.endFill(),t.addChild(e);var i=Global.createBitmapByName("self_png");return i.anchorOffsetX=i.width>>1,i.anchorOffsetY=i.height-16,t.addChild(i),t.head_tip=Global.createBitmapByName("head_tip_png"),t.head_tip.x=100,t.head_tip.y=235,UIManager.instance.topLayer.addChild(t.head_tip),t.head_tip.visible=!1,t}return __extends(SelfMarkerView,_super),SelfMarkerView.prototype.touchClickHandler=function(t){this.showMenu?this.head_tip.visible=!0:this.head_tip.visible=!1,this.showMenu=!this.showMenu},SelfMarkerView.prototype.setData=function(){this.data={},this.txtName.text="",this.loadHead(),this.refreshPos()},SelfMarkerView.prototype.loadHead=function(){var t=UserInfo.instance.url,e=this,i=new CustomImage(t,!1,function(){i.width=95,i.height=95,i.x=-48,i.y=-120;var t=new egret.Shape;t.graphics.beginFill(0),t.graphics.drawCircle(50,50,45),t.x=i.x,t.y=i.y,i.mask=t,e.addChild(i),e.addChild(t)});this.head=i,this.addChild(i)},SelfMarkerView.prototype.onLoadComplete=function(t){var e=t.target,i=e.data,o=new egret.Bitmap(i);o.width=70,o.height=70,o.x=-35,o.y=-35;var a=new egret.Shape;a.graphics.beginFill(0),a.graphics.drawCircle(35,35,35),a.x=-35,a.y=-35,o.mask=a,this.addChild(o),this.addChild(a),this.head=o},SelfMarkerView.prototype.refreshPos=function(){if(MapManager.instance.Gmap){var p=eval("MapManager.instance.Gmap.pointToPixel(new BMap.Point("+MapManager.instance.lng+","+MapManager.instance.lat+"))");this.x=p.x*(StageUtils.SW/StageUtils.LW),this.y=p.y*(StageUtils.SH/StageUtils.LH),console.log(p.x,p.y,this.x,this.y),this.monster&&this.monster.play(-1)}},SelfMarkerView}(MarkerItemView);__reflect(SelfMarkerView.prototype,"SelfMarkerView");var PopView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.show=function(){var t=new egret.Shape;t.graphics.beginFill(0,.8),t.graphics.drawRect(0,0,StageUtils.stage.stageWidth,StageUtils.stage.stageHeight),t.graphics.endFill(),this.addChildAt(t,0),t.alpha=0,Global.fadeIn(t),UIManager.instance.popLayer.addChild(this),this.touchEnabled=!0},e.prototype.hide=function(){UIManager.instance.popLayer.removeChild(this)},e.prototype.setData=function(t){void 0===t&&(t=null),this.data=t},e}(egret.DisplayObjectContainer);__reflect(PopView.prototype,"PopView");var CountData=function(){function t(){this.lastTime=0}return Object.defineProperty(t,"instance",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),t.prototype.init=function(t,e){this.ticket=e,t&&(t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.beginHandler,this),t.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.moveHandler,this),t.addEventListener(egret.TouchEvent.TOUCH_END,this.endHandler,this),t.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.endHandler,this))},t.prototype.beginHandler=function(t){console.log("beginHandler"),this.isMove=!1,this.startX=t.stageX,this.startY=t.stageY},t.prototype.moveHandler=function(t){console.log("moveHandler"),this.isMove=!0},t.prototype.endHandler=function(t){console.log("endHandler");var e,i=t.stageX,o=t.stageY;if(this.isMove){var a=i-this.startX,n=o-this.startY;e=Math.abs(a)>Math.abs(n)?a>0?"right":"left":n>0?"down":"up",console.log("move:"+e)}else e="clilck",console.log("click");var s=egret.getTimer();if(!(s-this.lastTime<200)){this.lastTime=s;$.ajax({url:"http://123.59.156.230/lstat",data:{from:"H5",url:window.location.href,px:i,py:o,operation:e,ticket:this.ticket},success:function(t){},error:function(){console.log("error")},timeout:8e3,dataType:"json",async:!0,type:"POST",complete:function(t,e){"timeout"==e&&console.log("timeout")}})}},t}();__reflect(CountData.prototype,"CountData");var MapView=function(t){function e(){var e=t.call(this)||this;return e.markerLayer=new egret.DisplayObjectContainer,e.addChild(e.markerLayer),e.selfLayer=new egret.DisplayObjectContainer,e.addChild(e.selfLayer),e.itemList=[],e.itemDic={},e.otherDic={},e.companyDic={},e.virCompDic={},e.threeDic={},e}return __extends(e,t),e.prototype.refreshSelf=function(){this.self?this.self.refreshPos():(this.self=new SelfMarkerView,this.self.setData(),this.selfLayer.addChild(this.self))},e.prototype.refreshOther=function(t){if(t)for(var e=t.length,i=0;e>i;i++){var o=t[i];if(o){var a=this.findMarkerByID(o.id,this.otherDic);a?a.refreshPos():(a=new OtherMarkerView,a.setData(o),this.selfLayer.addChild(a),this.otherDic[o.id]=a)}}},e.prototype.refreshCompany=function(t){if(t)for(var e=t.length,i=0;e>i;i++){var o=t[i];if(o){var a=this.findMarkerByID(o.id,this.companyDic);a?a.refreshPos():(a=new MarkerItemView,a.setData(o),this.selfLayer.addChild(a),this.companyDic[o.id]=a)}}},e.prototype.refreshVIRComp=function(t){if(t)for(var e=t.length,i=0;e>i;i++){var o=t[i];if(o){var a=this.findMarkerByID(o.id,this.virCompDic);a?a.refreshPos():(a=new MarkerItemView,a.setData(o),this.selfLayer.addChild(a),this.virCompDic[o.id]=a)}}},e.prototype.refreshThree=function(t){if(t)for(var e=t.length,i=0;e>i;i++){var o=t[i];if(o){var a=this.findMarkerByID(o.id,this.threeDic);a?a.refreshPos():(a=new MarkerItemView,a.setData(o),this.selfLayer.addChild(a),this.threeDic[o.id]=a)}}},e.prototype.refreshMap=function(){this.self&&this.self.refreshPos();for(var t in this.otherDic){var e=this.otherDic[t];e&&e.refreshPos()}for(var t in this.companyDic){var e=this.companyDic[t];e&&e.refreshPos()}for(var t in this.virCompDic){var e=this.virCompDic[t];e&&e.refreshPos()}for(var t in this.threeDic){var e=this.threeDic[t];e&&e.refreshPos()}},e.prototype.findMarkerByID=function(t,e){for(var i in e)if(i==t)return e[i];return null},e.prototype.findMarker=function(t){for(var e=this.itemList.length,i=0;e>i;i++){var o=this.itemList[i];if(o&&o.data.id==t.id)return o}return null},e}(egret.DisplayObjectContainer);__reflect(MapView.prototype,"MapView");var CustomCheckBox=function(t){function e(e,i,o){void 0===o&&(o=0);var a=t.call(this)||this;return a.type=e,a.text=i,a.select=o,a.init(),a}return __extends(e,t),e.prototype.init=function(){console.log(),this.icon=Global.createBitmapByName("cbx_"+this.type+"_"+this.select+"_png"),this.addChild(this.icon),this.txtContent=new egret.TextField,this.txtContent.x=50,this.txtContent.text=this.text,this.addChild(this.txtContent),this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickHandler,this)},e.prototype.clickHandler=function(){this.change(),this.dispatchEventWith(egret.Event.CHANGE)},e.prototype.setSelect=function(t){this.select=t,this.icon.texture=RES.getRes("cbx_"+this.type+"_"+this.select+"_png")},e.prototype.change=function(){this.setSelect(0==this.select?1:0)},e}(egret.DisplayObjectContainer);__reflect(CustomCheckBox.prototype,"CustomCheckBox");var OtherMarkerView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.touchClickHandler=function(t){this.showMenu?MenuView.instance.showMenu(this):MenuView.instance.showMenu(this,MenuView.OTHER_MENU),this.showMenu=!this.showMenu},e}(SelfMarkerView);__reflect(OtherMarkerView.prototype,"OtherMarkerView");var LoadingUI=function(_super){function LoadingUI(){var t=_super.call(this)||this;return t.index=3,t.loadOk=!1,t.lastOk=!1,t.createView(),t}return __extends(LoadingUI,_super),LoadingUI.prototype.createView=function(){if(this.isload=window.sessionStorage.getItem("loading_load"),"1"==this.isload)this.lastOk=!0;else{var t=new CustomImage("resource/assets/loading/loading_bg.jpg",!0,function(){t.width=StageUtils.SW,t.height=StageUtils.SH});this.addChild(t);var e=new CustomImage("resource/assets/loading/loading_btn.png",!1,function(){e.x=StageUtils.SW-e.width-30,e.y=30});this.addChild(e),this.btnReturn=e,this.txtLasttime1=new egret.TextField,this.addChild(this.txtLasttime1),this.txtLasttime1.textColor=6710886,this.txtLasttime1.size=22,this.txtLasttime1.x=StageUtils.SW-100-30,this.txtLasttime1.y=37,this.txtLasttime1.width=100,this.txtLasttime1.textAlign="center",this.txtLasttime1.text="跳过 3S",this.txtLasttime=new egret.TextField,this.addChild(this.txtLasttime),this.txtLasttime.size=22,this.txtLasttime.x=StageUtils.SW-100-30,this.txtLasttime.y=37,this.txtLasttime.width=100,this.txtLasttime.textAlign="center",this.txtLasttime.text="跳过 3S",this.rectMask=new egret.Rectangle(0,0,100,50),this.rectMask.x=-100,this.txtLasttime.mask=this.rectMask,this.timer=new egret.Timer(1e3,3),this.timer.addEventListener(egret.TimerEvent.TIMER,this.timerHandler,this),this.timer.start()}},LoadingUI.prototype.timerHandler=function(){this.index--,this.index>0?(this.txtLasttime.text="跳过 "+this.index+"S",this.txtLasttime.mask=this.rectMask,this.txtLasttime1.text="跳过 "+this.index+"S"):(this.timer.stop(),this.timer.removeEventListener(egret.TimerEvent.TIMER,this.timerHandler,this),this.timer=null,this.txtLasttime.text="跳  过",this.txtLasttime.mask=this.rectMask,this.txtLasttime1.text="跳  过",this.lastOk=!0,this.checkInto())},LoadingUI.prototype.checkInto=function(){this.loadOk&&this.lastOk&&(this.btnReturn&&(Global.setBut(this.btnReturn),this.btnReturn.touchEnabled=!0,this.btnReturn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.returnClickHandler,this)),this.returnClickHandler())},LoadingUI.prototype.returnClickHandler=function(){UIManager.instance.mainUILayer.removeChild(this),Main.instance.initMap(),Main.instance.Gmap.centerAndZoom(eval("new BMap.Point(121.48789948999993, 31.249161578948787)"),17),Main.instance.getLoct()},LoadingUI.prototype.setProgress=function(t,e){if("1"!=this.isload){var i=Math.floor(t/e*100);StageUtils.SW-102-30;this.rectMask.x=-100+i,this.txtLasttime.mask=this.rectMask}},LoadingUI.prototype.loadComp=function(){window.sessionStorage.setItem("loading_load","1"),this.txtLasttime&&(this.txtLasttime.mask=null),this.rectMask=null,this.loadOk=!0,this.checkInto()},LoadingUI}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var MenuItemView=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_TAP,e.touchClickHandler,e),e}return __extends(e,t),e.prototype.touchClickHandler=function(t){this.data&&alert("menu_item_id:"+this.data.id)},e.prototype.setData=function(t){this.data=t,t&&(this.icon=Global.createBitmapByName("btn_func"+t.icon+"_png"),this.icon.x=-this.icon.width>>1,this.icon.y=-this.icon.height>>1,this.addChild(this.icon),this.x=t.x,this.y=t.y)},e}(egret.DisplayObjectContainer);__reflect(MenuItemView.prototype,"MenuItemView");var MenuView=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!0,configurable:!0}),e.prototype.showMenu=function(t,e){if(void 0===e&&(e=null),this.removeChildren(),e){for(var i=e.length,o=0;i>o;o++){var a=new MenuItemView;a.setData(e[o]),this.addChild(a),a.scaleX=a.scaleY=0,egret.Tween.get(a).wait(100*o).to({scaleX:1,scaleY:1},300)}t.addChild(this),StageUtils.stage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandler,this)}else StageUtils.stage.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandler,this),this.parent&&this.parent.removeChild(this)},e.prototype.touchHandler=function(t){this.showMenu(null)},e}(egret.DisplayObjectContainer);MenuView.SELF_MENU=[{id:1,icon:1,x:-57,y:21},{id:2,icon:1,x:-25,y:58},{id:3,icon:1,x:25,y:58},{id:4,icon:1,x:57,y:21}],MenuView.OTHER_MENU=[{id:1,icon:1,x:-25,y:58},{id:2,icon:1,x:25,y:58}],__reflect(MenuView.prototype,"MenuView");var MapManager=function(){function MapManager(){this.isFirst=!0,this.hb=0,this.kq=0,this.money=0,this.nl=0,this.egg=0,this.add_money=0,this.add_nl=0,this.add_egg=0,this.isLoadInfo=!0,setTimeout(function(){MapManager.instance.enterFrameHandler()},100),this.itemList=[],this.mapView=new MapView,UIManager.instance.mapLayer.addChild(this.mapView)}return Object.defineProperty(MapManager,"USER_INFO_API",{get:function(){return MapManager.ROOT+"info?"+Math.random()},enumerable:!0,configurable:!0}),Object.defineProperty(MapManager,"PLAY_API",{get:function(){return MapManager.ROOT+"play?"+Math.random()},enumerable:!0,configurable:!0}),MapManager.prototype.enterFrameHandler=function(){eval("$.scriptReady")?this.getLoct():setTimeout(function(){MapManager.instance.enterFrameHandler()},100)},MapManager.prototype.initMap=function(){this.Gmap=eval("new BMap.Map('GameMap',{enableHighResolution:true,enableMapClick:false});"),this.curMapLevel=17,this.Gmap.centerAndZoom(eval("new BMap.Point("+this.lng+", "+this.lat+")"),this.curMapLevel),this.Gmap.disableDragging(),this.Gmap.disableScrollWheelZoom(),this.Gmap.disableDoubleClickZoom(),this.Gmap.disableKeyboard(),this.Gmap.disableInertialDragging(),console.log("地图初始化完毕")},MapManager.prototype.getLoct=function(){console.log("getLoct");var geolocation=eval("new BMap.Geolocation();");geolocation.getCurrentPosition(function(r){geolocation.getStatus()==eval("BMAP_STATUS_SUCCESS")?(MapManager.instance.lng=r.point.lng,MapManager.instance.lat=r.point.lat,MapManager.instance.isFirst&&(MapManager.instance.isFirst=!1,MapManager.instance.initMap(),MapManager.instance.Gmap.centerAndZoom(eval("new BMap.Point("+MapManager.instance.lng+", "+MapManager.instance.lat+")"),17)),MapManager.instance.loadDate()):(alert("failed"+geolocation.getStatus()),MapManager.instance.loadDate())},{enableHighAccuracy:!0})},MapManager.prototype.share=function(){var wxObj=eval("wx");wxObj&&eval("$.wxIsReady")?(wxObj.onMenuShareTimeline({title:"欢迎进入码上星球，猎时祝您元宵快乐，财到福到",link:MapManager.instance.code,imgUrl:"http://res.leasiondata.cn/msxq/share.jpg",success:function(){},cancel:function(){}}),wxObj.onMenuShareAppMessage({title:"欢迎进入码上星球，猎时祝您元宵快乐，财到福到",desc:"点击进入",link:MapManager.instance.code,imgUrl:"http://res.leasiondata.cn/msxq/share.jpg",success:function(){},cancel:function(){}})):egret.setTimeout(this.share,this,500)},MapManager.prototype.loadDate=function(){this.mapView.refreshSelf(),MainView.instance.showShop(UserInfo.instance.shopList)},MapManager.prototype.refreshMap=function(){this.Gmap.centerAndZoom(eval("new BMap.Point("+this.serverLng+", "+this.serverLat+")"),this.curMapLevel),this.mapView.refreshMap()},Object.defineProperty(MapManager,"instance",{get:function(){return MapManager._instance||(MapManager._instance=new MapManager),MapManager._instance},enumerable:!0,configurable:!0}),MapManager}();MapManager.isShared=0,MapManager.USER_TICKET="03cb5224f3474f0eb7cfa64cfea4cf49",MapManager.PLAY_TICKET="",MapManager.ROOT="http://coeasion.cn/",MapManager.USER_OTHER_API=MapManager.ROOT+"GameDemo/aroundperson",MapManager.USER_COMPANY_API=MapManager.ROOT+"GameDemo/company",MapManager.USER_VIR_COMP_API=MapManager.ROOT+"GameDemo/virComp",MapManager.USER_THREE_API=MapManager.ROOT+"GameDemo/three",MapManager.AnswerList=[{title:"顶破天(打一字)",answer:"夫"},{title:"半耕半读(打一字)",answer:"讲"}],__reflect(MapManager.prototype,"MapManager");var PopManager=function(){function PopManager(){}return PopManager.showPop=function(pop,data){void 0===data&&(data=null);var view=PopManager.popDic[pop];view?view.setData(data):(view=eval("new "+pop+"()"),view&&view.setData(data),PopManager.popDic[pop]=view),view.show()},PopManager.hidePop=function(t){var e=PopManager.popDic[t];e?(e.hide(),delete PopManager.popDic[t]):console.log(t+":不存在")},PopManager}();PopManager.popDic={},__reflect(PopManager.prototype,"PopManager");var Main=function(_super){function Main(){var t=_super.call(this)||this;return t.lng=121.48789948999993,t.lat=31.249161578948787,t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t}return __extends(Main,_super),Object.defineProperty(Main,"instance",{get:function(){return Main._instance||(Main._instance=new Main),Main._instance},enumerable:!0,configurable:!0}),Main.prototype.onAddToStage=function(t){StageUtils.registStage(this.stage),this.addChild(UIManager.instance),$(".wx").click(function(){$(".wx").hide()}),this.loadingView=new LoadingUI,UIManager.instance.mainUILayer.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},Main.prototype.createGameScene=function(){if(this.getData()){var t=this.lng,e=this.lat,i={};i=t>0&&e>0?{type:"info",lng:t,lat:e,ticket:MapManager.USER_TICKET,isshared:MapManager.isShared}:{type:"info",ticket:MapManager.USER_TICKET,isshared:MapManager.isShared},$.ajax({url:MapManager.USER_INFO_API,data:i,success:function(t){if("success"==t.result){var e=t.prizes.length;if(0!=t.prizes.length){for(var i=0;e>i;i++)if("yanjishoukuai"==t.prizes[i].pooltype){var o=JSON.stringify(t.prizes[i]);sessionStorage.setItem("yanjishoukuai",o)}else if("hongbao"==t.prizes[i].pooltype){var o=JSON.stringify(t.prizes[i]);sessionStorage.setItem("hongbao",o)}console.log(o)}UserInfo.instance.fixed=0,UserInfo.instance.shopList=t.pools,egret.localStorage.setItem("activedate",t.activedate),UserInfo.instance.username=decodeURI(t.nickname);var a=t.headimgurl.substr(0,t.headimgurl.length-1);a+="132",UserInfo.instance.url=a,UIManager.instance.initMainView()}else Message.show(t.result)},error:function(){},timeout:8e3,dataType:"json",async:!0,type:"POST",complete:function(t,e){}})}},Main.prototype.getLoct=function(){this.lng=0,this.lat=0;var self=this;console.log("getLoct");var geolocation=eval("new BMap.Geolocation();");geolocation.getCurrentPosition(function(r){geolocation.getStatus()==eval("BMAP_STATUS_SUCCESS")?(self.lng=r.point.lng,self.lat=r.point.lat,self.createGameScene()):alert("failed"+geolocation.getStatus())},{enableHighAccuracy:!0})},Main.prototype.getData=function(){var t,e=window.location.href.split("#")[0].split("?")[1];return console.log("loadUser"),sessionStorage.setItem("kzw_href",window.location.href),Main.isTest?!0:e?(t=e.substring(0,32),MapManager.USER_TICKET=t,!0):!1},Main.prototype.initMap=function(){this.Gmap=eval("new BMap.Map('GameMap',{enableHighResolution:true,enableMapClick:false});"),this.curMapLevel=17,this.Gmap.centerAndZoom(eval("new BMap.Point("+this.lng+", "+this.lat+")"),this.curMapLevel),this.Gmap.disableDragging(),this.Gmap.disableScrollWheelZoom(),this.Gmap.disableDoubleClickZoom(),this.Gmap.disableKeyboard(),this.Gmap.disableInertialDragging(),console.log("地图初始化完毕")},Main.prototype.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("main")},Main.prototype.onResourceLoadComplete=function(t){"main"==t.groupName&&(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.loadingView.loadComp())},Main.prototype.onItemLoadError=function(t){Message.show("Url:"+t.resItem.url+" has failed to load")},Main.prototype.onResourceLoadError=function(t){Message.show("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},Main.prototype.onResourceProgress=function(t){"main"==t.groupName&&this.loadingView.setProgress(t.itemsLoaded,t.itemsTotal)},Main}(egret.DisplayObjectContainer);Main.isTest=!1,__reflect(Main.prototype,"Main");var ItemBox=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(t,e){void 0===e&&(e=1),this.type=t,this.dir=e,this.icon=Global.createBitmapByName("box_"+this.type+"_png"),this.addChild(this.icon),this.setRotate(this.dir)},e.prototype.changeDir=function(){this.dir++,this.dir>4&&(this.dir=1),this.setRotate(this.dir)},e.prototype.preDir=function(){var t=this.dir;return t++,t>4&&(t=1),this.preRotate(t)},e.prototype.refreshPos=function(t,e){this.px=t,this.py=e,this.x=TetrisGame.size*this.px,this.y=TetrisGame.size*this.py},e.prototype.preRotate=function(t){var e=this.type;return 1==e?[[0,0,0,0],[0,0,0,0],[0,1,1,0],[0,1,1,0]]:2==e?1==t||3==t?[[1,0,0,0],[1,0,0,0],[1,0,0,0],[1,0,0,0]]:[[1,1,1,1],[0,0,0,0],[0,0,0,0],[0,0,0,0]]:3==e?1==t?[[0,0,0,0],[0,0,0,0],[1,0,0,0],[1,1,1,0]]:2==t?[[0,0,0,0],[0,1,0,0],[0,1,0,0],[1,1,0,0]]:3==t?[[0,0,0,0],[0,0,0,0],[1,1,1,0],[0,0,1,0]]:[[0,0,0,0],[1,1,0,0],[1,0,0,0],[1,0,0,0]]:4==e?1==t?[[0,0,0,0],[0,1,0,0],[1,1,0,0],[0,1,0,0]]:2==t?[[0,0,0,0],[0,0,0,0],[1,1,1,0],[0,1,0,0]]:3==t?[[0,0,0,0],[0,1,0,0],[0,1,1,0],[0,1,0,0]]:[[0,0,0,0],[0,1,0,0],[1,1,1,0],[0,0,0,0]]:5==e?1==t||3==t?[[0,0,0,0],[0,0,0,0],[0,1,1,0],[1,1,0,0]]:[[0,0,0,0],[1,0,0,0],[1,1,0,0],[0,1,0,0]]:6==e?1==t||3==t?[[0,0,0,0],[0,1,0,0],[1,1,0,0],[1,0,0,0]]:[[0,0,0,0],[0,0,0,0],[1,1,0,0],[0,1,1,0]]:7==e?1==t?[[0,0,0,0],[0,0,0,0],[0,0,1,0],[1,1,1,0]]:2==t?[[0,0,0,0],[1,1,0,0],[0,1,0,0],[0,1,0,0]]:3==t?[[0,0,0,0],[0,0,0,0],[1,1,1,0],[1,0,0,0]]:[[0,0,0,0],[1,0,0,0],[1,0,0,0],[1,1,0,0]]:void 0},e.prototype.setRotate=function(t){var e=this.type;1==e?(this.list=[[0,0,0,0],[0,0,0,0],[0,1,2,0],[0,3,4,0]],this.icon.x=TetrisGame.size,this.icon.y=2*TetrisGame.size,this.icon.rotation=0):2==e?1==t||3==t?(this.list=[[1,0,0,0],[2,0,0,0],[3,0,0,0],[4,0,0,0]],this.icon.x=0,this.icon.y=0,this.icon.rotation=0):(this.list=[[1,2,3,4],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.icon.x=0,this.icon.y=TetrisGame.size,this.icon.rotation=-90):3==e?1==t?(this.list=[[0,0,0,0],[0,0,0,0],[1,0,0,0],[2,3,4,0]],this.icon.x=0,this.icon.y=2*TetrisGame.size,this.icon.rotation=0):2==t?(this.list=[[0,0,0,0],[0,4,0,0],[0,3,0,0],[1,2,0,0]],this.icon.x=0,this.icon.y=4*TetrisGame.size,this.icon.rotation=-90):3==t?(this.list=[[0,0,0,0],[0,0,0,0],[4,3,2,0],[0,0,1,0]],this.icon.x=3*TetrisGame.size,this.icon.y=4*TetrisGame.size,this.icon.rotation=-180):(this.list=[[0,0,0,0],[2,1,0,0],[3,0,0,0],[4,0,0,0]],this.icon.x=2*TetrisGame.size,this.icon.y=TetrisGame.size,this.icon.rotation=-270):4==e?1==t?(this.list=[[0,0,0,0],[0,1,0,0],[2,3,0,0],[0,4,0,0]],this.icon.x=0,this.icon.y=TetrisGame.size,this.icon.rotation=0):2==t?(this.list=[[0,0,0,0],[0,0,0,0],[1,3,4,0],[0,2,0,0]],this.icon.x=0,this.icon.y=4*TetrisGame.size,this.icon.rotation=-90):3==t?(this.list=[[0,0,0,0],[0,4,0,0],[0,3,2,0],[0,1,0,0]],this.icon.x=3*TetrisGame.size,this.icon.y=4*TetrisGame.size,this.icon.rotation=-180):(this.list=[[0,0,0,0],[0,2,0,0],[4,3,1,0],[0,0,0,0]],this.icon.x=3*TetrisGame.size,this.icon.y=TetrisGame.size,this.icon.rotation=-270):5==e?1==t||3==t?(this.list=[[0,0,0,0],[0,0,0,0],[0,1,2,0],[3,4,0,0]],this.icon.x=0,this.icon.y=2*TetrisGame.size,this.icon.rotation=0):(this.list=[[0,0,0,0],[2,0,0,0],[1,4,0,0],[0,3,0,0]],this.icon.x=0,this.icon.y=4*TetrisGame.size,this.icon.rotation=-90):6==e?1==t||3==t?(this.list=[[0,0,0,0],[0,1,0,0],[2,3,0,0],[4,0,0,0]],this.icon.x=0,this.icon.y=TetrisGame.size,this.icon.rotation=0):(this.list=[[0,0,0,0],[0,0,0,0],[4,2,0,0],[0,3,1,0]],this.icon.x=0,this.icon.y=4*TetrisGame.size,this.icon.rotation=-90):7==e&&(1==t?(this.list=[[0,0,0,0],[0,0,0,0],[0,0,1,0],[2,3,4,0]],this.icon.x=0,this.icon.y=2*TetrisGame.size,this.icon.rotation=0):2==t?(this.list=[[0,0,0,0],[1,4,0,0],[0,3,0,0],[0,2,0,0]],this.icon.x=0,this.icon.y=4*TetrisGame.size,this.icon.rotation=-90):3==t?(this.list=[[0,0,0,0],[0,0,0,0],[4,3,2,0],[1,0,0,0]],this.icon.x=3*TetrisGame.size,this.icon.y=4*TetrisGame.size,this.icon.rotation=-180):(this.list=[[0,0,0,0],[2,0,0,0],[3,0,0,0],[4,1,0,0]],this.icon.x=2*TetrisGame.size,this.icon.y=TetrisGame.size,this.icon.rotation=-270))},e.prototype.getButtomIndex=function(){for(var t=this.list.length,e=t-1;e>=0;e--)for(var i=this.list[e],o=i.length,a=0;o>a;a++)if(1==i[a])return console.log(this.py+e),this.py+e;return console.log(0),0},e}(egret.DisplayObjectContainer);__reflect(ItemBox.prototype,"ItemBox");var TetrisGame=function(t){function e(){var e=t.call(this)||this;return e.score=0,e.step=0,e.ok18=!1,e.ok19=!1,e.initLine(),e}return __extends(e,t),e.prototype.initLine=function(){var t=Global.createBitmapByName("kuang_png");t.width=e.maxW+8,t.height=e.maxH+8,t.x=(StageUtils.SW-t.width>>1)-4,t.y=(StageUtils.SH-t.height>>1)-4,this.addChild(t),e.initX=t.x+4,e.initY=t.y+4,this.boxContainer=new egret.DisplayObjectContainer,this.boxContainer.x=e.initX,this.boxContainer.y=e.initY,this.addChild(this.boxContainer);for(var i=0;20>i;i++){var o=new egret.Shape;o.graphics.lineStyle(2,16777215,.5),o.graphics.moveTo(0,i*e.size),o.graphics.lineTo(e.maxW,i*e.size),o.graphics.endFill(),this.boxContainer.addChild(o)}for(var i=0;10>i;i++){var o=new egret.Shape;o.graphics.lineStyle(2,16777215,.5),o.graphics.moveTo(i*e.size,0),o.graphics.lineTo(i*e.size,e.maxH),o.graphics.endFill(),this.boxContainer.addChild(o)}this.list=[];for(var i=0;20>i;i++){for(var a=[],n=0;10>n;n++)a[n]=0;this.list.push(a)}this.boxList={},this.txtScore=new egret.TextField,this.txtScore.textColor=0,this.txtScore.text="score:0",this.addChild(this.txtScore),this.txtStep=new egret.TextField,this.txtStep.textColor=16711935,this.txtStep.text="step:0",this.txtStep.y=50,this.addChild(this.txtStep),this.initEvent(),this.randomBox(),this.initData(),this.stepTimer=new egret.Timer(500),this.stepTimer.addEventListener(egret.TimerEvent.TIMER,this.stepTimerHandler,this),this.stepTimer.start()},e.prototype.initData=function(){for(var t=16;20>t;t++)for(var i=this.list[t],o=i.length,a=0;o>a;a++)if(i[a]=Math.floor(2*Math.random()),i[a]>0){var n=Math.ceil(7*Math.random()),s=Math.ceil(4*Math.random()),r=Global.createBitmapByName(n+"_"+s+"_png");r.x=a*e.size,r.y=t*e.size,this.boxContainer.addChild(r),this.boxList[t+"_"+a]=r}this.list[18][4]=1,this.list[18][5]=1,this.list[19][4]=1,this.list[19][5]=1;var h=this.boxList["18_4"];h?h.texture=RES.getRes("box_red_png"):(h=Global.createBitmapByName("box_red_png"),h.x=4*e.size,h.y=18*e.size,this.boxContainer.addChild(h),this.boxList["18_4"]=h);var h=this.boxList["18_5"];h?h.texture=RES.getRes("box_red_png"):(h=Global.createBitmapByName("box_red_png"),h.x=5*e.size,h.y=18*e.size,this.boxContainer.addChild(h),this.boxList["18_5"]=h);var h=this.boxList["19_4"];h?h.texture=RES.getRes("box_red_png"):(h=Global.createBitmapByName("box_red_png"),h.x=4*e.size,h.y=19*e.size,this.boxContainer.addChild(h),this.boxList["19_4"]=h);var h=this.boxList["19_5"];h?h.texture=RES.getRes("box_red_png"):(h=Global.createBitmapByName("box_red_png"),h.x=5*e.size,h.y=19*e.size,this.boxContainer.addChild(h),this.boxList["19_5"]=h)},e.prototype.stepTimerHandler=function(){this.downBox()},e.prototype.initEvent=function(){var t=Global.createBitmapByName("arrow_png");t.rotation=180,t.x=t.width,t.y=StageUtils.SH-1*t.height-50,this.addChild(t);var e=Global.createBitmapByName("arrow_png");e.x=StageUtils.SW-e.width,e.y=StageUtils.SH-2*e.height-50,this.addChild(e);var i=Global.createBitmapByName("arrow_png");i.rotation=270,i.x=0,i.y=StageUtils.SH-25,this.addChild(i);var o=Global.createBitmapByName("arrow_png");o.rotation=90,o.x=StageUtils.SW,o.y=StageUtils.SH-1*o.height-25,this.addChild(o),t.touchEnabled=!0,e.touchEnabled=!0,i.touchEnabled=!0,o.touchEnabled=!0,Global.setBut(t),Global.setBut(e),Global.setBut(i),Global.setBut(o),t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.leftHandler,this),e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.rightHandler,this),i.addEventListener(egret.TouchEvent.TOUCH_TAP,this.upHandler,this),o.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.downHandler,this),o.addEventListener(egret.TouchEvent.TOUCH_END,this.downEndHandler,this),o.addEventListener(egret.TouchEvent.TOUCH_CANCEL,this.downEndHandler,this),o.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.downEndHandler,this)},e.prototype.leftHandler=function(){this.select&&(this.select.px--,this.check(this.select,this.select.list)?this.select.refreshPos(this.select.px,this.select.py):this.select.px++)},e.prototype.rightHandler=function(){this.select&&(this.select.px++,this.check(this.select,this.select.list)?this.select.refreshPos(this.select.px,this.select.py):this.select.px--)},e.prototype.upHandler=function(){if(this.select){var t=this.select.preDir();this.check(this.select,t)&&this.select.changeDir()}},e.prototype.downHandler=function(){this.stepTimer.delay=50},e.prototype.downEndHandler=function(){this.stepTimer.delay=500},e.prototype.downBox=function(){this.select&&(this.select.py++,this.check(this.select,this.select.list)?this.select.refreshPos(this.select.px,this.select.py):(this.select.py--,this.updateList(this.select),this.boxContainer.removeChild(this.select),this.select=null,this.checkScore(),this.randomBox()))},e.prototype.checkScore=function(){for(var t=0,e=this.list.length,i=0;e>i;i++){for(var o=this.list[i],a=o.length,n=!0,s=0;a>s;s++)if(0==o[s]){n=!1;break}if(n){for(var s=0;a>s;s++){var r=this.boxList[i+"_"+s];r&&(this.boxContainer.removeChild(r),delete this.boxList[i+"_"+s])}this.listDownMove(i),t++,18==i?this.ok18=!0:19==i&&(this.ok19=!0),this.ok18&&this.ok19&&(this.stepTimer.stop(),alert("pass:"+this.step+"步,"+this.score+"分"))}}this.score+=1e3*t,this.txtScore.text="score:"+this.score},e.prototype.listDownMove=function(t){for(var i=(this.list.length,t);i>0;i--)for(var o=this.list[i],a=this.list[i-1],n=o.length,s=0;n>s;s++){var r=this.boxList[i-1+"_"+s];r&&(r.x=s*e.size+(r.width>>1),r.y=i*e.size+(r.height>>1)),o[s]=a[s],r?this.boxList[i+"_"+s]=r:delete this.boxList[i+"_"+s],delete this.boxList[i-1+"_"+s]}},e.prototype.check=function(t,i){if(t.getButtomIndex()>20)return!1;for(var o=i.length,a=0;o>a;a++)for(var n=i[a],s=n.length,r=0;s>r;r++)if(i[a][r]>0)try{if(t.py+a>=e.hNum)return!1;if(t.px+r<0||t.px+r>e.wNum-1)return!1;
if(this.list[t.py+a][t.px+r]>0)return!1}catch(h){console.log("sdf")}return!0},e.prototype.randomBox=function(){var t=Math.ceil(7*Math.random()),e=new ItemBox;e.init(t,1),e.refreshPos(3,0),this.boxContainer.addChild(e),this.check(e,e.list)?this.select=e:(alert("over:"+this.step+"步,"+this.score+"分"),this.stepTimer.stop()),this.step++,this.txtStep.text="step:"+this.step},e.prototype.updateList=function(t){for(var i=t.list,o=i.length,a=0;o>a;a++)for(var n=i[a],s=n.length,r=0;s>r;r++){var h=n[r];if(h){this.list[t.py+a][t.px+r]=h;var l=Global.createBitmapByName(t.type+"_"+h+"_png");l.anchorOffsetX=l.width>>1,l.anchorOffsetY=l.height>>1,l.x=(t.px+r)*e.size+(l.width>>1),l.y=(t.py+a)*e.size+(l.height>>1),l.rotation=t.icon.rotation,this.boxContainer.addChild(l),this.boxList[t.py+a+"_"+(t.px+r)]=l}}},e}(egret.DisplayObjectContainer);TetrisGame.maxW=500,TetrisGame.maxH=1e3,TetrisGame.wNum=10,TetrisGame.hNum=20,TetrisGame.size=50,__reflect(TetrisGame.prototype,"TetrisGame");var UIManager=function(t){function e(){var e=t.call(this)||this;return e.initLayer(),e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!0,configurable:!0}),e.prototype.initLayer=function(){this.mapLayer=new egret.DisplayObjectContainer,this.addChild(this.mapLayer),this.mainUILayer=new egret.DisplayObjectContainer,this.addChild(this.mainUILayer),this.popLayer=new egret.DisplayObjectContainer,this.addChild(this.popLayer),this.topLayer=new egret.DisplayObjectContainer,this.addChild(this.topLayer)},e.prototype.initMainView=function(){MapManager.instance,this.mainUILayer.addChild(new MainView),this.isTips=window.sessionStorage.getItem("tips_load"),"1"!=this.isTips&&"0"==UserInfo.instance.fixed&&(PopManager.showPop("TipsPop",3),window.sessionStorage.setItem("tips_load","1"))},e}(egret.DisplayObjectContainer);__reflect(UIManager.prototype,"UIManager");var UserInfo=function(){function t(){}return Object.defineProperty(t,"instance",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),t}();__reflect(UserInfo.prototype,"UserInfo");var CustomTabbar=function(t){function e(e,i,o){for(var a=t.call(this)||this,n=0;e>n;n++){var s=Global.createBitmapByName("tabbar_"+(n+1)+"_2_png");s.x=295,s.y=115,a.addChild(s)}return a}return __extends(e,t),e}(egret.DisplayObjectContainer);__reflect(CustomTabbar.prototype,"CustomTabbar");var CustomImage=function(t){function e(e,i,o){void 0===i&&(i=!0),void 0===o&&(o=null);var a=t.call(this)||this;return a.url=e,a.isEase=i,a.compFunc=o,a.loadBg(),a}return __extends(e,t),e.prototype.loadBg=function(){RES.getResByUrl(this.url,this.onLoadComplete,this,RES.ResourceItem.TYPE_IMAGE)},e.prototype.onLoadComplete=function(t){this.texture=t,this.isEase&&(this.alpha=0,egret.Tween.get(this).to({alpha:1},1e3)),this.compFunc&&this.compFunc()},e}(egret.Bitmap);__reflect(CustomImage.prototype,"CustomImage");var egret;!function(t){var e=function(e){function i(i){void 0===i&&(i=null);var o=e.call(this)||this;return o.scrollBeginThreshold=10,o.scrollSpeed=1,o._content=null,o.delayTouchBeginEvent=null,o.touchBeginTimer=null,o.touchEnabled=!0,o._ScrV_Props_=new t.ScrollViewProperties,i&&o.setContent(i),o}return __extends(i,e),Object.defineProperty(i.prototype,"bounces",{get:function(){return this._ScrV_Props_._bounces},set:function(t){this._ScrV_Props_._bounces=!!t},enumerable:!0,configurable:!0}),i.prototype.setContent=function(t){this._content!==t&&(this.removeContent(),t&&(this._content=t,e.prototype.addChild.call(this,t),this._addEvents()))},i.prototype.removeContent=function(){this._content&&(this._removeEvents(),e.prototype.removeChildAt.call(this,0)),this._content=null},Object.defineProperty(i.prototype,"verticalScrollPolicy",{get:function(){return this._ScrV_Props_._verticalScrollPolicy},set:function(t){t!=this._ScrV_Props_._verticalScrollPolicy&&(this._ScrV_Props_._verticalScrollPolicy=t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"horizontalScrollPolicy",{get:function(){return this._ScrV_Props_._horizontalScrollPolicy},set:function(t){t!=this._ScrV_Props_._horizontalScrollPolicy&&(this._ScrV_Props_._horizontalScrollPolicy=t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"scrollLeft",{get:function(){return this._ScrV_Props_._scrollLeft},set:function(t){t!=this._ScrV_Props_._scrollLeft&&(this._ScrV_Props_._scrollLeft=t,this._validatePosition(!1,!0),this._updateContentPosition())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"scrollTop",{get:function(){return this._ScrV_Props_._scrollTop},set:function(t){t!=this._ScrV_Props_._scrollTop&&(this._ScrV_Props_._scrollTop=t,this._validatePosition(!0,!1),this._updateContentPosition())},enumerable:!0,configurable:!0}),i.prototype.setScrollPosition=function(t,e,i){if(void 0===i&&(i=!1),(!i||0!=t||0!=e)&&(i||this._ScrV_Props_._scrollTop!=t||this._ScrV_Props_._scrollLeft!=e)){var o=this._ScrV_Props_._scrollTop,a=this._ScrV_Props_._scrollLeft;if(i){var n=this.getMaxScrollLeft(),s=this.getMaxScrollTop();(0>=o||o>=s)&&(t/=2),(0>=a||a>=n)&&(e/=2);var r=o+t,h=a+e,l=this._ScrV_Props_._bounces;l||((0>=r||r>=s)&&(r=Math.max(0,Math.min(r,s))),(0>=h||h>=n)&&(h=Math.max(0,Math.min(h,n)))),this._ScrV_Props_._scrollTop=r,this._ScrV_Props_._scrollLeft=h}else this._ScrV_Props_._scrollTop=t,this._ScrV_Props_._scrollLeft=e;this._validatePosition(!0,!0),this._updateContentPosition()}},i.prototype._validatePosition=function(t,e){if(void 0===t&&(t=!1),void 0===e&&(e=!1),t){var i=this.height,o=this._getContentHeight();this._ScrV_Props_._scrollTop=Math.max(this._ScrV_Props_._scrollTop,(0-i)/2),this._ScrV_Props_._scrollTop=Math.min(this._ScrV_Props_._scrollTop,o>i?o-i/2:i/2)}if(e){var a=this.width,n=this._getContentWidth();this._ScrV_Props_._scrollLeft=Math.max(this._ScrV_Props_._scrollLeft,(0-a)/2),this._ScrV_Props_._scrollLeft=Math.min(this._ScrV_Props_._scrollLeft,n>a?n-a/2:a/2)}},i.prototype.$setWidth=function(t){if(this.$getExplicitWidth()==t)return!1;var i=e.prototype.$setWidth.call(this,t);return this._updateContentPosition(),i},i.prototype.$setHeight=function(t){if(this.$getExplicitHeight()==t)return!1;e.prototype.$setHeight.call(this,t);return this._updateContentPosition(),!0},i.prototype._updateContentPosition=function(){var e=this.height,i=this.width;this.scrollRect=new t.Rectangle(Math.round(this._ScrV_Props_._scrollLeft),Math.round(this._ScrV_Props_._scrollTop),i,e),this.dispatchEvent(new t.Event(t.Event.CHANGE))},i.prototype._checkScrollPolicy=function(){var t=this._ScrV_Props_._horizontalScrollPolicy,e=this.__checkScrollPolicy(t,this._getContentWidth(),this.width);this._ScrV_Props_._hCanScroll=e;var i=this._ScrV_Props_._verticalScrollPolicy,o=this.__checkScrollPolicy(i,this._getContentHeight(),this.height);return this._ScrV_Props_._vCanScroll=o,e||o},i.prototype.__checkScrollPolicy=function(t,e,i){return"on"==t?!0:"off"==t?!1:e>i},i.prototype._addEvents=function(){this.addEventListener(t.TouchEvent.TOUCH_BEGIN,this._onTouchBegin,this),this.addEventListener(t.TouchEvent.TOUCH_BEGIN,this._onTouchBeginCapture,this,!0),this.addEventListener(t.TouchEvent.TOUCH_END,this._onTouchEndCapture,this,!0)},i.prototype._removeEvents=function(){this.removeEventListener(t.TouchEvent.TOUCH_BEGIN,this._onTouchBegin,this),this.removeEventListener(t.TouchEvent.TOUCH_BEGIN,this._onTouchBeginCapture,this,!0),this.removeEventListener(t.TouchEvent.TOUCH_END,this._onTouchEndCapture,this,!0)},i.prototype._onTouchBegin=function(e){if(!e.$isDefaultPrevented){var i=this._checkScrollPolicy();i&&(this._ScrV_Props_._touchStartPosition.x=e.stageX,this._ScrV_Props_._touchStartPosition.y=e.stageY,(this._ScrV_Props_._isHTweenPlaying||this._ScrV_Props_._isVTweenPlaying)&&this._onScrollFinished(),this._tempStage=this.stage,this._tempStage.addEventListener(t.TouchEvent.TOUCH_MOVE,this._onTouchMove,this),this._tempStage.addEventListener(t.TouchEvent.TOUCH_END,this._onTouchEnd,this),this._tempStage.addEventListener(t.TouchEvent.LEAVE_STAGE,this._onTouchEnd,this),this.addEventListener(t.Event.ENTER_FRAME,this._onEnterFrame,this),this._logTouchEvent(e),e.preventDefault())}},i.prototype._onTouchBeginCapture=function(e){var i=this._checkScrollPolicy();if(i){for(var o=e.target;o!=this;){if("_checkScrollPolicy"in o&&(i=o._checkScrollPolicy()))return;o=o.parent}e.stopPropagation();var a=this.cloneTouchEvent(e);this.delayTouchBeginEvent=a,this.touchBeginTimer||(this.touchBeginTimer=new t.Timer(100,1),this.touchBeginTimer.addEventListener(t.TimerEvent.TIMER_COMPLETE,this._onTouchBeginTimer,this)),this.touchBeginTimer.start(),this._onTouchBegin(e)}},i.prototype._onTouchEndCapture=function(e){var i=this;if(this.delayTouchBeginEvent){this._onTouchBeginTimer(),e.stopPropagation();var o=this.cloneTouchEvent(e);t.callLater(function(){i.stage&&i.dispatchPropagationEvent(o)},this)}},i.prototype._onTouchBeginTimer=function(){this.touchBeginTimer.stop();var t=this.delayTouchBeginEvent;this.delayTouchBeginEvent=null,this.stage&&this.dispatchPropagationEvent(t)},i.prototype.dispatchPropagationEvent=function(e){for(var i=e.$target,o=this.$getPropagationList(i),a=o.length,n=.5*o.length,s=-1,r=0;a>r;r++)if(o[r]===this._content){s=r;break}o.splice(0,s+1),n-=s+1,this.$dispatchPropagationEvent(e,o,n),t.Event.release(e)},i.prototype._onTouchMove=function(t){if(this._ScrV_Props_._lastTouchPosition.x!=t.stageX||this._ScrV_Props_._lastTouchPosition.y!=t.stageY){if(!this._ScrV_Props_._scrollStarted){var e=t.stageX-this._ScrV_Props_._touchStartPosition.x,i=t.stageY-this._ScrV_Props_._touchStartPosition.y,o=Math.sqrt(e*e+i*i);if(o<this.scrollBeginThreshold)return void this._logTouchEvent(t)}this._ScrV_Props_._scrollStarted=!0,this.delayTouchBeginEvent&&(this.delayTouchBeginEvent=null,this.touchBeginTimer.stop()),this.touchChildren=!1;var a=this._getPointChange(t);this.setScrollPosition(a.y,a.x,!0),this._calcVelocitys(t),this._logTouchEvent(t)}},i.prototype._onTouchEnd=function(e){this.touchChildren=!0,this._ScrV_Props_._scrollStarted=!1,this._tempStage.removeEventListener(t.TouchEvent.TOUCH_MOVE,this._onTouchMove,this),this._tempStage.removeEventListener(t.TouchEvent.TOUCH_END,this._onTouchEnd,this),this._tempStage.removeEventListener(t.TouchEvent.LEAVE_STAGE,this._onTouchEnd,this),this.removeEventListener(t.Event.ENTER_FRAME,this._onEnterFrame,this),this._moveAfterTouchEnd()},i.prototype._onEnterFrame=function(e){var i=t.getTimer();i-this._ScrV_Props_._lastTouchTime>100&&i-this._ScrV_Props_._lastTouchTime<300&&this._calcVelocitys(this._ScrV_Props_._lastTouchEvent)},i.prototype._logTouchEvent=function(e){this._ScrV_Props_._lastTouchPosition.x=e.stageX,this._ScrV_Props_._lastTouchPosition.y=e.stageY,this._ScrV_Props_._lastTouchEvent=this.cloneTouchEvent(e),this._ScrV_Props_._lastTouchTime=t.getTimer()},i.prototype._getPointChange=function(t){return{x:this._ScrV_Props_._hCanScroll===!1?0:this._ScrV_Props_._lastTouchPosition.x-t.stageX,y:this._ScrV_Props_._vCanScroll===!1?0:this._ScrV_Props_._lastTouchPosition.y-t.stageY}},i.prototype._calcVelocitys=function(e){var i=t.getTimer();if(0==this._ScrV_Props_._lastTouchTime)return void(this._ScrV_Props_._lastTouchTime=i);var o=this._getPointChange(e),a=i-this._ScrV_Props_._lastTouchTime;o.x/=a,o.y/=a,this._ScrV_Props_._velocitys.push(o),this._ScrV_Props_._velocitys.length>5&&this._ScrV_Props_._velocitys.shift(),this._ScrV_Props_._lastTouchPosition.x=e.stageX,this._ScrV_Props_._lastTouchPosition.y=e.stageY},i.prototype._getContentWidth=function(){return this._content.$getExplicitWidth()||this._content.width},i.prototype._getContentHeight=function(){return this._content.$getExplicitHeight()||this._content.height},i.prototype.getMaxScrollLeft=function(){var t=this._getContentWidth()-this.width;return Math.max(0,t)},i.prototype.getMaxScrollTop=function(){var t=this._getContentHeight()-this.height;return Math.max(0,t)},i.prototype._moveAfterTouchEnd=function(){if(0!=this._ScrV_Props_._velocitys.length){for(var t={x:0,y:0},e=0,o=0;o<this._ScrV_Props_._velocitys.length;o++){var a=this._ScrV_Props_._velocitys[o],n=i.weight[o];t.x+=a.x*n,t.y+=a.y*n,e+=n}this._ScrV_Props_._velocitys.length=0,this.scrollSpeed<=0&&(this.scrollSpeed=1);var s=t.x/e*this.scrollSpeed,r=t.y/e*this.scrollSpeed,h=Math.abs(s),l=Math.abs(r),c=this.getMaxScrollLeft(),p=this.getMaxScrollTop(),d=h>.02?this.getAnimationDatas(s,this._ScrV_Props_._scrollLeft,c):{position:this._ScrV_Props_._scrollLeft,duration:1},u=l>.02?this.getAnimationDatas(r,this._ScrV_Props_._scrollTop,p):{position:this._ScrV_Props_._scrollTop,duration:1};this.setScrollLeft(d.position,d.duration),this.setScrollTop(u.position,u.duration)}},i.prototype.onTweenFinished=function(t){t==this._ScrV_Props_._vScrollTween&&(this._ScrV_Props_._isVTweenPlaying=!1),t==this._ScrV_Props_._hScrollTween&&(this._ScrV_Props_._isHTweenPlaying=!1),0==this._ScrV_Props_._isHTweenPlaying&&0==this._ScrV_Props_._isVTweenPlaying&&this._onScrollFinished()},i.prototype._onScrollStarted=function(){},i.prototype._onScrollFinished=function(){t.ScrollTween.removeTweens(this),this._ScrV_Props_._hScrollTween=null,this._ScrV_Props_._vScrollTween=null,this._ScrV_Props_._isHTweenPlaying=!1,this._ScrV_Props_._isVTweenPlaying=!1,this.dispatchEvent(new t.Event(t.Event.COMPLETE))},i.prototype.setScrollTop=function(e,i){void 0===i&&(i=0);var o=Math.min(this.getMaxScrollTop(),Math.max(e,0));if(0==i)return void(this.scrollTop=o);0==this._ScrV_Props_._bounces&&(e=o);var a=t.ScrollTween.get(this).to({scrollTop:e},i,t.ScrollEase.quartOut);o!=e&&a.to({scrollTop:o},300,t.ScrollEase.quintOut),this._ScrV_Props_._isVTweenPlaying=!0,this._ScrV_Props_._vScrollTween=a,a.call(this.onTweenFinished,this,[a]),this._ScrV_Props_._isHTweenPlaying||this._onScrollStarted()},i.prototype.setScrollLeft=function(e,i){void 0===i&&(i=0);var o=Math.min(this.getMaxScrollLeft(),Math.max(e,0));if(0==i)return void(this.scrollLeft=o);0==this._ScrV_Props_._bounces&&(e=o);var a=t.ScrollTween.get(this).to({scrollLeft:e},i,t.ScrollEase.quartOut);o!=e&&a.to({scrollLeft:o},300,t.ScrollEase.quintOut),this._ScrV_Props_._isHTweenPlaying=!0,this._ScrV_Props_._hScrollTween=a,a.call(this.onTweenFinished,this,[a]),this._ScrV_Props_._isVTweenPlaying||this._onScrollStarted()},i.prototype.getAnimationDatas=function(t,e,i){var o=Math.abs(t),a=.95,n=0,s=.998,r=.02,h=e+500*t;if(0>h||h>i)for(h=e;Math.abs(t)!=1/0&&Math.abs(t)>r;)h+=t,t*=0>h||h>i?s*a:s,n++;else n=500*-Math.log(r/o);var l={position:Math.min(i+50,Math.max(h,-50)),duration:n};return l},i.prototype.cloneTouchEvent=function(e){var i=new t.TouchEvent(e.type,e.bubbles,e.cancelable);return i.touchPointID=e.touchPointID,i.$stageX=e.stageX,i.$stageY=e.stageY,i.touchDown=e.touchDown,i.$isDefaultPrevented=!1,i.$target=e.target,i},i.prototype.throwNotSupportedError=function(){t.$error(1023)},i.prototype.addChild=function(t){return this.throwNotSupportedError(),null},i.prototype.addChildAt=function(t,e){return this.throwNotSupportedError(),null},i.prototype.removeChild=function(t){return this.throwNotSupportedError(),null},i.prototype.removeChildAt=function(t){return this.throwNotSupportedError(),null},i.prototype.setChildIndex=function(t,e){this.throwNotSupportedError()},i.prototype.swapChildren=function(t,e){this.throwNotSupportedError()},i.prototype.swapChildrenAt=function(t,e){this.throwNotSupportedError()},i}(t.DisplayObjectContainer);e.weight=[1,1.33,1.66,2,2.33],t.CustomScrollView=e,__reflect(e.prototype,"egret.CustomScrollView")}(egret||(egret={}));var ErrorCode=function(){function t(){}return t}();ErrorCode.TIME_OUT=999,ErrorCode.NOT_FOUND=404,ErrorCode.SYSTEM_ERROR=100,ErrorCode.TICKET_TIME_OUT=1,ErrorCode.RECEIVED_SELF=2,ErrorCode.RECEIVED_OTHER=3,ErrorCode.RECEIVED_ERROR=4,__reflect(ErrorCode.prototype,"ErrorCode");var GameDispatcher=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!0,configurable:!0}),e}(egret.EventDispatcher);__reflect(GameDispatcher.prototype,"GameDispatcher");var Global=function(){function t(){}return t.createBitmapByRes=function(t,e){var i=new egret.Bitmap,o=RES.getRes(t);return console.log("name::"+e+"::"+t),i.texture=o.getTexture(e),i},t.createBitmapByName=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0);var o=new egret.Bitmap,a=RES.getRes(t);return o.texture=a,o.x=e,o.y=i,o},t.fadeIn=function(e,i,o,a){void 0===i&&(i=0),void 0===o&&(o=500),void 0===a&&(a=1),t.tweenFrom(e,i,o,0,0,a,egret.Ease.cubicOut)},t.fadeOut=function(e,i,o,a){void 0===i&&(i=0),void 0===o&&(o=500),void 0===a&&(a=1),t.tweenToHide(e,i,o,0,0,a,egret.Ease.cubicOut)},t.zoomIn=function(e,i,o,a){void 0===i&&(i=0),void 0===o&&(o=500),void 0===a&&(a=.6),t.tweenFrom(e,i,o,0,0,a,egret.Ease.backOut)},t.zoomOut=function(e,i,o,a){void 0===i&&(i=0),void 0===o&&(o=500),void 0===a&&(a=1.5),t.tweenToHide(e,i,o,0,0,a,egret.Ease.cubicIn)},t.tweenToHide=function(t,e,i,o,a,n,s,r){void 0===r&&(r=0);var h=egret.Tween.get(t),l=t.x,c=t.y;l+=o,c+=a,h.wait(e),h.to({alpha:r,scaleX:n,scaleY:n,x:l,y:c},i,s),h.call(function(){t.parent&&t.parent.removeChild(t)})},t.tweenTo=function(t,e,i,o,a,n,s,r){void 0===n&&(n=1),void 0===s&&(s=1),void 0===r&&(r=egret.Ease.cubicOut);var h=egret.Tween.get(t);h.wait(e),r?h.to({alpha:n,scaleX:s,scaleY:s,x:o,y:a},i,r):h.to({alpha:n,scaleX:s,scaleY:s,x:o,y:a},i)},t.tweenFrom=function(t,e,i,o,a,n,s){var r=egret.Tween.get(t),h=t.x,l=t.y;t.scaleX=t.scaleY=n,t.x=h+o,t.y=l+a,r.wait(e),r.to({alpha:1,scaleX:1,scaleY:1,x:h,y:l},i,s)},t.createMc=function(t,e,i){var o=RES.getRes(t),a=RES.getRes(e),n=new egret.MovieClipDataFactory(o,a),s=new egret.MovieClip(n.generateMovieClipData(i));return s},t.remove=function(t){t&&t.parent&&t.parent.removeChild(t)},t.setBut=function(t){t&&(t.touchEnabled=!0,t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){t.alpha=.68},t),t.addEventListener(egret.TouchEvent.TOUCH_END,function(){t.alpha=1},t),t.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,function(){t.alpha=1},t))},t.getArrayItems=function(t,e){var i=new Array;for(var o in t)i.push(t[o]);for(var a=new Array,n=0;e>n&&i.length>0;n++){var s=Math.floor(Math.random()*i.length);a[n]=i[s],i.splice(s,1)}return a},t.errorTips=function(t){t&&("invalidticket"==t.reason?PopManager.showPop("ErrorPop",ErrorCode.TICKET_TIME_OUT):"invalidticketparam"==t.reason?PopManager.showPop("ErrorPop",ErrorCode.NOT_FOUND):PopManager.showPop("ErrorPop",ErrorCode.SYSTEM_ERROR))},t.showTips=function(t){Message.show(t)},t}();Global.grayMatrix=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0],Global.grayFlilter=[new egret.ColorMatrixFilter(Global.grayMatrix)],Global.grayFlilter1=[new egret.ColorMatrixFilter([.3,.6,0,0,200,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0])],__reflect(Global.prototype,"Global");var Message=function(t){function e(){var e=t.call(this)||this;return e.bg=Global.createBitmapByName("message_bg_png"),e.bg.y=-10,e.addChild(e.bg),e.txtStr=new egret.TextField,e.txtStr.width=StageUtils.SW,e.txtStr.textAlign=egret.HorizontalAlign.CENTER,e.addChild(e.txtStr),e}return __extends(e,t),e.prototype.show=function(t){this.txtStr.text=t,this.bg.width=this.txtStr.textWidth+50,this.bg.height=this.txtStr.textHeight+20,this.bg.x=StageUtils.SW-this.bg.width>>1,this.y=StageUtils.SH>>1,this.alpha=1,egret.Tween.get(this).wait(1e3).to({y:this.y-100,alpha:0},1e3,egret.Ease.quadIn).call(this.tweenEnd,this)},e.prototype.tweenEnd=function(){this.parent&&(this.parent.removeChild(this),e.pool.push(this))},e.show=function(t){var i;i=e.pool.length>0?e.pool.pop():new e,i&&(i.show(t),UIManager.instance.popLayer.addChild(i))},e}(egret.DisplayObjectContainer);Message.pool=[],__reflect(Message.prototype,"Message");var StageUtils=function(){function t(){}return t.registStage=function(e){t.stage=e,t.SW=e.stageWidth,t.SH=e.stageHeight,t.CW=t.SW>>1,t.CH=t.SH>>1,t.LW=window.innerWidth,t.LH=window.innerHeight},t.centerInParentX=function(e,i){void 0===i&&(i=null),e&&(i?e.x=i.width-e.width>>1:e.x=t.stage.stageWidth-e.width>>1)},t.centerInParentY=function(e,i){void 0===i&&(i=null),e&&(i?e.y=i.height-e.height>>1:e.y=t.stage.stageHeight-e.height>>1)},t.centerInParent=function(e,i,o,a){void 0===i&&(i=0),void 0===o&&(o=0),void 0===a&&(a=null),e&&(a?(e.x=(a.width-e.width>>1)+i,e.y=(a.height-e.height>>1)+o):(e.x=(t.stage.stageWidth-e.width>>1)+i,e.y=(t.stage.stageHeight-e.height>>1)+o))},t}();__reflect(StageUtils.prototype,"StageUtils");var AnswerPop=function(t){function e(){var e=t.call(this)||this;return e.answerList=[{ok:3,list:["秦国","赵国","魏国","楚国"]},{ok:3,list:["吃粽子","赛龙舟","饮雄黄酒","登高采菊"]}],e.result=-1,e}return __extends(e,t),e.prototype.setData=function(t){void 0===t&&(t=null),this.data=t,this.index=Math.floor(2*Math.random()),console.log(this.index),this.curObj=this.answerList[this.index];var e=new CustomImage("resource/assets/asyn/answer_bg.png",!0,function(){e.x=StageUtils.SW-e.width>>1,e.y=StageUtils.SH-e.height>>1});this.addChild(e);var i=new CustomImage("resource/assets/asyn/answer"+(this.index+1)+"_bg.png",!0,function(){i.x=StageUtils.SW-i.width>>1,i.y=400-i.height});this.addChild(i);var o=Global.createBitmapByName("answer_"+(this.index+1)+"_png");o.x=StageUtils.SW-o.width>>1,o.y=400,this.addChild(o);for(var a=this.curObj.list,n=a.length,s=0;n>s;s++){var r=new CustomCheckBox(1,a[s]);r.index=s,r.x=150,r.y=470+60*s,this.addChild(r),r.addEventListener(egret.Event.CHANGE,this.cbxChangeHandler,this)}var h=Global.createBitmapByName("btn_submit_png");h.x=StageUtils.SW-h.width>>1,h.y=StageUtils.SH-300,this.addChild(h),h.touchEnabled=!0,Global.setBut(h),h.addEventListener(egret.TouchEvent.TOUCH_TAP,this.submitClickHandler,this);var l=Global.createBitmapByName("close_png");l.x=StageUtils.SW-l.width-90,l.y=185,this.addChild(l),l.touchEnabled=!0,Global.setBut(l),l.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeClickHandler,this),MainView.instance.people.visible=!1},e.prototype.closeClickHandler=function(){MainView.instance.people.visible=!0,PopManager.hidePop("AnswerPop")},e.prototype.cbxChangeHandler=function(t){var e=t.target;this.result=e.index,this.select&&this.select.change(),this.select=e},e.prototype.submitClickHandler=function(){-1!=this.result&&this.curObj&&(this.result==this.curObj.ok?PopManager.showPop("ResultPop",1):PopManager.showPop("ResultPop",0),PopManager.hidePop("AnswerPop"),MainView.instance.removeZongZi())},e}(PopView);__reflect(AnswerPop.prototype,"AnswerPop");var ShopItemView=function(t){function e(e){var i=t.call(this)||this;return i.obj=e,i.status=e.ticket,i.type=e.type,"weidian"==i.type?i.id=3:"hongbao"==i.type&&(i.id=2),i.init(),console.log("id:"+i.id),i}return __extends(e,t),e.prototype.init=function(){this.icon=Global.createBitmapByName("icon"+this.id+"_png"),this.icon.x=-this.icon.width>>1,this.icon.y=-this.icon.height,this.status||(this.icon.filters=Global.grayFlilter),this.addChild(this.icon)},e}(egret.DisplayObjectContainer);__reflect(ShopItemView.prototype,"ShopItemView");var MainView=function(_super){function MainView(){var t=_super.call(this)||this;return t.posX=[280,530,130,150,520],t.posY=[800,300,750,500,670],t.shopList={},t.isShowGlow=!1,t.filterList={},t.index=0,MainView.instance=t,t.initView(),t}return __extends(MainView,_super),MainView.prototype.loadHead=function(){var t=new CustomImage(UserInfo.instance.url,!0,function(){t.width=100,t.height=100});t.x=22,t.y=12,this.addChild(t);var e=new egret.Shape;e.graphics.beginFill(0),e.graphics.drawCircle(t.x+50,t.y+50,50),e.graphics.drawCircle,e.graphics.endFill(),this.addChild(e),t.mask=e},MainView.prototype.headClickHandler=function(){PopManager.showPop("UserPop",1)},MainView.prototype.initFlash=function(){var t=Global.createBitmapByName("dai1_png");UIManager.instance.topLayer.addChild(t),t.x=700,t.y=100,t.anchorOffsetX=23,t.anchorOffsetY=9,egret.Tween.get(t,{loop:!1}).to({skewX:180,x:300,y:200},1e3).to({skewX:360,x:-130,y:300},1e3).wait(1e3);var e=Global.createBitmapByName("dai2_png");UIManager.instance.topLayer.addChild(e),e.x=700,e.y=150,e.anchorOffsetX=23,e.anchorOffsetY=9,egret.Tween.get(e,{loop:!1}).wait(500).to({skewX:180,x:300,y:250},1e3).to({skewX:360,x:-100,y:350},1e3).wait(1400);var i=Global.createBitmapByName("dai3_png");UIManager.instance.topLayer.addChild(i),i.x=700,i.y=200,i.anchorOffsetX=23,i.anchorOffsetY=9,egret.Tween.get(i,{loop:!1}).wait(1e3).to({skewX:180,x:300,y:200},1e3).to({skewX:360,x:-100,y:200},1e3).wait(1500);var o=Global.createBitmapByName("dai4_png");UIManager.instance.topLayer.addChild(o),o.x=700,o.y=100,o.anchorOffsetX=23,o.anchorOffsetY=9,egret.Tween.get(o,{loop:!1}).wait(1500).to({skewX:180,x:300,y:150},1e3).to({skewX:360,x:-100,y:300},1e3).wait(2500);var a=Global.createBitmapByName("dai5_png");UIManager.instance.topLayer.addChild(a),a.x=700,a.y=300,a.anchorOffsetX=23,a.anchorOffsetY=9,egret.Tween.get(a,{loop:!1}).wait(2e3).to({skewX:180,x:300,y:350},1e3).to({skewX:360,x:-100,y:400},1e3).wait(3e3);var n=Global.createBitmapByName("dai6_png");UIManager.instance.topLayer.addChild(n),n.x=700,n.y=285,n.anchorOffsetX=23,n.anchorOffsetY=9,egret.Tween.get(n,{loop:!1}).wait(2500).to({skewX:180,x:300,y:350},1e3).to({skewX:360,x:-100,y:400},1e3).wait(3500)},MainView.prototype.initView=function(){this.loadHead();var t=Global.createBitmapByName("head_png");t.x=3,t.y=6,this.addChild(t),this.txtName=new egret.TextField,this.txtName.size=30,this.txtName.text=UserInfo.instance.username,this.txtName.width=400,this.txtName.x=150,this.txtName.y=45,this.addChild(this.txtName),this.shopContainer=new egret.DisplayObjectContainer,this.addChild(this.shopContainer),this.initFlash()},MainView.prototype.initGuanZhu=function(t){var e=this,i=Global.createBitmapByName("btn_add_png");i.x=340,i.y=35,this.addChild(i),Global.setBut(i),i.touchEnabled=!0,i.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){$(".wx").show(),e.play(t)},this)},MainView.prototype.addTouchHandler=function(){},MainView.prototype.initZhuan=function(t){var e=this;this.btnZhuan=Global.createBitmapByName("btn_zhuan_png"),this.btnZhuan.x=10,this.btnZhuan.y=150,this.btnZhuan.touchEnabled=!0,this.btnZhuan.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.play(t)},this),this.addChild(this.btnZhuan),Global.setBut(this.btnZhuan)},MainView.prototype.initPeople=function(t){var e=Global.createBitmapByName("people_2_png");e.x=StageUtils.SW-e.width>>1,e.y=StageUtils.SH-e.height,this.addChild(e);var i=new egret.DisplayObjectContainer;this.addChild(i);var o=Global.createBitmapByName("people_4_png");o.x=StageUtils.SW-o.width,o.y=StageUtils.SH-o.height,i.addChild(o);var a=Global.createBitmapByName("people_1_png");a.x=StageUtils.SW-a.width-60,a.y=StageUtils.SH-a.height-72;var n=Global.createBitmapByName("people_3_png");n.x=a.x-60+n.width,n.y=a.y+10+n.height,n.anchorOffsetX=n.width,n.anchorOffsetY=n.height,i.addChild(n),i.addChild(a),i.touchEnabled=!0,Global.setBut(i),i.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){"0"==UserInfo.instance.fixed?(console.log(t.ticket),t.ticket?PopManager.showPop("ShopPop",t):PopManager.showPop("TipsPop",1)):PopManager.showPop("TipsPop",2)},this),egret.Tween.get(n,{loop:!0}).to({rotation:10},500).to({rotation:0},500)},MainView.prototype.zongZiClickHandler=function(){PopManager.showPop("AnswerPop")},MainView.prototype.showShiZi=function(){this.shizi=Global.createBitmapByName("shizi_png"),this.shizi.x=StageUtils.SW-this.shizi.width,this.shizi.y=StageUtils.SH-this.shizi.height+30,this.addChild(this.shizi)},MainView.prototype.initZongZi=function(){this.btnZongzi=Global.createBitmapByName("btn_zongzi_png"),this.btnZongzi.pixelHitTest=!0,this.btnZongzi.anchorOffsetX=this.btnZongzi.width>>1,this.btnZongzi.x=StageUtils.SW-this.btnZongzi.width/2,this.btnZongzi.y=0,this.btnZongzi.touchEnabled=!0,this.btnZongzi.addEventListener(egret.TouchEvent.TOUCH_TAP,this.zongZiClickHandler,this),this.addChild(this.btnZongzi),Global.setBut(this.btnZongzi),egret.Tween.get(this.btnZongzi,{loop:!0}).wait(100).to({rotation:-10},1e3).wait(100).to({rotation:0},1e3)},MainView.prototype.removeZongZi=function(){this.btnZongzi&&(this.btnZongzi.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.zongZiClickHandler,this),egret.Tween.removeTweens(this.btnZongzi),this.removeChild(this.btnZongzi),this.btnZongzi=null)},MainView.prototype.hbClickHandler=function(){PopManager.showPop("UserPop",2)},MainView.prototype.kqClickHandler=function(){PopManager.showPop("UserPop",3)},MainView.prototype.showMask=function(t,e){this.showGlow(e)},MainView.prototype.hideMask=function(){this.curObject&&(this.curObject.filter=MainView.nullFilter,this.curObject=null)},MainView.prototype.showShop=function(list){var yjskdata=sessionStorage.getItem("yanjishoukuai"),temp=0;if(yjskdata){var ydata=eval("("+yjskdata+")");console.log(ydata);var obj1={ticket:"",id:"3",type:"yanjishoukuai"};obj1.ticket=ydata.ticket,this.initPeople(obj1)}var hongbao=sessionStorage.getItem("hongbao");if(hongbao){var ydata=eval("("+hongbao+")"),obj1={ticket:"",id:"1",type:"hongbao"};obj1.ticket=ydata.ticket;var shop=new ShopItemView(obj1),inx=Math.floor(Math.random()*this.posX.length);console.log(inx,this.posX.length,this.posX),shop.x=this.posX[inx],shop.y=this.posY[inx],shop.oy=shop.y,this.posX.splice(inx,1),this.posY.splice(inx,1),this.shopContainer.addChild(shop),this.shopList[obj1.type]=shop,shop.touchEnabled=!0,shop.addEventListener(egret.TouchEvent.TOUCH_TAP,this.shopClickHandler,this),Global.setBut(shop),obj1.ticket&&(this.filterList[obj1.type]=shop,temp++)}var isprize=0;if(list){for(var len=list.length,i=0;len>i;i++){var obj=list[i];if(obj)if("yanjishoukuai"==obj.type)this.initPeople(obj),isprize=1;else if("gongzhonghao"==obj.type)"0"==UserInfo.instance.fixed&&this.initGuanZhu(obj);else if(obj.ticket){var shop=new ShopItemView(obj),inx=Math.floor(Math.random()*this.posX.length);console.log(inx,this.posX.length,this.posX),shop.x=this.posX[inx],shop.y=this.posY[inx],shop.oy=shop.y,this.posX.splice(inx,1),this.posY.splice(inx,1),this.shopContainer.addChild(shop),this.shopList[obj.type]=shop,shop.touchEnabled=!0,shop.addEventListener(egret.TouchEvent.TOUCH_TAP,this.shopClickHandler,this),Global.setBut(shop),obj.ticket&&(this.filterList[obj.type]=shop,temp++)}}for(var str in list);temp&&(this.timer=new egret.Timer(5e3),this.timer.addEventListener(egret.TimerEvent.TIMER,this.showJump,this),this.timer.start())}if(0==isprize&&null==yjskdata){var obj2={id:"3",type:"yanjishoukuai"};this.initPeople(obj2)}this.container&&this.container.parent&&this.removeChild(this.container),this.container=null},MainView.prototype.play=function(obj){var hongbao=sessionStorage.getItem("hongbao");if("hongbao"==obj.type&&hongbao)hongbao=eval("("+hongbao+")"),console.log(hongbao),hongbao&&PopManager.showPop("RewardPop",hongbao);else if("yanjishoukuai"==obj.type){var yjskdata=sessionStorage.getItem("yanjishoukuai");yjskdata?window.location.href="http://res.leasiondata.cn/lstatic/av2/yjsk/index.html":window.location.href="http://res.leasiondata.cn/lstatic/av2/yjsk/index.html?"+obj.ticket}else{var self=this;$.ajax({url:MapManager.PLAY_API,data:{type:"play",ticket:obj.ticket,isshared:MapManager.isShared},success:function(t){if(console.log(t),"success"==t.result)if("gongzhonghao"==obj.type);else if("weidian"==obj.desc)window.location.href=obj.value;else{var e=self.shopList[obj.type];e&&e.parent&&("cash"==t.prizes[0].type||-1==t.prizes[0].id?(console.log("cash"),e.parent.removeChild(e)):(console.log("link"),sessionStorage.setItem("hongbao",JSON.stringify(t.prizes[0])))),PopManager.showPop("RewardPop",t.prizes[0])}else Message.show("系统错误！")},error:function(){Message.show("error")},timeout:8e3,dataType:"json",async:!0,type:"POST",complete:function(t,e){"timeout"==e&&Message.show("timeout")}})}},MainView.prototype.showJump=function(){var t=[];for(var e in this.filterList)t.push(this.filterList[e]);var i=t.length;if(0==i)return void this.timer.stop();var o=Math.floor(Math.random()*i);this.curJump&&(egret.Tween.removeTweens(this.curJump),this.curJump.scaleX=this.curJump.scaleY=1,this.curJump.rotation=0,this.curJump.y=this.curJump.oy,this.curJump=null);
var a=t[o];if(a){var n=Math.floor(3*Math.random());0==n?(egret.Tween.get(a,{loop:!0}).to({rotation:5},100).to({rotation:0},100).to({rotation:-5},100).to({rotation:0},100),egret.Tween.get(a,{loop:!0}).to({y:a.y-30},200).to({y:a.y},200)):1==n?egret.Tween.get(a,{loop:!0}).to({rotation:5},100).to({rotation:0},100).to({rotation:-5},100).to({rotation:0},100):(egret.Tween.get(a,{loop:!0}).to({rotation:5},100).to({rotation:0},100).to({rotation:-5},100).to({rotation:0},100),egret.Tween.get(a,{loop:!0}).to({scaleY:1.1},100).to({scaleY:1},100)),this.curJump=a}},MainView.prototype.removeJumpShop=function(t){var e=this.filterList[t];e&&(this.filterList[t]=null,delete this.filterList[t]),e&&e==this.curJump&&(egret.Tween.removeTweens(e),e.scaleX=e.scaleY=1,e.rotation=0,console.log(e.y,this.posY[t-1]),e.y=this.posY[t-1]),this.curJump=null},MainView.prototype.enterFrameHandler=function(){if(this.index%10==0){var t=0;for(var e in this.filterList){var i=this.filterList[e];i&&(t++,this.isShowGlow?i.filters=MainView.nullFilter:i.filters=MainView.glowFilter)}0==t&&(this.removeEventListener(egret.Event.ENTER_FRAME,this.enterFrameHandler,this),this.showGuide(15)),this.isShowGlow=!this.isShowGlow}this.index++},MainView.prototype.showGlow=function(t){egret.Tween.get(t,{loop:!0}).wait(200).call(function(){t.filters=MainView.glowFilter}).wait(200).call(function(){t.filters=MainView.nullFilter})},MainView.prototype.hideGlow=function(t){egret.Tween.removeTweens(t),t.filters=MainView.nullFilter},MainView.prototype.showGuide=function(t){this.curGuideID=t},MainView.prototype.shopClickHandler=function(t){if(t.target.status)if(console.log(t.target),"weidian"==t.target.type){var e={};$.ajax({url:MapManager.PLAY_API,data:{type:"play",ticket:t.target.obj.ticket,isshared:MapManager.isShared},success:function(t){e={ticket:t.prizes[0].ticket,desc:t.prizes[0].desc,type:"weidian",value:t.prizes[0].value},"success"==t.result?(console.log(e),PopManager.showPop("ShopPop",e)):Message.show("系统错误！")},error:function(){Message.show("error")},timeout:8e3,dataType:"json",async:!0,type:"POST",complete:function(t,e){"timeout"==e&&Message.show("timeout")}})}else this.play(t.target.obj)},MainView.prototype.getReward=function(id,kq){void 0===kq&&(kq=0);var self=this,iswin=1;10==id&&(id=0,iswin=0);var dat;dat=kq?{ticket:MapManager.USER_TICKET,isshared:MapManager.isShared,shopid:id,iswin:iswin,kq:1}:{ticket:MapManager.USER_TICKET,isshared:MapManager.isShared,shopid:id,iswin:iswin},$.ajax({url:MapManager.PLAY_API,data:dat,success:function(data){if(0==data.result||"success"==data.result)if("0"==data.shopid||"10"==data.shopid)self.chicken&&self.chicken.parent&&self.chicken.parent.removeChild(self.chicken),self.showShiZi(),PopManager.showPop("LanternResultPop",data);else{if(data.kq&&data.kq1)PopManager.showPop("RewardPop",data);else if(data.kq){var addcard=eval("$.addCard");addcard(this,data.signs,function(){console.log("领取成功"),self.getReward(1,1)},function(){console.log("领取失败")})}else PopManager.showPop("RewardPop",data);self.removeJumpShop(data.shopid)}else self.removeJumpShop(id),6==data.result?Message.show("领取失败，请重新领取"):2==data.result?Message.show("分享数量达到上限"):3==data.result?Message.show("已经领取过"):Message.show("系统异常:"+data.result)},error:function(){},timeout:8e3,dataType:"json",async:!0,type:"POST",complete:function(t,e){}})},MainView.prototype.addValue=function(t,e,i){if(i)for(var o=e-t,a=function(e){egret.Tween.get(i).wait(10*e).call(function(){i.text=t+e+1+""})},n=0;o>n;n++)a(n)},MainView.prototype.addHb=function(t){MapManager.instance.hb+=t;var e=this;egret.Tween.get(this.iconHb).to({rotation:-5},100).to({rotation:5},100).to({rotation:-5},100).to({rotation:5},100).to({rotation:-5},100).to({rotation:0},100),this.txtHb.anchorOffsetX=this.txtHb.width>>1,this.txtHb.anchorOffsetY=this.txtHb.height>>1,this.txtHb.x=this.iconHb.x+30+this.txtHb.width/2,this.txtHb.y=23+this.txtHb.height/2,egret.Tween.get(e.txtHb).wait(600).to({scaleX:1.5,scaleY:1.5,alpha:.5},500).call(function(){e.txtHb.text=MapManager.instance.hb/100+""}).to({scaleX:1,scaleY:1,alpha:1},500)},MainView.prototype.refreshInfo=function(){},MainView.prototype.refreshInfo1=function(){},MainView.prototype.activityClickHandler=function(){PopManager.showPop("ActivityPop")},MainView.prototype.addClickHandler=function(){MapManager.instance.curMapLevel<18&&MapManager.instance.Gmap&&(MapManager.instance.Gmap.zoomIn(),MapManager.instance.curMapLevel++,MapManager.instance.refreshMap())},MainView.prototype.lessClickHandler=function(){MapManager.instance.curMapLevel>0&&MapManager.instance.Gmap&&(MapManager.instance.Gmap.zoomOut(),MapManager.instance.curMapLevel--,MapManager.instance.refreshMap())},MainView.prototype.marketClickHandler=function(){1!=this.curGuideID&&PopManager.showPop("MarketPop")},MainView.prototype.postClickHandler=function(){MapManager.instance.serverLng&&(MapManager.instance.curMapLevel=17,MapManager.instance.refreshMap())},MainView.prototype.copyClickHandler=function(){1!=this.curGuideID&&PopManager.showPop("CopyPop")},MainView}(egret.DisplayObjectContainer);MainView.glowFilter=[new egret.GlowFilter(16776960,1,5,5,20,1,!1,!1)],MainView.nullFilter=[],__reflect(MainView.prototype,"MainView");var ResultPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setData=function(t){void 0===t&&(t=null),this.data=t;var e=new CustomImage("resource/assets/asyn/answer_bg.png",!0,function(){e.x=StageUtils.SW-e.width>>1,e.y=StageUtils.SH-e.height>>1});this.addChild(e);var i=new CustomImage("resource/assets/asyn/answer_result_"+t+".png",!0,function(){i.x=StageUtils.SW-i.width>>1,i.y=StageUtils.SH-i.height>>1});this.addChild(i);var o=Global.createBitmapByName("close_png");o.x=StageUtils.SW-o.width-90,o.y=185,this.addChild(o),o.touchEnabled=!0,Global.setBut(o),o.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeClickHandler,this),MainView.instance.people.visible=!1},e.prototype.closeClickHandler=function(){PopManager.hidePop("ResultPop"),MainView.instance.people.visible=!0},e}(PopView);__reflect(ResultPop.prototype,"ResultPop");var RewardPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setData=function(t){void 0===t&&(t=null),this.data=t;var e=Global.createBitmapByName("pop_bg_png");e.x=StageUtils.SW-e.width>>1,e.y=StageUtils.SH-e.height>>1,this.addChild(e);var i;if("cash"==t.type){var o=new CustomImage("resource/assets/reward/"+t.desc+".png",!0,function(){o.x=StageUtils.SW-o.width>>1,o.y=StageUtils.SH-o.height>>1});this.addChild(o),i=Global.createBitmapByName("btn_reward_1_png"),i.y=780}else if(-1==t.id){var o=new CustomImage("resource/assets/reward/thankyou.png",!0,function(){o.x=StageUtils.SW-o.width>>1,o.y=StageUtils.SH-o.height>>1});this.addChild(o),i=Global.createBitmapByName("btn_reward_1_png"),i.y=780}else{var o=new CustomImage("resource/assets/reward/reward_"+t.desc+".png",!0,function(){o.x=StageUtils.SW-o.width>>1,o.y=StageUtils.SH-o.height>>1});this.addChild(o),i=Global.createBitmapByName("btn_reward_png"),i.y=770}i.x=StageUtils.SW-i.width>>1,this.addChild(i),i.touchEnabled=!0,Global.setBut(i),i.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeClickHandler,this);var a=Global.createBitmapByName("close_png");a.x=StageUtils.SW-a.width-90,a.y=185,this.addChild(a),a.touchEnabled=!0,Global.setBut(a),a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeClickHandler1,this)},e.prototype.closeClickHandler=function(){if("cash"==this.data.type||-1==this.data.id)PopManager.hidePop("RewardPop");else{sessionStorage.getItem("hongbao");$.ajax({url:MapManager.PLAY_API,data:{type:"play",ticket:this.data.ticket,isshared:MapManager.isShared},success:function(t){"success"==t.result?(sessionStorage.removeItem("hongbao"),window.location.href=t.prize.value):Message.show("系统错误！")},error:function(){Message.show("error")},timeout:8e3,dataType:"json",async:!0,type:"POST",complete:function(t,e){"timeout"==e&&Message.show("timeout")}})}},e.prototype.closeClickHandler1=function(){PopManager.hidePop("RewardPop")},e}(PopView);__reflect(RewardPop.prototype,"RewardPop");var ShopPop=function(t){function e(){var e=t.call(this)||this;return e.state=0,e}return __extends(e,t),e.prototype.setData=function(t){void 0===t&&(t=null),console.log(t),this.data=t;var e,i;"yanjishoukuai"==t.type?(e=5,i=2):"weidian"==t.type&&(e=3,i=3),this.removeChildren();var o=new CustomImage("resource/assets/asyn/shop_"+e+".png",!0,function(){o.x=StageUtils.SW-o.width>>1,o.y=StageUtils.SH-o.height>>1});this.addChild(o);var i,a=Global.createBitmapByName("btn_into_"+i+"_png");a.x=StageUtils.SW-a.width>>1,a.y=718,this.addChild(a),a.touchEnabled=!0,Global.setBut(a),a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.okClickHandler,this);var n=Global.createBitmapByName("close_png");n.x=StageUtils.SW-n.width-60,n.y=210,this.addChild(n),n.touchEnabled=!0,Global.setBut(n),n.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeClickHandler,this)},e.prototype.okClickHandler=function(){MainView.instance.play(this.data)},e.prototype.closeClickHandler=function(){PopManager.hidePop("ShopPop")},e}(PopView);__reflect(ShopPop.prototype,"ShopPop");var TipsPop=function(t){function e(){var e=t.call(this)||this;return e.state=0,e}return __extends(e,t),e.prototype.setData=function(t){void 0===t&&(t=null),this.data=t,this.removeChildren();var e=new CustomImage("resource/assets/asyn/tips_"+t+".png",!0,function(){e.x=StageUtils.SW-e.width>>1,e.y=StageUtils.SH-e.height>>1});this.addChild(e);var i=Global.createBitmapByName("btn_ok_png");i.x=StageUtils.SW-i.width>>1,i.y=770,this.addChild(i),i.touchEnabled=!0,Global.setBut(i),i.addEventListener(egret.TouchEvent.TOUCH_TAP,this.okClickHandler,this);var o=Global.createBitmapByName("close_png");o.x=StageUtils.SW-o.width-65,o.y=198,this.addChild(o),o.touchEnabled=!0,Global.setBut(o),o.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeClickHandler,this)},e.prototype.okClickHandler=function(){PopManager.hidePop("TipsPop")},e.prototype.closeClickHandler=function(){PopManager.hidePop("TipsPop")},e}(PopView);__reflect(TipsPop.prototype,"TipsPop");var UserPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setData=function(t){void 0===t&&(t=null),this.data=t;var e=new CustomImage("resource/assets/asyn/user_bg.png",!0,function(){e.x=StageUtils.SW-e.width>>1,e.y=65});this.addChild(e);var i=Global.createBitmapByName("close_png");i.x=StageUtils.SW-i.width-50,i.y=75,this.addChild(i),i.touchEnabled=!0,Global.setBut(i),i.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeClickHandler,this),this.tabContainer=new egret.DisplayObjectContainer,this.addChild(this.tabContainer),this.loadHead(),this.initTabbar(),this.setTabSelect(t)},e.prototype.initTabbar=function(){var t=Global.createBitmapByName("line2_png");t.x=200,t.y=115,this.addChild(t);var e=Global.createBitmapByName("line1_png");e.x=StageUtils.SW-e.width>>1,e.y=155,this.addChild(e),this.tab1=Global.createBitmapByName("tabbar_1_2_png"),this.tab1.x=155,this.tab1.y=115,this.addChild(this.tab1),this.tab2=Global.createBitmapByName("tabbar_2_2_png"),this.tab2.x=225,this.tab2.y=115,this.addChild(this.tab2),this.tab3=Global.createBitmapByName("tabbar_3_2_png"),this.tab3.x=295,this.tab3.y=115,this.addChild(this.tab3),this.tab1.touchEnabled=!0,this.tab2.touchEnabled=!0,this.tab3.touchEnabled=!0,Global.setBut(this.tab1),Global.setBut(this.tab2),Global.setBut(this.tab3),this.tab1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.tab1ClickHandler,this),this.tab2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.tab2ClickHandler,this),this.tab3.addEventListener(egret.TouchEvent.TOUCH_TAP,this.tab3ClickHandler,this)},e.prototype.tab1ClickHandler=function(){this.setTabSelect(1)},e.prototype.tab2ClickHandler=function(){this.setTabSelect(2)},e.prototype.tab3ClickHandler=function(){this.setTabSelect(3)},e.prototype.setTabSelect=function(t){if(t!=this.tabSelectIndex){this.tabSelect&&(this.tabSelect.texture=RES.getRes("tabbar_"+this.tabSelectIndex+"_2_png"));var e=this["tab"+t];e&&(this.tabSelectIndex=t,this.tabSelect=e,this.tabSelect.texture=RES.getRes("tabbar_"+this.tabSelectIndex+"_1_png")),this.initTabContent()}},e.prototype.initTabContent=function(){if(this.tabContainer.removeChildren(),1==this.tabSelectIndex){var t=new CustomImage("resource/assets/asyn/user_wo.png",!0,function(){t.x=StageUtils.SW-t.width>>1,t.y=200});this.tabContainer.addChild(t)}else if(2==this.tabSelectIndex){var t=new CustomImage("resource/assets/asyn/user_hb.png",!0,function(){t.x=StageUtils.SW-t.width>>1,t.y=200});this.tabContainer.addChild(t)}else{var t=new CustomImage("resource/assets/asyn/user_lq.png",!0,function(){t.x=StageUtils.SW-t.width>>1,t.y=200});this.tabContainer.addChild(t)}},e.prototype.loadHead=function(){var t=new CustomImage(UserInfo.instance.url,!0,function(){t.width=122,t.height=122,t.x=3,t.y=10});this.addChild(t);var e=Global.createBitmapByName("head_bg_png");e.x=3,e.y=10,this.addChild(e);var i=new egret.Shape;i.graphics.beginFill(0),i.graphics.drawCircle(e.x+e.width/2,e.y+e.height/2,50),i.graphics.drawCircle,i.graphics.endFill(),this.addChild(i),t.mask=i},e.prototype.closeClickHandler=function(){PopManager.hidePop("UserPop")},e}(PopView);__reflect(UserPop.prototype,"UserPop");var WelcomePop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setData=function(t){void 0===t&&(t=null),this.data=t;var e=new CustomImage(UserInfo.instance.url,!0,function(){e.width=100,e.height=100,e.x=StageUtils.SW-e.width>>1,e.y=(StageUtils.SH-e.height>>1)-200});this.addChild(e);var i=Global.createBitmapByName("wel_head_png");i.x=StageUtils.SW-i.width>>1,i.y=(StageUtils.SH-i.height>>1)-200,this.addChild(i);var o=new egret.Shape;o.graphics.beginFill(0),o.graphics.drawCircle(i.x+i.width/2,i.y+i.height/2,50),o.graphics.endFill(),this.addChild(o),e.mask=o;var a=new egret.TextField;a.text=UserInfo.instance.username,a.width=StageUtils.SW,a.textAlign=egret.HorizontalAlign.CENTER,a.y=StageUtils.CH-130,this.addChild(a);var n=Global.createBitmapByName("wel_btn_png");n.x=StageUtils.SW-n.width>>1,n.y=StageUtils.SH-n.height>>1,this.addChild(n),n.touchEnabled=!0,Global.setBut(n),n.addEventListener(egret.TouchEvent.TOUCH_TAP,this.intoClickHandler,this);var s=Global.createBitmapByName("wel_bg_png");s.x=StageUtils.SW-s.width>>1,s.y=(StageUtils.SH-s.height>>1)+200,this.addChild(s),egret.Tween.get(this).to({alpha:0},3e3).call(function(){PopManager.hidePop("WelcomePop")})},e.prototype.intoClickHandler=function(){PopManager.hidePop("WelcomePop")},e}(PopView);__reflect(WelcomePop.prototype,"WelcomePop");
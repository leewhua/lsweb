var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},PopView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.show=function(){UIManager.instance.popLayer.addChild(this),this.touchEnabled=!0},e.prototype.hide=function(){UIManager.instance.popLayer.removeChild(this)},e.prototype.setData=function(t){void 0===t&&(t=null),this.data=t},e}(egret.DisplayObjectContainer);__reflect(PopView.prototype,"PopView");var LoginPop=function(t){function e(){var e=t.call(this)||this;return e.passStr="888888",e}return __extends(e,t),e.prototype.setData=function(e){t.prototype.setData.call(this);var i=new CustomImage("resource/assets/asyn/login_bg.png",!0,function(){i.width=StageUtils.SW,i.height=StageUtils.SH});this.addChild(i);var a=Global.createBitmapByName("login_input_bg_png");a.x=StageUtils.SW-a.width>>1,a.y=260,this.addChild(a);var s=Global.createBitmapByName("login_submit_png");s.x=StageUtils.SW-s.width>>1,s.y=435,this.addChild(s),Global.setBut(s),s.addEventListener(egret.TouchEvent.TOUCH_TAP,this.submitHandler,this),this.txtName=new egret.TextField,this.txtName.width=400,this.txtName.fontFamily="微软雅黑",this.txtName.type=egret.TextFieldType.INPUT,this.txtName.x=(StageUtils.SW-this.txtName.width>>1)+30,this.txtName.y=275,this.txtName.text="请输入帐号",this.txtName.size=24,this.txtName.textColor=8431304,this.txtName.maxChars=20,this.addChild(this.txtName),this.txtPassword=new egret.TextField,this.txtPassword.width=400,this.txtPassword.fontFamily="微软雅黑",this.txtPassword.type=egret.TextFieldType.INPUT,this.txtPassword.x=(StageUtils.SW-this.txtPassword.width>>1)+30,this.txtPassword.y=360,this.txtPassword.text="请输入密码",this.txtPassword.size=24,this.txtPassword.textColor=8431304,this.txtPassword.maxChars=20,this.txtPassword.inputType=egret.TextFieldInputType.PASSWORD,this.addChild(this.txtPassword),this.txtName.addEventListener(egret.FocusEvent.FOCUS_IN,this.nameFocusInHandler,this),this.txtName.addEventListener(egret.FocusEvent.FOCUS_OUT,this.nameFocusOutHandler,this),this.txtPassword.addEventListener(egret.FocusEvent.FOCUS_IN,this.passFocusInHandler,this),this.txtPassword.addEventListener(egret.FocusEvent.FOCUS_OUT,this.passFocusOutHandler,this);var o=Global.createBitmapByName("btn_change_id_png");o.x=145,o.y=515,this.addChild(o),Global.setBut(o),o.addEventListener(egret.TouchEvent.TOUCH_TAP,this.changeIDHandler,this);var n=Global.createBitmapByName("btn_change_pw_png");n.x=385,n.y=515,this.addChild(n),Global.setBut(n),n.addEventListener(egret.TouchEvent.TOUCH_TAP,this.changePWHandler,this)},e.prototype.changePWHandler=function(){PopManager.showPop("ChangePWPop")},e.prototype.changeIDHandler=function(){PopManager.showPop("ChangeIDPop")},e.prototype.nameFocusInHandler=function(){"请输入帐号"==this.txtName.text&&(this.txtName.text="")},e.prototype.nameFocusOutHandler=function(){""==this.txtName.text&&(this.txtName.text="请输入帐号")},e.prototype.passFocusInHandler=function(){"请输入密码"==this.txtPassword.text?(this.txtPassword.text="",this.txtPassword.displayAsPassword=!0):this.txtPassword.displayAsPassword=!1},e.prototype.passFocusOutHandler=function(){""==this.txtPassword.text?(this.txtPassword.text="请输入密码",this.txtPassword.displayAsPassword=!1):this.txtPassword.displayAsPassword=!0},e.prototype.passChangeHandler=function(t){var e=t.target.text,i=e.length;e=e.replace(/\*/g,""),this.passStr+=e,this.passStr=this.passStr.substr(0,i),e="";for(var a=0;i>a;a++)e+="*";this.txtPassword1.text=e,console.log(this.passStr)},e.prototype.submitHandler=function(){var t=this.txtName.text.trim(),e=this.txtPassword.text.trim();if(t&&"请输入密码"!=t&&e&&"请输入密码"!=e){var i=this;$.ajax({url:Main.USER_INFO_API,data:{type:"login",ticket:Main.USER_TICKET,user:t,password:e},success:function(t){0==t.result?i.loginOK():Message.show("账号或密码错误，请重试！")},error:function(){},timeout:8e3,dataType:"json",async:!0,type:"POST",complete:function(t,e){"timeout"==e&&PopManager.showPop("ErrorPop",{url:"resource/assets/asyn/error/error_web.png"})}})}else Message.show("请完整填写账号和密码")},e.prototype.loginOK=function(){PopManager.hidePop("LoginPop"),PopManager.showPop("ListPop")},e}(PopView);__reflect(LoginPop.prototype,"LoginPop");var SelectListPop=function(_super){function SelectListPop(){var t=_super.call(this)||this;return t.itemList=[],t}return __extends(SelectListPop,_super),SelectListPop.prototype.setData=function(t){_super.prototype.setData.call(this,t);var e=Global.createBitmapByName("select_list_title_png");e.x=StageUtils.SW-e.width>>1,e.y=0,this.addChild(e),this.txtEmail=new egret.TextField,this.txtEmail.textColor=9212833,this.txtEmail.text="您还可以通过关注“华美食品”公众号\r从经销商入口查询付款详情",this.txtEmail.width=600,this.txtEmail.x=20,this.txtEmail.y=StageUtils.SH-100,this.txtEmail.size=24,this.txtEmail.lineSpacing=10,this.txtEmail.textAlign=egret.HorizontalAlign.CENTER,this.addChild(this.txtEmail),this.txtEmail.addEventListener(egret.FocusEvent.FOCUS_IN,this.emailFocusInHandler,this),this.txtEmail.addEventListener(egret.FocusEvent.FOCUS_OUT,this.emailFocusOutHandler,this),this.container=new egret.DisplayObjectContainer;var i=new egret.ScrollView;i.setContent(this.container),i.horizontalScrollPolicy="off",i.scrollSpeed=.5,this.addChild(i),i.x=0,i.y=82,i.width=StageUtils.SW,i.height=700,this.getData();var a=Global.createBitmapByName("btn_close_png");a.x=50,a.y=StageUtils.SH-a.height-120,this.addChild(a),Global.setBut(a),a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeHandler,this);var s=Global.createBitmapByName("btn_select_png");s.x=StageUtils.SW-s.width-50,s.y=StageUtils.SH-s.height-120-7,this.addChild(s),Global.setBut(s),s.addEventListener(egret.TouchEvent.TOUCH_TAP,this.selectHandler,this);var o=Global.createBitmapByName("select_bg_down_png");o.x=StageUtils.SW-o.width>>1,o.y=StageUtils.SH-o.height,this.addChild(o)},SelectListPop.prototype.selectHandler=function(){PopManager.hidePop("SelectListPop"),PopManager.showPop("SelectPop")},SelectListPop.prototype.closeHandler=function(){var weixin=eval("wx");weixin&&weixin.closeWindow()},SelectListPop.prototype.payHandler=function(){var t=this.txtEmail.text;t&&"请输入邮箱"!=t?Message.show("发送成功!"):Message.show("请输入邮箱!")},SelectListPop.prototype.emailFocusInHandler=function(){"请输入邮箱"==this.txtEmail.text&&(this.txtEmail.text="")},SelectListPop.prototype.emailFocusOutHandler=function(){""==this.txtEmail.text&&(this.txtEmail.text="请输入邮箱")},SelectListPop.prototype.getData=function(){this.refreshData(this.data)},SelectListPop.prototype.refreshData=function(t){if(this.itemList.length=0,this.container.removeChildren(),t)for(var e=t.length,i=0;e>i;i++){var a=new SelectListItem;a.y=100*i,a.setData(t[i]),this.container.addChild(a),this.itemList.push(a)}},SelectListPop}(PopView);__reflect(SelectListPop.prototype,"SelectListPop");var CustomTabbar=function(t){function e(e,i,a){for(var s=t.call(this)||this,o=0;e>o;o++){var n=Global.createBitmapByName("tabbar_"+(o+1)+"_2_png");n.x=295,n.y=115,s.addChild(n)}return s}return __extends(e,t),e}(egret.DisplayObjectContainer);__reflect(CustomTabbar.prototype,"CustomTabbar");var CustomTabButton=function(t){function e(e,i,a,s){var o=t.call(this)||this;return o._select=!1,o.w=i,o.h=a,o.bg=new egret.Shape,o.bg.graphics.beginFill(1600721),o.bg.graphics.drawRect(0,0,i,a),o.bg.graphics.endFill(),o.addChild(o.bg),o.txtLable=new egret.TextField,o.txtLable.text=e,o.txtLable.size=s,o.txtLable.x=0,o.txtLable.y=0,o.txtLable.width=i,o.txtLable.height=a,o.txtLable.textAlign="center",o.txtLable.verticalAlign=egret.VerticalAlign.MIDDLE,o.txtLable.textColor=16777215,o.addChild(o.txtLable),o.touchEnabled=!0,o}return __extends(e,t),Object.defineProperty(e.prototype,"select",{get:function(){return this._select},set:function(t){this._select=t,this._select?(this.txtLable.textColor=16777215,this.bg.graphics.clear(),this.bg.graphics.beginFill(1600721),this.bg.graphics.drawRect(0,0,this.w,this.h),this.bg.graphics.endFill()):(this.txtLable.textColor=0,this.bg.graphics.clear(),this.bg.graphics.beginFill(16777215),this.bg.graphics.drawRect(0,0,this.w,this.h),this.bg.graphics.endFill())},enumerable:!0,configurable:!0}),e}(egret.DisplayObjectContainer);__reflect(CustomTabButton.prototype,"CustomTabButton");var QRCode=function(){function t(t){var e=document.getElementById("gameDiv");this.htmlCode=document.createElement("img"),this.htmlCode.src=t,this.htmlCode.style.position="absolute",this.htmlCode.style.display="none",e.appendChild(this.htmlCode)}return t.prototype.showHtmlCode=function(){this.htmlCode&&(this.htmlCode.style.display="inline")},t.prototype.hideHtmlCode=function(){this.htmlCode&&(this.htmlCode.style.display="none")},t.prototype.setPosition=function(t,e,i,a){if(null!=this.htmlCode)if(document.body.clientWidth<document.body.clientHeight){var s=document.body.clientWidth/StageUtils.SW,o=document.body.clientHeight/StageUtils.SH;this.htmlCode.style.width=i*s+"px",this.htmlCode.style.height=a*o+"px",this.htmlCode.style.left=t*s+"px",this.htmlCode.style.top=e*o+"px"}else{var s=document.body.clientWidth/StageUtils.SH,o=document.body.clientHeight/StageUtils.SW;this.htmlCode.style.width=a*s+"px",this.htmlCode.style.height=i*o+"px",this.htmlCode.style.top=(StageUtils.SW-t-i)*o+"px",this.htmlCode.style.left=e*s+"px"}},t.prototype.destroy=function(){this.htmlCode&&(this.htmlCode.parentNode.removeChild(this.htmlCode),this.htmlCode=null)},t}();__reflect(QRCode.prototype,"QRCode");var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){var t=new CustomImage("resource/assets/asyn/loading_bg.jpg",!0,function(){t.width=StageUtils.SW,t.height=StageUtils.SH});this.addChild(t),this.textField=new egret.TextField,this.addChild(this.textField),this.textField.width=StageUtils.SW,this.textField.height=100,this.textField.x=0,this.textField.y=0,this.textField.size=20,this.textField.textAlign="center"},e.prototype.setProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var Main=function(_super){function Main(){var t=_super.call(this)||this;return t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t}return __extends(Main,_super),Object.defineProperty(Main,"USER_INFO_API",{get:function(){return Main.ROOT+"info?"+Math.random()},enumerable:!0,configurable:!0}),Object.defineProperty(Main,"PLAY_API",{get:function(){return Main.ROOT+"play?"+Math.random()},enumerable:!0,configurable:!0}),Main.prototype.onAddToStage=function(t){StageUtils.registStage(this.stage),this.addChild(UIManager.instance),this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},Main.prototype.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")},Main.prototype.onResourceLoadComplete=function(t){"preload"==t.groupName?RES.loadGroup("select"):"select"==t.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.createGameScene())},Main.prototype.onItemLoadError=function(t){console.warn("Url:"+t.resItem.url+" has failed to load")},Main.prototype.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},Main.prototype.onResourceProgress=function(t){"preload"==t.groupName&&this.loadingView.setProgress(t.itemsLoaded,t.itemsTotal)},Main.prototype.createGameScene=function(){if(this.getData()){$.ajax({url:Main.USER_INFO_API,data:{type:"first",ticket:Main.USER_TICKET},success:function(t){0==t.result?1==t.page?PopManager.showPop("LoginPop"):2==t.page?PopManager.showPop("ListPop"):3==t.page?PopManager.showPop("SelectLoginPop"):4==t.page?PopManager.showPop("SelectPop"):5==t.page?PopManager.showPop("PersonalPop",{type:0,ptype:t.producttype}):6==t.page?PopManager.showPop("IntoSharePop",{producttype:t.producttype,sharelist:t.sharelist,payorder:t.payorder}):7==t.page?PopManager.showPop("ErrorPop",{url:"resource/assets/asyn/error/error_yijihuo.png",qr:1,x:140,y:395}):8==t.page?PopManager.showPop("ErrorPop",{url:"resource/assets/asyn/error/error_guama.png"}):9==t.page?PopManager.showPop("HasGetBuyPop"):10==t.page?PopManager.showPop("HasGetInfoPop"):11==t.page?PopManager.showPop("HasGetInfoPop"):12==t.page?PopManager.showPop("ErrorPop",{url:"resource/assets/asyn/error/error_code.png"}):13==t.page?PopManager.showPop("GetShareOKPop",{payorder:t.payorder}):14==t.page?PopManager.showPop("ErrorPop",{url:"resource/assets/asyn/error/error_huobao.png"}):15==t.page?PopManager.showPop("ErrorPop",{url:"resource/assets/asyn/error/error_web.png"}):16==t.page?PopManager.showPop("HasGetPop"):17==t.page?PopManager.showPop("InfoPop"):18==t.page?PopManager.showPop("ErrorPop",{url:"resource/assets/asyn/error/error_pay.png"}):19==t.page?PopManager.showPop("ConfimPayPop",t.paylist):20==t.page?PopManager.showPop("ErrorPop",{url:"resource/assets/asyn/share_end.png"}):21==t.page?PopManager.showPop("ErrorPop",{url:"resource/assets/asyn/error/815.jpg"}):22==t.page&&PopManager.showPop("ErrorPop",{url:"resource/assets/asyn/error/816.jpg"}):PopManager.showPop("ErrorPop",{url:"resource/assets/asyn/error/error_web.png"})},error:function(){},timeout:8e3,dataType:"json",async:!0,type:"POST",complete:function(t,e){"timeout"==e&&PopManager.showPop("ErrorPop",{url:"resource/assets/asyn/error/error_web.png"})}})}},Main.prototype.getData=function(){var t,e=window.location.href.split("#")[0].split("?")[1];if(console.log("loadUser"),e){t=e.split("$");var i=t[0].split("=")[0].split(",");return Main.USER_TICKET=i[0],!0}return!1},Main.share=function(url,eshareinfo,time){if(void 0===eshareinfo&&(eshareinfo=null),void 0===time&&(time=null),console.log("in"),eval("$.wxIsReady")){console.log("123");var weixin=eval("wx;");weixin&&weixin.onMenuShareAppMessage({title:"送你一份心意",desc:"点击领取好友送您的月饼与祝福,该月饼券 "+time+" 日前领取有效",link:url,imgUrl:"http://res.leasiondata.cn/lstatic/h/share/share_new.jpg",success:function(){},cancel:function(){}})}else setTimeout(function(){Main.share(url,eshareinfo,time)},100)},Main.sendShareOK=function(t){$.ajax({url:Main.USER_INFO_API,data:{type:"esharesuccess",ticket:Main.USER_TICKET,eshareinfo:t},success:function(t){0==t.result||Message.show(t.result)},error:function(){},timeout:8e3,dataType:"json",async:!0,type:"POST",complete:function(t,e){"timeout"==e&&PopManager.showPop("ErrorPop",{url:"resource/assets/asyn/error/error_web.png"})}})},Main.showShare=function(){var weixin=eval("wx");weixin&&weixin.showMenuItems({menuList:["menuItem:share:appMessage"]})},Main.hideShare=function(){var weixin=eval("wx");weixin&&weixin.hideMenuItems({menuList:["menuItem:share:timeline","menuItem:share:qq","menuItem:share:weiboApp","menuItem:share:facebook","menuItem:share:QZone","menuItem:favorite","menuItem:openWithQQBrowser","menuItem:openWithSafari","menuItem:share:email"]})},Main}(egret.DisplayObjectContainer);Main.USER_TICKET="",Main.ROOT="http://106.75.4.222/newlsplay4hm/",__reflect(Main.prototype,"Main");var PopManager=function(){function PopManager(){}return PopManager.showPop=function(pop,data){void 0===data&&(data=null);var view=PopManager.popDic[pop];view?view.setData(data):(view=eval("new "+pop+"()"),view&&view.setData(data),PopManager.popDic[pop]=view),view.show()},PopManager.hidePop=function(t){var e=PopManager.popDic[t];e?(e.hide(),delete PopManager.popDic[t]):console.log(t+":不存在")},PopManager}();PopManager.popDic={},__reflect(PopManager.prototype,"PopManager");var CustomButton=function(t){function e(e,i,a){void 0===i&&(i=0),void 0===a&&(a=0);var s=t.call(this)||this;return s.bg=Global.createBitmapByName(e),i&&(s.bg.width=i),a&&(s.bg.height=a),s.addChild(s.bg),s.label=new egret.TextField,s.label.fontFamily="微软雅黑",s.label.size=40,s.label.textColor=16777215,s.label.width=s.bg.width,s.label.height=s.bg.height-5,s.label.textAlign=egret.HorizontalAlign.CENTER,s.label.verticalAlign=egret.VerticalAlign.MIDDLE,s.addChild(s.label),s.touchEnabled=!0,Global.setBut(s),s}return __extends(e,t),Object.defineProperty(e.prototype,"text",{get:function(){return this.label.text},set:function(t){this.label.text=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enabled",{set:function(t){t?(this.alpha=1,this.touchEnabled=!0):(this.alpha=.68,this.touchEnabled=!1)},enumerable:!0,configurable:!0}),e}(egret.DisplayObjectContainer);__reflect(CustomButton.prototype,"CustomButton");var UIManager=function(t){function e(){var e=t.call(this)||this;return e.initLayer(),e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!0,configurable:!0}),e.prototype.initLayer=function(){this.mainUILayer=new egret.DisplayObjectContainer,this.addChild(this.mainUILayer),this.popLayer=new egret.DisplayObjectContainer,this.addChild(this.popLayer),this.topLayer=new egret.DisplayObjectContainer,this.addChild(this.topLayer)},e.prototype.initMainView=function(){this.gameView=new GameView,this.mainUILayer.addChild(this.gameView)},e}(egret.DisplayObjectContainer);__reflect(UIManager.prototype,"UIManager");var AudioManager=function(){function t(){}return t.playEffect=function(t){var e=RES.getRes(t);e.play(0,1)},t}();__reflect(AudioManager.prototype,"AudioManager");var CustomImage=function(t){function e(e,i,a){void 0===i&&(i=!0),void 0===a&&(a=null);var s=t.call(this)||this;return s.url=e,s.isEase=i,s.compFunc=a,s.loadBg(),s}return __extends(e,t),e.prototype.loadBg=function(){RES.getResByUrl(this.url,this.onLoadComplete,this,RES.ResourceItem.TYPE_IMAGE)},e.prototype.onLoadComplete=function(t){this.texture=t,this.isEase&&(this.alpha=0,egret.Tween.get(this).to({alpha:1},1e3)),this.compFunc&&this.compFunc()},e}(egret.Bitmap);__reflect(CustomImage.prototype,"CustomImage");var ErrorCode=function(){function t(){}return t}();ErrorCode.TIME_OUT=999,ErrorCode.NOT_FOUND=404,ErrorCode.SYSTEM_ERROR=100,ErrorCode.TICKET_TIME_OUT=1,ErrorCode.RECEIVED_SELF=2,ErrorCode.RECEIVED_OTHER=3,ErrorCode.RECEIVED_ERROR=4,__reflect(ErrorCode.prototype,"ErrorCode");var GameDispatcher=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!0,configurable:!0}),e}(egret.EventDispatcher);__reflect(GameDispatcher.prototype,"GameDispatcher");var Global=function(){function t(){}return t.createBitmapByRes=function(t,e){var i=new egret.Bitmap,a=RES.getRes(t);return console.log("name::"+e+"::"+t),i.texture=a.getTexture(e),i},t.createBitmapByName=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0);var a=new egret.Bitmap,s=RES.getRes(t);return a.texture=s,a.x=e,a.y=i,a},t.fadeIn=function(e,i,a,s){void 0===i&&(i=0),void 0===a&&(a=500),void 0===s&&(s=1),t.tweenFrom(e,i,a,0,0,s,egret.Ease.cubicOut)},t.fadeOut=function(e,i,a,s){void 0===i&&(i=0),void 0===a&&(a=500),void 0===s&&(s=1),t.tweenToHide(e,i,a,0,0,s,egret.Ease.cubicOut)},t.zoomIn=function(e,i,a,s){void 0===i&&(i=0),void 0===a&&(a=500),void 0===s&&(s=.6),t.tweenFrom(e,i,a,0,0,s,egret.Ease.backOut)},t.zoomOut=function(e,i,a,s){void 0===i&&(i=0),void 0===a&&(a=500),void 0===s&&(s=1.5),t.tweenToHide(e,i,a,0,0,s,egret.Ease.cubicIn)},t.tweenToHide=function(t,e,i,a,s,o,n,r){void 0===r&&(r=0);var h=egret.Tween.get(t),l=t.x,d=t.y;l+=a,d+=s,h.wait(e),h.to({alpha:r,scaleX:o,scaleY:o,x:l,y:d},i,n),h.call(function(){t.parent&&t.parent.removeChild(t)})},t.tweenTo=function(t,e,i,a,s,o,n,r){void 0===o&&(o=1),void 0===n&&(n=1),void 0===r&&(r=egret.Ease.cubicOut);var h=egret.Tween.get(t);h.wait(e),r?h.to({alpha:o,scaleX:n,scaleY:n,x:a,y:s},i,r):h.to({alpha:o,scaleX:n,scaleY:n,x:a,y:s},i)},t.tweenFrom=function(t,e,i,a,s,o,n){var r=egret.Tween.get(t),h=t.x,l=t.y;t.scaleX=t.scaleY=o,t.x=h+a,t.y=l+s,r.wait(e),r.to({alpha:1,scaleX:1,scaleY:1,x:h,y:l},i,n)},t.createMc=function(t,e,i){var a=RES.getRes(t),s=RES.getRes(e),o=new egret.MovieClipDataFactory(a,s),n=new egret.MovieClip(o.generateMovieClipData(i));return n},t.remove=function(t){t&&t.parent&&t.parent.removeChild(t)},t.setBut=function(t){t&&(t.touchEnabled=!0,t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){t.alpha=.68},t),t.addEventListener(egret.TouchEvent.TOUCH_END,function(){t.alpha=1},t),t.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,function(){t.alpha=1},t))},t.getArrayItems=function(t,e){var i=new Array;for(var a in t)i.push(t[a]);for(var s=new Array,o=0;e>o&&i.length>0;o++){var n=Math.floor(Math.random()*i.length);s[o]=i[n],i.splice(n,1)}return s},t.errorTips=function(t){t&&("invalidticket"==t.reason?PopManager.showPop("ErrorPop",ErrorCode.TICKET_TIME_OUT):"invalidticketparam"==t.reason?PopManager.showPop("ErrorPop",ErrorCode.NOT_FOUND):PopManager.showPop("ErrorPop",ErrorCode.SYSTEM_ERROR))},t.showTips=function(t){Message.show(t)},t}();Global.grayMatrix=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0],Global.grayFlilter=[new egret.ColorMatrixFilter(Global.grayMatrix)],Global.grayFlilter1=[new egret.ColorMatrixFilter([.1,.1,0,0,200,.1,.1,0,0,0,.1,.1,0,0,0,0,0,0,1,0])],Global.DM_Filter=[new egret.GlowFilter(1348416,.5,30,30,2,1)],Global.GZ_Filter=[new egret.GlowFilter(11588940,.5,30,30,2,1)],Global.JZ_Filter=[new egret.GlowFilter(13944964,.5,30,30,2,1)],Global.RP_Filter=[new egret.GlowFilter(5029887,.5,30,30,2,1)],Global.QP_Filter=[new egret.GlowFilter(10658466,.5,30,30,2,1)],Global.AI_Filter=[new egret.GlowFilter(13369344,.5,30,30,2,1)],__reflect(Global.prototype,"Global");var Message=function(t){function e(){var e=t.call(this)||this;return e.bg=Global.createBitmapByName("message_bg_png"),e.bg.y=-10,e.addChild(e.bg),e.txtStr=new egret.TextField,e.txtStr.textColor=16662101,e.txtStr.width=StageUtils.SW,e.txtStr.textAlign=egret.HorizontalAlign.CENTER,e.addChild(e.txtStr),e}return __extends(e,t),e.prototype.show=function(t){this.txtStr.text=t,this.bg.width=this.txtStr.textWidth+50,this.bg.height=this.txtStr.textHeight+20,this.bg.x=StageUtils.SW-this.bg.width>>1,this.y=StageUtils.SH>>1,this.alpha=1,egret.Tween.get(this).wait(1e3).to({y:this.y-100,alpha:0},1e3,egret.Ease.quadIn).call(this.tweenEnd,this)},e.prototype.tweenEnd=function(){this.parent&&(this.parent.removeChild(this),e.pool.push(this))},e.show=function(t){var i;i=e.pool.length>0?e.pool.pop():new e,i&&(i.show(t),UIManager.instance.topLayer.addChild(i))},e}(egret.DisplayObjectContainer);Message.pool=[],__reflect(Message.prototype,"Message");var StageUtils=function(){function t(){}return t.registStage=function(e){t.stage=e,t.SW=e.stageWidth,t.SH=e.stageHeight,t.CW=t.SW>>1,t.CH=t.SH>>1,t.LW=window.innerWidth,t.LH=window.innerHeight},t.centerInParentX=function(e,i){void 0===i&&(i=null),e&&(i?e.x=i.width-e.width>>1:e.x=t.stage.stageWidth-e.width>>1)},t.centerInParentY=function(e,i){void 0===i&&(i=null),e&&(i?e.y=i.height-e.height>>1:e.y=t.stage.stageHeight-e.height>>1)},t.centerInParent=function(e,i,a,s){void 0===i&&(i=0),void 0===a&&(a=0),void 0===s&&(s=null),e&&(s?(e.x=(s.width-e.width>>1)+i,e.y=(s.height-e.height>>1)+a):(e.x=(t.stage.stageWidth-e.width>>1)+i,e.y=(t.stage.stageHeight-e.height>>1)+a))},t}();__reflect(StageUtils.prototype,"StageUtils");var ChangeIDPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.show=function(){var t=new egret.Shape;t.graphics.beginFill(0,.7),t.graphics.drawRect(0,0,StageUtils.stage.stageWidth,StageUtils.stage.stageHeight),t.graphics.endFill(),this.addChildAt(t,0),t.alpha=0,Global.fadeIn(t),UIManager.instance.popLayer.addChild(this),this.touchEnabled=!0},e.prototype.setData=function(e){t.prototype.setData.call(this,e);var i=Global.createBitmapByName("change_id_png");i.x=StageUtils.SW-i.width>>1,i.y=StageUtils.SH-i.height>>1,this.addChild(i);var a=Global.createBitmapByName("btn_change_close_png");a.x=515,a.y=210,this.addChild(a),Global.setBut(a),a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeHandler,this);var s=Global.createBitmapByName("btn_change_submit_png");s.x=StageUtils.SW-s.width>>1,s.y=(StageUtils.SH-s.height>>1)+195,this.addChild(s),Global.setBut(s),s.addEventListener(egret.TouchEvent.TOUCH_TAP,this.submitHandler,this),this.btnSubmit=s,this.txtID=new egret.TextField,this.txtID.width=270,this.txtID.fontFamily="微软雅黑",this.txtID.type=egret.TextFieldType.INPUT,this.txtID.x=240,this.txtID.y=375,this.txtID.text="请输入原用户名",this.txtID.size=24,this.txtID.textColor=12830150,this.txtID.maxChars=20,this.addChild(this.txtID),this.txtID.addEventListener(egret.FocusEvent.FOCUS_IN,this.idFocusInHandler,this),this.txtID.addEventListener(egret.FocusEvent.FOCUS_OUT,this.idFocusOutHandler,this),this.txtPW=new egret.TextField,this.txtPW.width=270,this.txtPW.fontFamily="微软雅黑",this.txtPW.type=egret.TextFieldType.INPUT,this.txtPW.x=240,this.txtPW.y=450,this.txtPW.text="请输入密码",this.txtPW.size=24,this.txtPW.textColor=12830150,this.txtPW.maxChars=20,this.txtPW.inputType=egret.TextFieldInputType.PASSWORD,this.addChild(this.txtPW),this.txtPW.addEventListener(egret.FocusEvent.FOCUS_IN,this.pwFocusInHandler,this),this.txtPW.addEventListener(egret.FocusEvent.FOCUS_OUT,this.pwFocusOutHandler,this),this.txtNewID=new egret.TextField,this.txtNewID.width=270,this.txtNewID.fontFamily="微软雅黑",this.txtNewID.type=egret.TextFieldType.INPUT,this.txtNewID.x=240,this.txtNewID.y=568,this.txtNewID.text="请输入新用户名",this.txtNewID.size=24,this.txtNewID.textColor=12830150,this.txtNewID.maxChars=20,this.addChild(this.txtNewID),this.txtNewID.addEventListener(egret.FocusEvent.FOCUS_IN,this.newIDFocusInHandler,this),this.txtNewID.addEventListener(egret.FocusEvent.FOCUS_OUT,this.newIDFocusOutHandler,this)},e.prototype.idFocusInHandler=function(){"请输入原用户名"==this.txtID.text&&(this.txtID.text="")},e.prototype.idFocusOutHandler=function(){""==this.txtID.text&&(this.txtID.text="请输入原用户名")},e.prototype.pwFocusInHandler=function(){"请输入密码"==this.txtPW.text?(this.txtPW.text="",this.txtPW.displayAsPassword=!0):this.txtPW.displayAsPassword=!1},e.prototype.pwFocusOutHandler=function(){""==this.txtPW.text?(this.txtPW.text="请输入密码",this.txtPW.displayAsPassword=!1):this.txtPW.displayAsPassword=!0},e.prototype.newIDFocusInHandler=function(){"请输入新用户名"==this.txtNewID.text&&(this.txtNewID.text="")},e.prototype.newIDFocusOutHandler=function(){""==this.txtNewID.text&&(this.txtNewID.text="请输入新用户名")},e.prototype.closeHandler=function(){PopManager.hidePop("ChangeIDPop")},e.prototype.submitHandler=function(){var t=this.txtID.text.trim(),e=this.txtPW.text.trim(),i=this.txtNewID.text.trim();if(t&&"请输入原用户名"!=t)if(e&&"请输入密码"!=e)if(i&&"请输入新用户名"!=i)if(i==t)Message.show("新用户名不得与原用户名相同!");else{var a=this;$.ajax({url:Main.USER_INFO_API,data:{type:"modifyinfo",ticket:Main.USER_TICKET,oldname:t,oldpassword:e,newname:i,newpassword:e},success:function(t){0==t.result?a.showResult(!0):1==t.result?Message.show("用户名或密码错误!"):2==t.result?Message.show("用户名或密码错误!"):3==t.result?Message.show("该用户名已被使用!"):4==t.result?Message.show("很抱歉，您不能修改用户名!"):Message.show("系统异常:"+t.result)},error:function(){},timeout:8e3,dataType:"json",async:!0,type:"POST",complete:function(t,e){"timeout"==e&&PopManager.showPop("ErrorPop",{url:"resource/assets/asyn/error/error_web.png"})}})}else Message.show("请输入新用户名!");else Message.show("请输入密码!");else Message.show("请输入原用户名!")},e.prototype.showResult=function(t){this.btnSubmit.visible=!1;var e="";e=t?"change_ok_png":"change_no_png";var i=Global.createBitmapByName(e);i.x=StageUtils.SW-i.width>>1,i.y=this.btnSubmit.y+10,this.addChild(i)},e}(PopView);__reflect(ChangeIDPop.prototype,"ChangeIDPop");var ChangePWPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.show=function(){var t=new egret.Shape;t.graphics.beginFill(0,.7),t.graphics.drawRect(0,0,StageUtils.stage.stageWidth,StageUtils.stage.stageHeight),t.graphics.endFill(),this.addChildAt(t,0),t.alpha=0,Global.fadeIn(t),UIManager.instance.popLayer.addChild(this),this.touchEnabled=!0},e.prototype.setData=function(e){t.prototype.setData.call(this,e);var i=Global.createBitmapByName("change_pd_png");i.x=StageUtils.SW-i.width>>1,i.y=StageUtils.SH-i.height>>1,this.addChild(i);var a=Global.createBitmapByName("btn_change_close_png");a.x=515,a.y=200,this.addChild(a),Global.setBut(a),a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeHandler,this);var s=Global.createBitmapByName("btn_change_submit_png");s.x=StageUtils.SW-s.width>>1,s.y=(StageUtils.SH-s.height>>1)+210,this.addChild(s),Global.setBut(s),s.addEventListener(egret.TouchEvent.TOUCH_TAP,this.submitHandler,this),this.btnSubmit=s,this.txtID=new egret.TextField,this.txtID.width=270,this.txtID.fontFamily="微软雅黑",this.txtID.type=egret.TextFieldType.INPUT,this.txtID.x=260,this.txtID.y=357,this.txtID.text="请输入用户名",this.txtID.size=24,this.txtID.textColor=12830150,this.txtID.maxChars=20,this.addChild(this.txtID),this.txtID.addEventListener(egret.FocusEvent.FOCUS_IN,this.idFocusInHandler,this),this.txtID.addEventListener(egret.FocusEvent.FOCUS_OUT,this.idFocusOutHandler,this),this.txtPW=new egret.TextField,this.txtPW.width=270,this.txtPW.fontFamily="微软雅黑",this.txtPW.type=egret.TextFieldType.INPUT,this.txtPW.x=260,this.txtPW.y=427,this.txtPW.text="请输入原密码",this.txtPW.size=24,this.txtPW.textColor=12830150,this.txtPW.maxChars=20,this.txtPW.inputType=egret.TextFieldInputType.PASSWORD,this.addChild(this.txtPW),this.txtPW.addEventListener(egret.FocusEvent.FOCUS_IN,this.pwFocusInHandler,this),this.txtPW.addEventListener(egret.FocusEvent.FOCUS_OUT,this.pwFocusOutHandler,this),this.txtNewPW=new egret.TextField,this.txtNewPW.width=270,this.txtNewPW.fontFamily="微软雅黑",this.txtNewPW.type=egret.TextFieldType.INPUT,this.txtNewPW.x=260,this.txtNewPW.y=522,this.txtNewPW.text="请输入新密码",this.txtNewPW.size=24,this.txtNewPW.textColor=12830150,this.txtNewPW.maxChars=20,this.txtNewPW.inputType=egret.TextFieldInputType.PASSWORD,this.addChild(this.txtNewPW),this.txtNewPW.addEventListener(egret.FocusEvent.FOCUS_IN,this.newIDFocusInHandler,this),this.txtNewPW.addEventListener(egret.FocusEvent.FOCUS_OUT,this.newIDFocusOutHandler,this),this.txtNewPW1=new egret.TextField,this.txtNewPW1.width=270,this.txtNewPW1.fontFamily="微软雅黑",this.txtNewPW1.type=egret.TextFieldType.INPUT,this.txtNewPW1.x=260,this.txtNewPW1.y=598,this.txtNewPW1.text="请再次输入新密码",this.txtNewPW1.size=24,this.txtNewPW1.textColor=12830150,this.txtNewPW1.maxChars=20,this.txtNewPW1.inputType=egret.TextFieldInputType.PASSWORD,this.addChild(this.txtNewPW1),this.txtNewPW1.addEventListener(egret.FocusEvent.FOCUS_IN,this.newID1FocusInHandler,this),this.txtNewPW1.addEventListener(egret.FocusEvent.FOCUS_OUT,this.newID1FocusOutHandler,this)},e.prototype.idFocusInHandler=function(){"请输入用户名"==this.txtID.text&&(this.txtID.text="")},e.prototype.idFocusOutHandler=function(){""==this.txtID.text&&(this.txtID.text="请输入用户名")},e.prototype.pwFocusInHandler=function(){"请输入原密码"==this.txtPW.text?(this.txtPW.text="",this.txtPW.displayAsPassword=!0):this.txtPW.displayAsPassword=!1},e.prototype.pwFocusOutHandler=function(){""==this.txtPW.text?(this.txtPW.text="请输入原密码",this.txtPW.displayAsPassword=!1):this.txtPW.displayAsPassword=!0},e.prototype.newIDFocusInHandler=function(){"请输入新密码"==this.txtNewPW.text?(this.txtNewPW.text="",this.txtNewPW.displayAsPassword=!0):this.txtNewPW.displayAsPassword=!1
},e.prototype.newIDFocusOutHandler=function(){""==this.txtNewPW.text?(this.txtNewPW.text="请输入新密码",this.txtNewPW.displayAsPassword=!1):this.txtNewPW.displayAsPassword=!0},e.prototype.newID1FocusInHandler=function(){"请再次输入新密码"==this.txtNewPW1.text?(this.txtNewPW1.text="",this.txtNewPW1.displayAsPassword=!0):this.txtNewPW1.displayAsPassword=!1},e.prototype.newID1FocusOutHandler=function(){""==this.txtNewPW1.text?(this.txtNewPW1.text="请再次输入新密码",this.txtNewPW1.displayAsPassword=!1):this.txtNewPW1.displayAsPassword=!0},e.prototype.closeHandler=function(){PopManager.hidePop("ChangePWPop")},e.prototype.submitHandler=function(){var t=this.txtID.text.trim(),e=this.txtPW.text.trim(),i=this.txtNewPW.text.trim(),a=this.txtNewPW1.text.trim();if(t&&"请输入用户名"!=t)if(e&&"请输入原密码"!=e)if(i&&"请输入新密码"!=i)if(a&&"请再次输入新密码"!=a)if(i!=a)Message.show("两次密码不一致!");else if(e==i)Message.show("新密码不得与原密码相同!");else{var s=this;$.ajax({url:Main.USER_INFO_API,data:{type:"modifyinfo",ticket:Main.USER_TICKET,oldname:t,oldpassword:e,newname:t,newpassword:i},success:function(t){0==t.result?s.showResult(!0):1==t.result?Message.show("用户名或密码错误!"):2==t.result?Message.show("用户名或密码错误!"):Message.show("系统异常:"+t.result)},error:function(){},timeout:8e3,dataType:"json",async:!0,type:"POST",complete:function(t,e){"timeout"==e&&PopManager.showPop("ErrorPop",{url:"resource/assets/asyn/error/error_web.png"})}})}else Message.show("请再次输入新密码!");else Message.show("请输入新密码!");else Message.show("请输入原密码!");else Message.show("请输入用户名!")},e.prototype.showResult=function(t){this.btnSubmit.visible=!1;var e="";e=t?"change_ok_png":"change_no_png";var i=Global.createBitmapByName(e);i.x=StageUtils.SW-i.width>>1,i.y=this.btnSubmit.y+10,this.addChild(i)},e}(PopView);__reflect(ChangePWPop.prototype,"ChangePWPop");var ConfimPayItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setData=function(t){this.data=t,this.graphics.beginFill(14606046),this.graphics.drawRect(0,0,600,133),this.graphics.endFill();var e=new egret.TextField;e.x=30,e.y=30,e.textColor=469575,this.addChild(e);var i=new egret.TextField;i.x=250,i.y=30,i.textColor=16730368,this.addChild(i);var a=new egret.TextField;a.x=30,a.y=80,a.textColor=469575,a.text="小计：",a.size=24,this.addChild(a);var s=new egret.TextField;s.x=100,s.y=80,s.textColor=16730368,s.size=24,this.addChild(s),this.len=t.length,this.price=0;for(var o="",n=0;n<this.len;n++)this.price+=Math.floor(100*t[n].disprice)/100,o=t[n].name,console.log(this.price);e.text=o+"",i.text="X"+this.len,s.text="￥"+this.price;var r=Global.createBitmapByName("btn_detail_png");r.x=this.width-r.width-30,r.y=46,this.addChild(r),Global.setBut(r),r.addEventListener(egret.TouchEvent.TOUCH_TAP,this.detailHandler,this)},e.prototype.detailHandler=function(){this.data&&PopManager.showPop("PayDetailPop",this.data)},e}(egret.Sprite);__reflect(ConfimPayItem.prototype,"ConfimPayItem");var ConfimPayPop=function(_super){function ConfimPayPop(){var t=_super.call(this)||this;return t.allCount=0,t.allPrice=0,t.idList=[],t.dic={},t}return __extends(ConfimPayPop,_super),ConfimPayPop.prototype.setData=function(t){_super.prototype.setData.call(this,t);var e=new egret.Shape;e.graphics.beginFill(16777215),e.graphics.drawRect(0,0,StageUtils.SW,StageUtils.SH),e.graphics.endFill(),this.addChild(e);var i=Global.createBitmapByName("confim_order_title_png");i.x=StageUtils.SW-i.width>>1,i.y=40,this.addChild(i);for(var a=t.length,s=0;a>s;s++){var o=t[s];o&&(this.idList.push(o.id),this.dic[o.name]||(this.dic[o.name]=[]),this.dic[o.name].push(o))}a=this.dic.length;var n=0;for(var r in this.dic){var h=new ConfimPayItem;h.x=StageUtils.SW-600>>1,h.y=105+147*n,h.setData(this.dic[r]),this.addChild(h),n++,this.allCount+=h.len,this.allPrice+=h.price}var l=Global.createBitmapByName("down_bg_png");l.x=0,l.y=StageUtils.SH-l.height,this.addChild(l);var d=new egret.TextField;d.x=30,d.y=StageUtils.SH-55,d.text="总量:"+this.allCount+"盒",d.textColor=0,d.size=22,this.addChild(d);var p=new egret.TextField;p.x=180,p.y=StageUtils.SH-55,p.text="总计:",p.textColor=0,p.size=22,this.addChild(p);var c=new egret.TextField;c.x=230,c.y=StageUtils.SH-63,c.text="￥"+this.allPrice,c.textColor=16730368,c.size=33,this.addChild(c);var g=Global.createBitmapByName("btn_pay_1_png");g.x=StageUtils.SW-g.width,g.y=StageUtils.SH-g.height,this.addChild(g),Global.setBut(g),g.addEventListener(egret.TouchEvent.TOUCH_TAP,this.payTouchHandler,this)},ConfimPayPop.prototype.payTouchHandler=function(){var self=this;$.ajax({url:Main.PLAY_API,data:{ticket:Main.USER_TICKET,type:"pcoup",ids:this.idList.join(",")},success:function(data){if(0==data.result){var weixin=eval("wx");weixin.chooseWXPay({timestamp:data.timestemps,nonceStr:data.nonce_str,"package":"prepay_id="+data.prepay_id,signType:"MD5",paySign:data.sign,success:function(t){self.payResult(!0,data.payorder,self.data,self.allPrice)},fail:function(t){self.payResult(!1,data.payorder)},cancel:function(t){self.payResult(!1,data.payorder)}})}else PopManager.showPop("TipsPop",{url:"tips_error_png",callback:function(){PopManager.hidePop("ConfimPayPop"),PopManager.showPop("ListPop")}})},error:function(){},timeout:8e3,dataType:"json",async:!0,type:"POST",complete:function(t,e){"timeout"==e&&PopManager.showPop("ErrorPop",{url:"resource/assets/asyn/error/error_web.png"})}})},ConfimPayPop.prototype.payResult=function(t,e,i,a){void 0===i&&(i=null),void 0===a&&(a=null);$.ajax({url:Main.PLAY_API,data:{ticket:Main.USER_TICKET,type:"pwxcallback",payorder:e,issuccess:t?1:0,cardtype:"pcoup"},success:function(e){0==e.result?t?(PopManager.hidePop("ConfimPayPop"),PopManager.showPop("PayOKPop",{list:i,price:a})):PopManager.showPop("TipsPop",{url:"tips_error_png",callback:function(){PopManager.hidePop("ConfimPayPop"),PopManager.showPop("ListPop")}}):Message.show("系统异常:"+e.result)},error:function(){},timeout:8e3,dataType:"json",async:!0,type:"POST",complete:function(t,e){"timeout"==e&&PopManager.showPop("ErrorPop",{url:"resource/assets/asyn/error/error_web.png"})}})},ConfimPayPop}(PopView);__reflect(ConfimPayPop.prototype,"ConfimPayPop");var PayDetailItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setData=function(t){var e=new egret.Shape;e.graphics.beginFill(0,.001),e.graphics.drawRect(0,0,510,100),e.graphics.endFill(),this.addChild(e);var i=new egret.TextField;i.x=0,i.y=0,i.textColor=0,this.addChild(i);var a=new egret.TextField;a.x=200,a.y=0,a.textColor=0,this.addChild(a);var s=new egret.TextField;s.x=330,s.y=0,s.textColor=0,s.width=120,s.textAlign=egret.HorizontalAlign.CENTER,this.addChild(s),i.text=t.name+"",a.text=t.batchcode1+"",s.text=Math.floor(100*t.disprice)/100+""},e}(egret.DisplayObjectContainer);__reflect(PayDetailItem.prototype,"PayDetailItem");var PayDetailPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.show=function(){var t=new egret.Shape;t.graphics.beginFill(0,.7),t.graphics.drawRect(0,0,StageUtils.stage.stageWidth,StageUtils.stage.stageHeight),t.graphics.endFill(),this.addChildAt(t,0),t.alpha=0,Global.fadeIn(t),UIManager.instance.popLayer.addChild(this),this.touchEnabled=!0},e.prototype.setData=function(e){t.prototype.setData.call(this,e);var i=new CustomImage("resource/assets/asyn/pop_bg.png",!0,function(){i.x=StageUtils.SW-i.width>>1,i.y=StageUtils.SH-i.height>>1});this.addChild(i);var a=Global.createBitmapByName("detail_title_png");a.x=StageUtils.SW-a.width>>1,a.y=195,this.addChild(a);var s=Global.createBitmapByName("btn_change_close_png");s.x=530,s.y=100,this.addChild(s);var o=new egret.DisplayObjectContainer,n=new egret.ScrollView(o);n.width=510,n.height=580,n.x=100,n.y=270,this.addChild(n);for(var r=e.length,h=0;r>h;h++){var l=new PayDetailItem;l.setData(e[h]),l.x=0,l.y=30+100*h,o.addChild(l)}this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandler,this)},e.prototype.touchHandler=function(t){var e=t.target;e==this&&PopManager.hidePop("PayDetailPop")},e}(PopView);__reflect(PayDetailPop.prototype,"PayDetailPop");var ListItem=function(t){function e(){var e=t.call(this)||this;e._select=!1;var i=new egret.Shape;return i.graphics.beginFill(16382457),i.graphics.drawRect(0,0,StageUtils.SW,97),i.graphics.endFill(),e.addChild(i),e.txtCount=new egret.TextField,e.txtCount.fontFamily="微软雅黑",e.txtCount.textColor=469575,e.txtCount.text="库存紧张",e.txtCount.width=50,e.txtCount.size=19,e.txtCount.x=20,e.txtCount.y=28,e.addChild(e.txtCount),e.imgCheck=Global.createBitmapByName("check_no_png"),e.imgCheck.x=80,e.imgCheck.y=38,e.addChild(e.imgCheck),e.txtName=new egret.TextField,e.txtName.textColor=469575,e.txtName.fontFamily="微软雅黑",e.txtName.text="金秋福运",e.txtName.x=110,e.txtName.y=35,e.txtName.size=27,e.addChild(e.txtName),e.txtCode=new egret.TextField,e.txtCode.textColor=5528422,e.txtCode.fontFamily="微软雅黑",e.txtCode.text="8K98",e.txtCode.x=315,e.txtCode.y=35,e.txtCode.size=24,e.addChild(e.txtCode),e.txtPrice=new egret.TextField,e.txtPrice.textColor=469575,e.txtPrice.fontFamily="微软雅黑",e.txtPrice.text="998",e.txtPrice.x=380,e.txtPrice.y=35,e.txtPrice.size=24,e.txtPrice.width=110,e.txtPrice.textAlign=egret.HorizontalAlign.CENTER,e.addChild(e.txtPrice),e.txtRate=new egret.TextField,e.txtRate.textColor=16730368,e.txtRate.fontFamily="微软雅黑",e.txtRate.text="7折",e.txtRate.x=490,e.txtRate.y=35,e.txtRate.size=24,e.addChild(e.txtRate),e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_TAP,e.touchHandler,e),e}return __extends(e,t),e.prototype.touchHandler=function(){this.data&&(0!=this.data.status?Message.show("已经购买过"):this.data.rest?(this.select=!this.select,this.select||GameDispatcher.instance.dispatchEventWith("item_cancel")):Message.show("库存不足"))},Object.defineProperty(e.prototype,"select",{get:function(){return this.data&&this.data.rest?this._select:!1},set:function(t){this._select=t,this._select?this.imgCheck.texture=RES.getRes("check_ok_png"):this.imgCheck.texture=RES.getRes("check_no_png")},enumerable:!0,configurable:!0}),e.prototype.setData=function(t){this.data=t,this.txtName.text=t.name+"",this.txtPrice.text="￥"+t.price,this.txtCode.text=t.batchcode1+"",this.txtRate.text=t.discount+"折/￥"+Math.floor(100*t.disprice)/100,0==t.rest?(this.txtCount.text="库存不足",this.txtCount.textColor=6710886):t.rest>5?(this.txtCount.text="库存充足",this.txtCount.textColor=26795):(this.txtCount.textColor=16662101,this.txtCode.text="库存紧张"),0!=t.status?this.filters=Global.grayFlilter:this.filters=[],1==t.ischecked&&(this.select=!0)},e}(egret.DisplayObjectContainer);__reflect(ListItem.prototype,"ListItem");var ListPop=function(_super){function ListPop(){var t=_super.call(this)||this;return t.itemList=[],t.isAllSelect=!1,t}return __extends(ListPop,_super),ListPop.prototype.setData=function(t){_super.prototype.setData.call(this,t);var e=Global.createBitmapByName("list_title_png");e.x=StageUtils.SW-e.width>>1,e.y=0,this.addChild(e);var i=Global.createBitmapByName("btn_help_png");i.x=20,i.y=38,this.addChild(i),Global.setBut(i),i.addEventListener(egret.TouchEvent.TOUCH_TAP,this.helpHandler,this);var a=Global.createBitmapByName("btn_continue_png");a.x=46,a.y=StageUtils.SH-a.height-50,this.addChild(a),Global.setBut(a);var s=Global.createBitmapByName("btn_pay_png");s.x=StageUtils.SW-s.width-44,s.y=StageUtils.SH-s.height-50,this.addChild(s),Global.setBut(s);var o=Global.createBitmapByName("btn_logout_png");o.x=StageUtils.SW-o.width>>1,o.y=StageUtils.SH-50,this.addChild(o),Global.setBut(o),a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.containerHandler,this),s.addEventListener(egret.TouchEvent.TOUCH_TAP,this.payHandler,this),o.addEventListener(egret.TouchEvent.TOUCH_TAP,this.logoutHandler,this),this.container=new egret.DisplayObjectContainer;var n=new egret.ScrollView;n.setContent(this.container),n.horizontalScrollPolicy="off",n.scrollSpeed=.5,this.addChild(n),n.x=0,n.y=93,n.width=StageUtils.SW,n.height=700,this.allSelect=new egret.Sprite,this.allSelect.x=127,this.allSelect.y=StageUtils.SH-220,this.addChild(this.allSelect),this.allSelect.touchEnabled=!0,this.allSelect.addEventListener(egret.TouchEvent.TOUCH_TAP,this.allSelectHandler,this),this.imgSelect=Global.createBitmapByName("check_no_png"),this.allSelect.addChild(this.imgSelect),this.txtSelect=new egret.TextField,this.txtSelect.textColor=2964310,this.txtSelect.text="全选",this.txtSelect.size=26,this.txtSelect.x=35,this.allSelect.addChild(this.txtSelect),this.allSelect.graphics.beginFill(15132390),this.allSelect.graphics.drawRect(0,0,this.allSelect.width,this.allSelect.height),this.allSelect.graphics.endFill();var r=new egret.TextField;r.text="注意：本月饼券暂不支持西藏、青海和新疆地区兑换收货",r.textColor=16662101,r.size=18,r.x=StageUtils.SW-r.width>>1,r.y=850,this.addChild(r),GameDispatcher.instance.addEventListener("item_cancel",this.itemCancel,this),this.getData()},ListPop.prototype.itemCancel=function(){this.isAllSelect=!1,this.imgSelect.texture=RES.getRes("check_no_png")},ListPop.prototype.helpHandler=function(){PopManager.showPop("TipsPop",{url:"tips_bg_png",callback:function(){}})},ListPop.prototype.allSelectHandler=function(){this.isAllSelect=!this.isAllSelect,this.isAllSelect?this.imgSelect.texture=RES.getRes("check_ok_png"):this.imgSelect.texture=RES.getRes("check_no_png");for(var t=this.itemList.length,e=0;t>e;e++){var i=this.itemList[e];i&&i.data.rest&&0==i.data.status&&(i.select=this.isAllSelect)}},ListPop.prototype.logoutHandler=function(){$.ajax({url:Main.USER_INFO_API,data:{type:"logout",ticket:Main.USER_TICKET},success:function(t){0==t.result?(PopManager.hidePop("ListPop"),PopManager.showPop("LoginPop")):Message.show("系统异常:"+t.result)},error:function(){},timeout:8e3,dataType:"json",async:!0,type:"POST",complete:function(t,e){"timeout"==e&&PopManager.showPop("ErrorPop",{url:"resource/assets/asyn/error/error_web.png"})}})},ListPop.prototype.containerHandler=function(){console.log("sdsfsd");var self=this,weixin=eval("wx");weixin.scanQRCode({needResult:1,scanType:["qrCode","barCode"],success:function(t){var e=t.resultStr,i=e.split("/");self.getDataByCode("h/"+i[i.length-1])},fail:function(t){alert(JSON.stringify(t))}})},ListPop.prototype.payHandler=function(){for(var t=[],e=this.itemList.length,i=0;e>i;i++){var a=this.itemList[i];a&&a.select&&t.push(a.data)}t.length?(PopManager.hidePop("ListPop"),PopManager.showPop("ConfimPayPop",t)):Message.show("请勾选要购买的物品!")},ListPop.prototype.refreshData=function(t){this.itemList.length=0,this.container.removeChildren();for(var e=t.length,i=0;e>i;i++){var a=new ListItem;if(a.y=100*i,a.setData(t[i]),this.container.addChildAt(a,0),this.itemList.push(a),9==i){var s=Global.createBitmapByName("list_line2_png");s.x=0,s.y=100*i+89,this.container.addChildAt(s,1)}}},ListPop.prototype.getData=function(){var t=this;$.ajax({url:Main.USER_INFO_API,data:{type:"info",ticket:Main.USER_TICKET},success:function(e){0==e.result?t.refreshData(e.list):Message.show(e.result)},error:function(){},timeout:8e3,dataType:"json",async:!0,type:"POST",complete:function(t,e){}})},ListPop.prototype.getDataByCode=function(t){var e=this;$.ajax({url:Main.USER_INFO_API,data:{type:"scan",ticket:Main.USER_TICKET,code:t},success:function(t){0==t.result?e.refreshData(t.list):1==t.result?Message.show("已支付!"):Message.show(t.result)},error:function(){},timeout:8e3,dataType:"json",async:!0,type:"POST",complete:function(t,e){"timeout"==e&&PopManager.showPop("ErrorPop",{url:"resource/assets/asyn/error/error_web.png"})}})},ListPop}(PopView);__reflect(ListPop.prototype,"ListPop");var CustomScrollView=function(t){function e(e,i,a){void 0===e&&(e=null),void 0===i&&(i=0),void 0===a&&(a=0);var s=t.call(this,e)||this;return s.offset=i,s.gap=a,s}return __extends(e,t),e.prototype.setScrollLeft=function(e,i){if(void 0===i&&(i=0),console.log(e,this.getMaxScrollLeft()),e<-50+this.gap/2)e=-50;else if(e>50+this.getMaxScrollLeft()-this.gap/2)e=50+this.getMaxScrollLeft();else{var a=Math.round((e-50)/this.gap);console.log(a),e=a*this.gap}t.prototype.setScrollLeft.call(this,e,i)},e}(egret.ScrollView);__reflect(CustomScrollView.prototype,"CustomScrollView");var PayOKPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setData=function(e){t.prototype.setData.call(this,e);var i=new CustomImage("resource/assets/asyn/pay_complete_bg.png",!0,function(){i.width=StageUtils.SW,i.height=StageUtils.SH});this.addChild(i);var a=Global.createBitmapByName("btn_complete_png");a.x=StageUtils.SW-a.width>>1,a.y=300,this.addChild(a),Global.setBut(a),a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btnHandler,this);var s=new egret.TextField;s.width=400,s.textAlign=egret.HorizontalAlign.CENTER,s.x=StageUtils.SW-400>>1,s.y=175,s.textColor=16777215,s.size=40,this.addChild(s),s.text="￥"+e.price,this.htmlCode=new QRCode("resource/assets/asyn/pay_send_ok_code.png"),this.htmlCode.setPosition(70,433,171,175),this.htmlCode.showHtmlCode()},e.prototype.btnHandler=function(){this.data&&(this.htmlCode.destroy(),PopManager.hidePop("PayOKPop"),PopManager.showPop("SelectListPop",this.data.list))},e}(PopView);__reflect(PayOKPop.prototype,"PayOKPop");var SelectListItem=function(t){function e(){var e=t.call(this)||this,i=new egret.Shape;return i.graphics.beginFill(16382457),i.graphics.drawRect(0,0,StageUtils.SW,97),i.graphics.lineStyle(1,0),i.graphics.moveTo(0,97),i.graphics.lineTo(StageUtils.SW,97),i.graphics.endFill(),e.addChild(i),e.txtName=new egret.TextField,e.txtName.textColor=469575,e.txtName.fontFamily="微软雅黑",e.txtName.text="金秋福运",e.txtName.x=15,e.txtName.y=32,e.txtName.size=27,e.addChild(e.txtName),e.txtCode=new egret.TextField,e.txtCode.textColor=5528422,e.txtCode.fontFamily="微软雅黑",e.txtCode.text="8K98",e.txtCode.x=225,e.txtCode.y=35,e.txtCode.size=24,e.addChild(e.txtCode),e.txtPrice=new egret.TextField,e.txtPrice.textColor=16730368,e.txtPrice.fontFamily="微软雅黑",e.txtPrice.text="998",e.txtPrice.x=300,e.txtPrice.y=35,e.txtPrice.size=24,e.txtPrice.width=110,e.txtPrice.textAlign=egret.HorizontalAlign.CENTER,e.addChild(e.txtPrice),e.txtRate=new egret.TextField,e.txtRate.textColor=469575,e.txtRate.fontFamily="微软雅黑",e.txtRate.text="7折",e.txtRate.x=425,e.txtRate.y=35,e.txtRate.size=24,e.addChild(e.txtRate),e.txtStatus=new egret.TextField,e.txtStatus.textColor=1270430,e.txtStatus.fontFamily="微软雅黑",e.txtStatus.text="已付款",e.txtStatus.x=StageUtils.SW-135,e.txtStatus.y=35,e.txtStatus.width=120,e.txtStatus.size=24,e.txtStatus.textAlign=egret.HorizontalAlign.CENTER,e.addChild(e.txtStatus),e}return __extends(e,t),e.prototype.setData=function(t){this.txtName.text=t.name+"",this.txtPrice.text="￥"+t.price,this.txtCode.text=t.batchcode1+"",this.txtRate.text=t.discount+"折",this.txtStatus.textColor=1270430,this.txtStatus.text="已付款"},e}(egret.DisplayObjectContainer);__reflect(SelectListItem.prototype,"SelectListItem");var CustomCheckBox=function(t){function e(e,i,a){void 0===a&&(a=0);var s=t.call(this)||this;return s.type=e,s.text=i,s.select=a,s.init(),s}return __extends(e,t),e.prototype.init=function(){console.log(),this.icon=Global.createBitmapByName("cbx_"+this.type+"_"+this.select+"_png"),this.addChild(this.icon),this.txtContent=new egret.TextField,this.txtContent.x=50,this.txtContent.text=this.text,this.addChild(this.txtContent),this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickHandler,this)},e.prototype.clickHandler=function(){this.change(),this.dispatchEventWith(egret.Event.CHANGE)},e.prototype.setSelect=function(t){this.select=t,this.icon.texture=RES.getRes("cbx_"+this.type+"_"+this.select+"_png")},e.prototype.change=function(){this.setSelect(0==this.select?1:0)},e}(egret.DisplayObjectContainer);__reflect(CustomCheckBox.prototype,"CustomCheckBox");var ErrorPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setData=function(e){t.prototype.setData.call(this,e);var i=new CustomImage(e.url,!0,function(){i.x=StageUtils.SW-i.width>>1,i.y=StageUtils.SH-i.height>>1});this.addChild(i),e.qr&&(this.htmlCode=new QRCode("resource/assets/asyn/pay_send_ok_code.png"),this.htmlCode.setPosition(e.x,e.y,125,127),this.htmlCode.showHtmlCode())},e}(PopView);__reflect(ErrorPop.prototype,"ErrorPop");var GameView=function(t){function e(){var e=t.call(this)||this;return PopManager.showPop("SelectListPop"),e}return __extends(e,t),e}(egret.DisplayObjectContainer);__reflect(GameView.prototype,"GameView");var AddressPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setData=function(e){t.prototype.setData.call(this,e);var i=new CustomImage("resource/assets/asyn/address_bg.png",!0,function(){i.width=StageUtils.SW,i.height=StageUtils.SH});if(this.addChild(i),e.sharelist){var a=new egret.DisplayObjectContainer;this.addChild(a);var s=e.sharelist.length,o=[];for(n=0;s>n;n++)e.sharelist[n]&&o.push(e.sharelist[n]);s=o.length;for(var n=0;s>n;n++){var r=o[n];if(r){var h=new CustomImage("resource/assets/asyn/moontype/7/"+(n+1)+".png",!0,function(){});if(h.x=0,h.y=60*n,a.addChild(h),n!=s-1){var l=Global.createBitmapByName("p_line_1_png");l.x=0,l.y=52+60*n,a.addChild(l)}var d=new egret.TextField;d.textColor=16758400,d.size=24,d.x=315,d.y=16+60*n,d.text="X"+r,a.addChild(d)}}console.log(a.height,a.width),a.x=StageUtils.SW-350>>1,a.y=115+(189-a.height>>1)}else{var p=new CustomImage("resource/assets/asyn/moontype/2/"+e.ptype+".png",!0,function(){p.x=StageUtils.SW-p.width>>1,p.y=84});this.addChild(p)}this.btnDuihuan=Global.createBitmapByName("btn_submit_png"),this.btnDuihuan.x=StageUtils.SW-this.btnDuihuan.width>>1,this.btnDuihuan.y=StageUtils.SH-310,this.addChild(this.btnDuihuan),Global.setBut(this.btnDuihuan),this.btnDuihuan.touchEnabled=!0,this.btnDuihuan.addEventListener(egret.TouchEvent.TOUCH_TAP,this.duihuanHandler,this);var c=Global.createBitmapByName("address_png");c.x=StageUtils.SW-c.width>>1,c.y=390,this.addChild(c),this.txtName=new egret.TextField,this.txtName.type=egret.TextFieldType.INPUT,this.txtName.x=200,this.txtName.y=385,this.txtName.width=380,this.txtName.height=50,this.txtName.maxChars=10,this.addChild(this.txtName),this.txtSheng=new egret.TextField,this.txtSheng.type=egret.TextFieldType.INPUT,this.txtSheng.x=160,this.txtSheng.y=456,this.txtSheng.width=300,this.txtSheng.height=50,this.txtSheng.maxChars=10,this.txtSheng.size=20,this.txtSheng.textAlign=egret.HorizontalAlign.CENTER,this.addChild(this.txtSheng),this.txtShi=new egret.TextField,this.txtShi.type=egret.TextFieldType.INPUT,this.txtShi.x=192,this.txtShi.y=519,this.txtShi.width=140,this.txtShi.height=50,this.txtShi.maxChars=10,this.txtShi.size=20,this.txtShi.textAlign=egret.HorizontalAlign.CENTER,this.addChild(this.txtShi),this.txtXian=new egret.TextField,this.txtXian.type=egret.TextFieldType.INPUT,this.txtXian.x=375,this.txtXian.y=519,this.txtXian.width=118,this.txtXian.height=50,this.txtXian.maxChars=10,this.txtXian.size=20,this.txtXian.textAlign=egret.HorizontalAlign.CENTER,this.addChild(this.txtXian),this.txtAddress=new egret.TextField,this.txtAddress.type=egret.TextFieldType.INPUT,this.txtAddress.x=254,this.txtAddress.y=577,this.txtAddress.width=317,this.txtAddress.height=50,this.txtAddress.maxChars=100,this.txtAddress.size=20,this.addChild(this.txtAddress),this.txtPhone=new egret.TextField,this.txtPhone.type=egret.TextFieldType.INPUT,this.txtPhone.x=200,this.txtPhone.y=640,this.txtPhone.width=350,this.txtPhone.height=50,this.txtPhone.maxChars=11,this.txtPhone.restrict="0-9",this.txtPhone.inputType=egret.TextFieldInputType.TEL,this.txtPhone.size=20,this.addChild(this.txtPhone);var g=new egret.TextField;g.textColor=16662101,g.text="注：西藏、青海、新疆暂不支持兑换收货。",g.size=20,g.x=StageUtils.SW-g.width>>1,g.y=680,this.addChild(g);var u=Global.createBitmapByName("btn_info_png");u.x=StageUtils.SW-u.width-20,u.y=20,this.addChild(u),Global.setBut(u),u.addEventListener(egret.TouchEvent.TOUCH_TAP,this.infoHandler,this)},e.prototype.infoHandler=function(){PopManager.hidePop("AddressPop"),PopManager.showPop("InfoPop")},e.prototype.duihuanHandler=function(){var t=this.txtName.text.trim(),e=this.txtSheng.text.trim(),i=this.txtShi.text.trim(),a=this.txtXian.text.trim(),s=this.txtAddress.text.trim(),o=this.txtPhone.text.trim();if(t)if(e)if(-1!=e.indexOf("西藏")||-1!=e.indexOf("青海")||-1!=e.indexOf("新疆"))Message.show("西藏、青海和新疆暂不支持兑换收货!");else if(i)if(a)if(s)if(o)if(11!=o.length)Message.show("电话号码 必须11位!");else{var n=new ConfirmAddress;this.addChild(n),n.btnOK.touchEnabled=!0,n.btnOK.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){var n="",r="";0==this.data.type?(n="exchange",r=this.data.ptype):(n="eexchange",r=this.data.eshare?this.data.eshare:this.data.ptype);$.ajax({url:Main.USER_INFO_API,data:{type:n,ticket:Main.USER_TICKET,ptype:r,name:t,province:e,city:i,county:a,address:s,telephone:o},success:function(t){0==t.result?(PopManager.hidePop("AddressPop"),PopManager.showPop("OrderOKPop",t.exchangeorder)):Message.show("兑换失败:"+t.result)},error:function(){},timeout:8e3,dataType:"json",async:!0,type:"POST",complete:function(t,e){"timeout"==e&&PopManager.showPop("ErrorPop",{url:"resource/assets/asyn/error/error_web.png"})}})},this),n.btnBack.touchEnabled=!0,n.btnBack.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){this.removeChild(n)},this)}else Message.show("手机号码 不能为空!");else Message.show("详细地址 不能为空!");else Message.show("地址栏 县/区 不能为空!");else Message.show("地址栏 市 不能为空!");else Message.show("地址栏 省/直辖市 不能为空!");else Message.show("姓名 不能为空!")},e}(PopView);__reflect(AddressPop.prototype,"AddressPop");var BuySendOKPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setData=function(e){t.prototype.setData.call(this,e);var i=new CustomImage("resource/assets/asyn/pay_send_ok_bg.png",!0,function(){i.width=StageUtils.SW,i.height=StageUtils.SH});this.addChild(i);var a=Global.createBitmapByName("btn_share_3_png");a.x=StageUtils.SW-a.width>>1,a.y=300,this.addChild(a),Global.setBut(a),a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeHandler,this)},e.prototype.closeHandler=function(){PopManager.hidePop("BuySendOKPop"),PopManager.showPop("InfoPop",2)},e}(PopView);__reflect(BuySendOKPop.prototype,"BuySendOKPop");var BuySendPop=function(_super){function BuySendPop(){var t=_super.call(this)||this;return t.itemList=[],t.setData(),t}return __extends(BuySendPop,_super),BuySendPop.prototype.setData=function(){var t=Global.createBitmapByName("btn_buy_send_png");t.x=StageUtils.SW-t.width>>1,t.y=StageUtils.SH-115,this.addChild(t),Global.setBut(t),t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.duihuanHandler,this);var e=new egret.Shape;e.graphics.beginFill(16777215),e.graphics.drawRect(0,106,StageUtils.SW,StageUtils.SH-106-150),e.graphics.endFill(),this.addChild(e);var i=new egret.DisplayObjectContainer,a=new egret.ScrollView(i);a.width=StageUtils.SW,a.height=StageUtils.SH-130-150,a.x=0,a.y=130,a.horizontalScrollPolicy="off",this.addChild(a);for(var s=0;4>s;s++){var o=new BuySendItem(s+1);o.y=0+300*s,i.addChild(o),this.itemList.push(o)}var n=Global.createBitmapByName("p_line_2_png");n.x=0,n.y=StageUtils.SH-150-5,this.addChild(n)},BuySendPop.prototype.duihuanHandler=function(){var type1=this.itemList[0].num,type2=this.itemList[1].num,type3=this.itemList[2].num,type4=this.itemList[3].num;if(!(type1||type2||type3||type4))return void Message.show("没有选中的物品!");var self=this;$.ajax({url:Main.PLAY_API,data:{type:"ecoup",ticket:Main.USER_TICKET,type1:type1,type2:type2,type3:type3,type4:type4},success:function(data){if(0==data.result){var weixin=eval("wx");weixin.chooseWXPay({timestamp:data.timestemps,nonceStr:data.nonce_str,"package":"prepay_id="+data.prepay_id,signType:"MD5",paySign:data.sign,success:function(t){self.payResult(!0,data.payorder)},fail:function(t){self.payResult(!1,data.payorder)},cancel:function(t){self.payResult(!1,data.payorder)}})}else PopManager.showPop("TipsPop",{url:"tips_error_png",callback:function(){}})},error:function(){},timeout:8e3,dataType:"json",async:!0,type:"POST",complete:function(t,e){"timeout"==e&&PopManager.showPop("ErrorPop",{url:"resource/assets/asyn/error/error_web.png"})}})},BuySendPop.prototype.payResult=function(t,e){var i=this;$.ajax({url:Main.PLAY_API,data:{ticket:Main.USER_TICKET,type:"pwxcallback",payorder:e,issuccess:t?1:0,cardtype:"ecoup"},success:function(a){0==a.result&&t?i.share(e):PopManager.showPop("TipsPop",{url:"tips_error_png",callback:function(){}})},error:function(){},timeout:8e3,dataType:"json",async:!0,type:"POST",complete:function(t,e){"timeout"==e&&PopManager.showPop("ErrorPop",{url:"resource/assets/asyn/error/error_web.png"})}})},BuySendPop.prototype.share=function(t){$.ajax({url:Main.USER_INFO_API,data:{type:"eshare",ticket:Main.USER_TICKET,ptype:t},success:function(t){console.log("data.eshareinfo"),0==t.result?(Main.share("http://lsid.me/h/esharecode$eshareinfo="+t.eshareinfo),PopManager.hidePop("InfoPop"),PopManager.showPop("BuySendOKPop")):Message.show(t.result)},error:function(){},timeout:8e3,dataType:"json",async:!0,type:"POST",complete:function(t,e){"timeout"==e&&PopManager.showPop("ErrorPop",{url:"resource/assets/asyn/error/error_web.png"})}})},BuySendPop}(egret.DisplayObjectContainer);__reflect(BuySendPop.prototype,"BuySendPop");var ConfirmAddress=function(t){function e(){var e=t.call(this)||this;return e.confirmAddress(),e}return __extends(e,t),e.prototype.confirmAddress=function(){var t=Global.createBitmapByName("confirm_address_png");t.x=StageUtils.SW-t.width>>1,t.y=StageUtils.SH-t.height>>1,this.addChild(t),this.btnOK=Global.createBitmapByName("btn_OK_png"),this.btnOK.x=100,this.btnOK.y=580,this.addChild(this.btnOK),this.btnBack=Global.createBitmapByName("btn_back_png"),this.btnBack.x=330,this.btnBack.y=580,this.addChild(this.btnBack)},e}(egret.DisplayObjectContainer);__reflect(ConfirmAddress.prototype,"ConfirmAddress");var GetShareOKPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setData=function(e){t.prototype.setData.call(this,e);var i=new CustomImage("resource/assets/asyn/get_share_ok.png",!0,function(){i.width=StageUtils.SW,i.height=StageUtils.SH});this.addChild(i);var a=Global.createBitmapByName("btn_select_info_png");a.x=StageUtils.SW-a.width>>1,a.y=350,this.addChild(a),Global.setBut(a),a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.duihuanHandler,this);$.ajax({url:Main.USER_INFO_API,data:{type:"eshareget",ticket:Main.USER_TICKET,eshareinfo:this.data.payorder},success:function(t){},error:function(){},timeout:8e3,dataType:"json",async:!0,type:"POST",complete:function(t,e){"timeout"==e&&PopManager.showPop("ErrorPop",{url:"resource/assets/asyn/error/error_web.png"})}})},e.prototype.duihuanHandler=function(){PopManager.hidePop("GetShareOKPop"),PopManager.showPop("InfoPop")},e}(PopView);__reflect(GetShareOKPop.prototype,"GetShareOKPop");var HasGetBuyPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setData=function(e){t.prototype.setData.call(this,e);var i=new CustomImage("resource/assets/asyn/has_get_buy_bg.png",!0,function(){i.width=StageUtils.SW,i.height=StageUtils.SH});this.addChild(i);var a=Global.createBitmapByName("btn_buy_gift_png");a.x=StageUtils.SW-a.width>>1,a.y=450,this.addChild(a),Global.setBut(a),a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.duihuanHandler,this)},e.prototype.duihuanHandler=function(){PopManager.hidePop("HasGetBuyPop"),PopManager.showPop("InfoPop",3)},e}(PopView);__reflect(HasGetBuyPop.prototype,"HasGetBuyPop");var HasGetInfoPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setData=function(e){t.prototype.setData.call(this,e);var i=new CustomImage("resource/assets/asyn/has_get_info_bg.png",!0,function(){i.width=StageUtils.SW,i.height=StageUtils.SH});this.addChild(i);var a=Global.createBitmapByName("btn_select_info_png");a.x=StageUtils.SW-a.width>>1,a.y=350,this.addChild(a),Global.setBut(a),a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.duihuanHandler,this)},e.prototype.duihuanHandler=function(){PopManager.hidePop("HasGetInfoPop"),PopManager.showPop("InfoPop")},e}(PopView);__reflect(HasGetInfoPop.prototype,"HasGetInfoPop");var HasGetPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setData=function(e){t.prototype.setData.call(this,e);
var i=new CustomImage("resource/assets/asyn/error/error_yilingqu.png",!0,function(){i.width=StageUtils.SW,i.height=StageUtils.SH});this.addChild(i);var a=Global.createBitmapByName("btn_select_info_png");a.x=StageUtils.SW-a.width>>1,a.y=350,this.addChild(a),Global.setBut(a),a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.duihuanHandler,this)},e.prototype.duihuanHandler=function(){PopManager.hidePop("HasGetPop"),PopManager.showPop("InfoPop")},e}(PopView);__reflect(HasGetPop.prototype,"HasGetPop");var InfoPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setData=function(e){t.prototype.setData.call(this,e),e?this.index=e:this.index=1,this.tab1=new CustomTabButton("我的订单",213,105,28),this.tab1.x=0,this.tab1.y=0,this.addChild(this.tab1),this.tab2=new CustomTabButton("我的卡券",213,105,28),this.tab2.x=213,this.tab2.y=0,this.addChild(this.tab2),this.tab3=new CustomTabButton("购买卡券",214,105,28),this.tab3.x=426,this.tab3.y=0,this.addChild(this.tab3),1==this.index?(this.tab1.select=!0,this.tab2.select=!1,this.tab3.select=!1):2==this.index?(this.tab1.select=!1,this.tab2.select=!0,this.tab3.select=!1):(this.tab1.select=!1,this.tab2.select=!1,this.tab3.select=!0),this.tab1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.tabTouchHandler,this),this.tab2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.tabTouchHandler,this),this.tab3.addEventListener(egret.TouchEvent.TOUCH_TAP,this.tabTouchHandler,this);var i=Global.createBitmapByName("p_line_2_png");i.x=0,i.y=100,this.addChild(i),this.loadData()},e.prototype.tabTouchHandler=function(t){t.target==this.tab1?this.tab1.select||(this.tab1.select=!0,this.tab2.select=!1,this.tab3.select=!1,this.index=1,this.cardPage&&(this.removeChild(this.cardPage),this.cardPage=null),this.buyPage&&(this.removeChild(this.buyPage),this.buyPage=null),this.loadData()):t.target==this.tab2?(this.tab2.select||(this.tab1.select=!1,this.tab2.select=!0,this.tab3.select=!1,this.index=2,this.loadData()),this.orderPage&&(this.removeChild(this.orderPage),this.orderPage=null),this.buyPage&&(this.removeChild(this.buyPage),this.buyPage=null)):(this.tab3.select||(this.tab1.select=!1,this.tab2.select=!1,this.tab3.select=!0,this.index=3,this.showPage(this.index)),this.cardPage&&(this.removeChild(this.cardPage),this.cardPage=null),this.orderPage&&(this.removeChild(this.orderPage),this.orderPage=null))},e.prototype.showPage=function(t){1==t?this.initOrder():2==t?this.initCard():this.initBuy()},e.prototype.initBuy=function(){this.buyPage=new BuySendPop,this.addChild(this.buyPage)},e.prototype.initCard=function(){if(this.card){this.cardPage=new egret.DisplayObjectContainer,this.addChild(this.cardPage);var t=new egret.Shape;t.graphics.beginFill(16777215),t.graphics.drawRect(0,106,StageUtils.SW,StageUtils.SH-106),t.graphics.endFill(),this.cardPage.addChild(t);var e=Global.createBitmapByName("btn_tips_1_png");e.x=StageUtils.SW-e.width>>1,e.y=130,this.cardPage.addChild(e),Global.setBut(e),e.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){PopManager.showPop("TipsPop",{url:"personal_tips_bg2_png",callback:function(){}})},this);var i=new egret.DisplayObjectContainer,a=new egret.ScrollView(i);a.width=StageUtils.SW,a.height=StageUtils.SH-175,a.x=0,a.y=175,a.horizontalScrollPolicy="off",this.cardPage.addChild(a);var s=0,o=Global.createBitmapByName("card_type_buy_png");o.x=StageUtils.SW-o.width>>1,i.addChild(o),s+=o.height;for(var n=this.card.length,r=0;n>r;r++)if(this.card[r]){var h=new InfoCardItem(this.card[r],r+1,0);h.y=s+25,i.addChild(h),s+=296}var l=Global.createBitmapByName("card_type_get_png");l.x=StageUtils.SW-l.width>>1,l.y=s+25,i.addChild(l),s+=l.height+25;for(var n=this.esharedlist.length,r=0;n>r;r++)if(this.esharedlist[r]&&this.esharedInfo){var d=this.esharedInfo[r];if(d&&d.length){var h=new InfoCardItem(this.esharedlist[r],r+1,1,d[0]);h.y=s+25,i.addChild(h),s+=296}}var p=Global.createBitmapByName("card_type_out_png");p.x=StageUtils.SW-p.width>>1,p.y=s+25,i.addChild(p),s+=p.height+25;for(var n=this.esharelist.length,r=0;n>r;r++)if(this.esharelist[r]){var h=new InfoCardItem(this.esharelist[r],r+1,2);h.y=s+25,i.addChild(h),s+=285}var t=new egret.Shape;t.graphics.beginFill(0,.001),t.graphics.drawRect(0,0,StageUtils.SW,s),t.graphics.endFill(),i.addChildAt(t,0)}},e.prototype.initOrder=function(){if(this.exchange){this.orderPage=new egret.DisplayObjectContainer,this.addChild(this.orderPage);var t=new egret.DisplayObjectContainer,e=new egret.ScrollView(t);e.width=StageUtils.SW,e.height=StageUtils.SH-106,e.x=22,e.y=106,e.horizontalScrollPolicy="off",this.orderPage.addChild(e);var i=new egret.Shape;i.graphics.beginFill(0,.001),i.graphics.drawRect(0,0,30,30),i.graphics.endFill(),t.addChild(i);for(var a=this.exchange.length,s=0;a>s;s++){var o=new InfoOrderItem(this.exchange[s]);o.y=30+368*s,t.addChild(o)}}},e.prototype.duihuanHandler=function(){PopManager.hidePop("InfoPop"),PopManager.showPop("BuySendPop")},e.prototype.loadData=function(){var t=this;$.ajax({url:Main.USER_INFO_API,data:{type:"personcard",ticket:Main.USER_TICKET},success:function(e){0==e.result?(t.exchange=e.exchange,t.card=e.card,t.esharelist=e.esharelist,t.esharedlist=e.esharedlist,t.esharedInfo=e.eshareid,t.showPage(t.index)):Message.show(e.result)},error:function(){},timeout:8e3,dataType:"json",async:!0,type:"POST",complete:function(t,e){"timeout"==e&&PopManager.showPop("ErrorPop",{url:"resource/assets/asyn/error/error_web.png"})}})},e}(PopView);__reflect(InfoPop.prototype,"InfoPop");var IntoSharePop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setData=function(e){t.prototype.setData.call(this,e);for(var i=e.sharelist,a=i.length,s=0;a>s;s++)if(i[s]){var o=new CustomImage("resource/assets/asyn/moontype/4/"+(s+1)+".png",!0,function(){o.width=StageUtils.SW,o.height=StageUtils.SH});this.addChild(o)}var n=Global.createBitmapByName("btn_share_4_png");n.x=StageUtils.SW-n.width>>1,n.y=StageUtils.SH-235,this.addChild(n),Global.setBut(n),n.addEventListener(egret.TouchEvent.TOUCH_TAP,this.duihuanHandler,this);$.ajax({url:Main.USER_INFO_API,data:{type:"eshareget",ticket:Main.USER_TICKET,eshareinfo:this.data.payorder},success:function(t){},error:function(){},timeout:8e3,dataType:"json",async:!0,type:"POST",complete:function(t,e){"timeout"==e&&PopManager.showPop("ErrorPop",{url:"resource/assets/asyn/error/error_web.png"})}}),setTimeout(function(){PopManager.showPop("TipsPop",{url:"personal_tips_bg1_png",callback:function(){}})},500)},e.prototype.duihuanHandler=function(){PopManager.hidePop("IntoSharePop"),PopManager.showPop("InfoPop")},e}(PopView);__reflect(IntoSharePop.prototype,"IntoSharePop");var BuySendItem=function(t){function e(e){var i=t.call(this)||this;i.num=0;var a=new CustomImage("resource/assets/asyn/moontype/6/"+e+".png",!0,function(){a.x=StageUtils.SW-a.width>>1});i.addChild(a);var s=Global.createBitmapByName("btn_addless_bg_png");s.x=480,s.y=25,i.addChild(s);var o=Global.createBitmapByName("btn_less_png");o.x=450,o.y=25,i.addChild(o);var n=Global.createBitmapByName("btn_add_png");return n.x=533,n.y=25,i.addChild(n),Global.setBut(o),Global.setBut(n),o.addEventListener(egret.TouchEvent.TOUCH_TAP,i.lessHandler,i),n.addEventListener(egret.TouchEvent.TOUCH_TAP,i.addHandler,i),i.txtNum=new egret.TextField,i.txtNum.x=480,i.txtNum.y=26,i.txtNum.textAlign=egret.HorizontalAlign.CENTER,i.txtNum.width=54,i.txtNum.textColor=0,i.addChild(i.txtNum),i.txtNum.text=i.num+"",i}return __extends(e,t),e.prototype.lessHandler=function(){this.num>0&&(this.num--,this.txtNum.text=this.num+"")},e.prototype.addHandler=function(){this.num++,this.txtNum.text=this.num+""},e}(egret.DisplayObjectContainer);__reflect(BuySendItem.prototype,"BuySendItem");var InfoCardItem=function(t){function e(e,i,a,s){void 0===s&&(s=null);var o=t.call(this)||this;o.count=e,o.type=i,o.state=a,o.eshare=s;var n=new CustomImage("resource/assets/asyn/moontype/"+(2==a?8:3)+"/"+i+".png",!0,function(){n.x=StageUtils.SW-n.width>>1});if(o.addChild(n),0==a){var r=Global.createBitmapByName("btn_get1_png");r.x=365,r.y=16,o.addChild(r),Global.setBut(r),r.addEventListener(egret.TouchEvent.TOUCH_TAP,o.getHandler,o)}else if(1==a){var r=Global.createBitmapByName("btn_get_png");r.x=390,r.y=16,o.addChild(r),Global.setBut(r),r.addEventListener(egret.TouchEvent.TOUCH_TAP,o.getHandler,o)}var h=Global.createBitmapByName("num_bg_png");return h.x=297,h.y=16,o.addChild(h),o.txtNum=new egret.TextField,o.txtNum.x=300,o.txtNum.y=22,o.txtNum.textAlign=egret.HorizontalAlign.CENTER,o.txtNum.width=54,o.txtNum.textColor=0,o.addChild(o.txtNum),o.txtNum.text=o.count+"",o}return __extends(e,t),e.prototype.getHandler=function(){this.count&&(PopManager.hidePop("InfoPop"),0==this.state?PopManager.showPop("PersonalPop",{type:1,ptype:this.type,isShare:!0}):PopManager.showPop("PersonalPop",{type:1,ptype:this.type,eshare:this.eshare}))},e}(egret.DisplayObjectContainer);__reflect(InfoCardItem.prototype,"InfoCardItem");var InfoOrderItem=function(t){function e(e){var i=t.call(this)||this;i.data=e;var a=new CustomImage("resource/assets/asyn/info_order_item_bg.png",!0,function(){});i.addChild(a);var s=Global.createBitmapByName("btn_wuliu_png");s.x=450,s.y=215,i.addChild(s),Global.setBut(s),s.addEventListener(egret.TouchEvent.TOUCH_TAP,i.getHandler,i);var o=new egret.TextField;o.x=140,o.y=40,o.textAlign=egret.HorizontalAlign.CENTER,o.textColor=0,o.size=18,i.addChild(o);var n=new egret.TextField;n.x=140,n.y=70,n.textAlign=egret.HorizontalAlign.CENTER,n.textColor=0,n.size=18,i.addChild(n);var r=new egret.TextField;r.x=250,r.y=70,r.textAlign=egret.HorizontalAlign.CENTER,r.textColor=0,r.size=18,i.addChild(r);var h=new egret.TextField;h.x=30,h.y=150,h.textAlign=egret.HorizontalAlign.CENTER,h.textColor=0,h.size=18,i.addChild(h);var l=new egret.TextField;l.x=390,l.y=150,l.textAlign=egret.HorizontalAlign.CENTER,l.textColor=0,l.size=18,i.addChild(l),o.text=(e.province?e.province+"省":"")+e.city+"市"+e.county+" "+e.address,n.text=e.name+"",r.text=e.telephone+"",h.text="订单号:"+e.id,l.text=e.time+"";var d=new CustomImage("resource/assets/asyn/moontype/5/"+e.type+".png",!0,function(){});return d.x=10,d.y=195,i.addChild(d),i}return __extends(e,t),e.prototype.getHandler=function(){this.data&&PopManager.showPop("MailSelectPop",this.data.id)},e}(egret.DisplayObjectContainer);__reflect(InfoOrderItem.prototype,"InfoOrderItem");var InfoShareItem=function(t){function e(e,i){var a=t.call(this)||this,s=new CustomImage("resource/assets/asyn/moontype/3/"+e+".png",!0,function(){});a.addChild(s);var o=Global.createBitmapByName("num_bg_png");return o.x=420,o.y=20,a.addChild(o),a.txtNum=new egret.TextField,a.txtNum.x=424,a.txtNum.y=26,a.txtNum.textAlign=egret.HorizontalAlign.CENTER,a.txtNum.width=54,a.txtNum.textColor=0,a.addChild(a.txtNum),a.txtNum.text=i+"",a}return __extends(e,t),e}(egret.DisplayObjectContainer);__reflect(InfoShareItem.prototype,"InfoShareItem");var MailItem=function(t){function e(){var e=t.call(this)||this;return e.bg=new egret.Shape,e.addChild(e.bg),e.txtContent=new egret.TextField,e.txtContent.textColor=5658198,e.txtContent.size=24,e.txtContent.x=100,e.txtContent.y=20,e.txtContent.text="",e.txtContent.multiline=!0,e.txtContent.width=510,e.txtContent.lineSpacing=5,e.addChild(e.txtContent),e.txtTime=new egret.TextField,e.txtTime.textColor=5658198,e.txtTime.size=20,e.txtTime.x=100,e.txtTime.y=85,e.txtTime.text="",e.addChild(e.txtTime),e.icon=Global.createBitmapByName("mail_item_2_png"),e.icon.x=40,e.icon.y=25,e.addChild(e.icon),e.line=Global.createBitmapByName("mail_item_3_png"),e.line.x=85,e.line.y=120,e.addChild(e.line),e}return __extends(e,t),e.prototype.setData=function(t,e){0==t?(this.txtContent.textColor=16741155,this.txtTime.textColor=16741155,this.icon.texture=RES.getRes("mail_item_1_png")):(this.txtContent.textColor=4473924,this.txtTime.textColor=8684676,this.icon.texture=RES.getRes("mail_item_2_png")),this.txtContent.text=e.AcceptStation+"",this.txtTime.text=e.AcceptTime+"",this.txtTime.y=this.txtContent.y+this.txtContent.height+15,this.line.y=this.txtTime.y+this.txtTime.height+10,this.bg.graphics.beginFill(0,.001),this.bg.graphics.drawRect(0,0,StageUtils.SW,this.line.y+this.line.height),this.bg.graphics.endFill(),this.h=this.height},e}(egret.DisplayObjectContainer);__reflect(MailItem.prototype,"MailItem");var MailSelectPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setData=function(e){t.prototype.setData.call(this,e);var i=new egret.Shape;i.graphics.beginFill(16777215),i.graphics.drawRect(0,0,StageUtils.SW,170),i.graphics.drawRect(0,200,StageUtils.SW,StageUtils.SH-200-146),i.graphics.endFill(),this.addChild(i);var a=new egret.Shape;a.graphics.beginFill(15987699),a.graphics.drawRect(0,170,StageUtils.SW,30),a.graphics.drawRect(0,StageUtils.SH-146,StageUtils.SW,146),a.graphics.endFill(),this.addChild(a);var s=new egret.TextField;s.text="订单状态：",s.textColor=0,s.x=40,s.y=40,this.addChild(s),this.txtState=new egret.TextField,this.txtState.textColor=16741155,this.txtState.x=190,this.txtState.y=40,this.txtState.text="",this.addChild(this.txtState);var o=new egret.TextField;o.text="配送方式：",o.textColor=5658198,o.size=24,o.x=40,o.y=83,this.addChild(o),this.txtName=new egret.TextField,this.txtName.textColor=5658198,this.txtName.size=24,this.txtName.x=160,this.txtName.y=83,this.txtName.text="中国邮政速递物流",this.addChild(this.txtName);var n=new egret.TextField;n.text="时间：",n.textColor=5658198,n.size=24,n.x=40,n.y=123,this.addChild(n),this.txtTime=new egret.TextField,this.txtTime.textColor=5658198,this.txtTime.size=24,this.txtTime.x=110,this.txtTime.y=123,this.txtTime.text="",this.addChild(this.txtTime),this.container=new egret.DisplayObjectContainer;var r=new egret.ScrollView(this.container);r.width=StageUtils.SW,r.height=StageUtils.SH-200-146,r.x=0,r.y=200,r.horizontalScrollPolicy="off",this.addChild(r);var h=Global.createBitmapByName("mail_close_png");h.x=StageUtils.SW-h.width>>1,h.y=StageUtils.SH-105,this.addChild(h),Global.setBut(h),h.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeHandler,this),this.loadData(e)},e.prototype.closeHandler=function(){PopManager.hidePop("MailSelectPop")},e.prototype.loadData=function(t){var e=this;$.ajax({url:Main.USER_INFO_API,data:{type:"wuliu",ticket:Main.USER_TICKET,exchangeid:t},success:function(t){if(0==t.result){if(t.trace){var i=JSON.parse(t.trace);if(i){i.reverse();for(var a,s=i.length,o=0,n=0;s>n;n++)if(a=i[n]){var r=new MailItem;r.setData(n,a),r.y=o,e.container.addChild(r),o+=r.h}a&&(e.txtTime.text=a.AcceptTime.substr(0,10)+"")}}e.txtState.text=t.status+""}else Message.show(t.result)},error:function(){},timeout:8e3,dataType:"json",async:!0,type:"POST",complete:function(t,e){"timeout"==e&&PopManager.showPop("ErrorPop",{url:"resource/assets/asyn/error/error_web.png"})}})},e}(PopView);__reflect(MailSelectPop.prototype,"MailSelectPop");var OrderOKPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setData=function(e){t.prototype.setData.call(this,e);var i=new CustomImage("resource/assets/asyn/order_bg.png",!0,function(){i.width=StageUtils.SW,i.height=StageUtils.SH});this.addChild(i);var a=Global.createBitmapByName("btn_buy_gift_png");a.x=StageUtils.SW-a.width>>1,a.y=StageUtils.SH-165,this.addChild(a),Global.setBut(a),a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.duihuanHandler,this);var s=new egret.TextField;s.x=0,s.y=200,s.width=StageUtils.SW,s.size=36,s.textAlign=egret.HorizontalAlign.CENTER,s.text=e+"",s.textColor=0,this.addChild(s)},e.prototype.duihuanHandler=function(){PopManager.hidePop("OrderOKPop"),PopManager.showPop("InfoPop",3)},e}(PopView);__reflect(OrderOKPop.prototype,"OrderOKPop");var PersonalPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setData=function(e){t.prototype.setData.call(this,e);var i=new CustomImage("resource/assets/asyn/moontype/1/"+e.ptype+".png",!0,function(){i.width=StageUtils.SW,i.height=StageUtils.SH});this.addChild(i);var a=Global.createBitmapByName("btn_duihuan_png");if(a.x=StageUtils.SW-a.width>>1,a.y=StageUtils.SH-205,this.addChild(a),Global.setBut(a),e.isShare){a.x=36;var s=Global.createBitmapByName("btn_share_png");s.x=StageUtils.SW-s.width-36,s.y=StageUtils.SH-205,this.addChild(s),Global.setBut(s),s.addEventListener(egret.TouchEvent.TOUCH_TAP,this.shareHandler,this),console.log("true")}else console.log("skip"),a.x=StageUtils.SW-a.width>>1;a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.duihuanHandler,this)},e.prototype.duihuanHandler=function(){PopManager.hidePop("PersonalPop"),PopManager.showPop("AddressPop",this.data)},e.prototype.shareHandler=function(){if(console.log("shareClick"),this.data)if(0==this.data.type){$.ajax({url:Main.USER_INFO_API,data:{type:"pshare",ticket:Main.USER_TICKET,ptype:this.data.ptype},success:function(t){0==t.result?(PopManager.hidePop("PersonalPop"),PopManager.showPop("SharePop",{code:t.code})):Message.show(t.result)},error:function(){},timeout:8e3,dataType:"json",async:!0,type:"POST",complete:function(t,e){"timeout"==e&&PopManager.showPop("ErrorPop",{url:"resource/assets/asyn/error/error_web.png"})}})}else{$.ajax({url:Main.USER_INFO_API,data:{type:"eshare",ticket:Main.USER_TICKET,ptype:this.data.ptype},success:function(t){0==t.result?(PopManager.hidePop("PersonalPop"),PopManager.showPop("SharePop",{eshareinfo:t.eshareinfo,time:t.sharetime})):Message.show(t.result)},error:function(){},timeout:8e3,dataType:"json",async:!0,type:"POST",complete:function(t,e){"timeout"==e&&PopManager.showPop("ErrorPop",{url:"resource/assets/asyn/error/error_web.png"})}})}},e}(PopView);__reflect(PersonalPop.prototype,"PersonalPop");var SharePop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setData=function(e){t.prototype.setData.call(this,e),Main.showShare();var i=new CustomImage("resource/assets/asyn/share_bg.png",!0,function(){i.width=StageUtils.SW,i.height=StageUtils.SH});this.addChild(i),void 0!=e&&(e.code?Main.share(e.code):Main.share("http://res.leasiondata.cn/lstatic/wxShare/weixin-share.html?"+e.eshareinfo,e.eshareinfo,e.time))},e}(PopView);__reflect(SharePop.prototype,"SharePop");var DetailItem=function(t){function e(){var e=t.call(this)||this,i=new egret.Shape;i.graphics.beginFill(16777215,.001),i.graphics.drawRect(0,0,StageUtils.SW,385),i.graphics.endFill(),e.addChild(i);var a=Global.createBitmapByName("line_2_png");return a.x=0,a.y=380,e.addChild(a),e}return __extends(e,t),e.prototype.setData=function(t,e){this.imgSale=Global.createBitmapByName("select_sale_"+t+"_png"),this.imgSale.x=45,this.imgSale.y=385-this.imgSale.height>>1,this.addChild(this.imgSale);var i=Global.createBitmapByName("line_3_png");i.x=180,i.y=95,this.addChild(i);var i=Global.createBitmapByName("line_3_png");i.x=180,i.y=190,this.addChild(i);var i=Global.createBitmapByName("line_3_png");i.x=180,i.y=285,this.addChild(i);for(var a=e.length,s=0;a>s;s++){var o=new DetailSimpleItem;o.setData(e[s]),o.x=180,o.y=30+97*s,this.addChild(o)}},e}(egret.DisplayObjectContainer);__reflect(DetailItem.prototype,"DetailItem");var DetailSimpleItem=function(t){function e(){var e=t.call(this)||this;return e.txtName=new egret.TextField,e.txtName.x=0,e.txtName.y=0,e.txtName.textColor=469575,e.addChild(e.txtName),e.txtCount=new egret.TextField,e.txtCount.x=180,e.txtCount.y=3,e.txtCount.textColor=469575,e.txtCount.width=100,e.txtCount.textAlign="center",e.txtCount.size=24,e.addChild(e.txtCount),e.txtPrice=new egret.TextField,e.txtPrice.x=310,e.txtPrice.y=3,e.txtPrice.textColor=16730368,e.txtPrice.width=120,e.txtPrice.textAlign="right",e.txtPrice.size=24,e.addChild(e.txtPrice),e}return __extends(e,t),e.prototype.setData=function(t){this.txtName.text=decodeURI(t.name)+"",this.txtCount.text=t.cnt+"",this.txtPrice.text=t.price+""},e}(egret.DisplayObjectContainer);__reflect(DetailSimpleItem.prototype,"DetailSimpleItem");var DetailView=function(t){function e(){var e=t.call(this)||this,i=Global.createBitmapByName("select_title_png");i.x=0,i.y=0,e.addChild(i),e.container=new egret.DisplayObjectContainer;var a=new egret.ScrollView(e.container);a.width=640,a.height=StageUtils.SH-300-90,a.x=0,a.y=64,a.horizontalScrollPolicy="off",e.addChild(a);var s=Global.createBitmapByName("select_down_png");s.x=0,s.y=StageUtils.SH-s.height-240,e.addChild(s);var o=new egret.TextField;o.x=97,o.y=StageUtils.SH-300,o.text="总计：",e.addChild(o);var n=new egret.TextField;n.x=o.x+90,n.y=StageUtils.SH-300,n.textColor=16758400,e.addChild(n);var r=new egret.TextField;r.x=325,r.y=StageUtils.SH-300,r.text="总价：",e.addChild(r);var h=new egret.TextField;return h.x=r.x+90,h.y=StageUtils.SH-300,h.textColor=16758400,e.addChild(h),n.text="300盒",h.text="￥500000.00",e.txtZongJi=n,e.txtZongJia=h,e.getData(),e}return __extends(e,t),e.prototype.getData=function(){var t=this;$.ajax({url:Main.USER_INFO_API,data:{type:"querysum",ticket:Main.USER_TICKET},success:function(e){0==e.result?(t.txtZongJi.text=e.sumcnt+"盒",t.txtZongJia.text="￥"+e.sumprice,t.parent.txtName.text="【账户名："+e.username+"】",t.setData(e.discount)):PopManager.showPop("ErrorPop",{url:"resource/assets/asyn/error/error_web.png"})},error:function(){PopManager.showPop("ErrorPop",{url:"resource/assets/asyn/error/error_web.png"})},timeout:8e3,dataType:"json",async:!0,type:"POST",complete:function(t,e){"timeout"==e&&PopManager.showPop("ErrorPop",{url:"resource/assets/asyn/error/error_web.png"})}})},e.prototype.setData=function(t){if(t){var e=0;for(var i in t){var a=new DetailItem;a.setData(i,t[i]),a.x=0,a.y=385*e,this.container.addChild(a),e++}}},e}(egret.DisplayObjectContainer);__reflect(DetailView.prototype,"DetailView");var DownView=function(t){function e(){var e=t.call(this)||this,i=Global.createBitmapByName("select_tips1_png");e.addChild(i);var a=Global.createBitmapByName("select_down_bg_png");a.x=0,a.y=130,e.addChild(a);var s=Global.createBitmapByName("btn_select_sendmail_png");return s.x=316,s.y=263,e.addChild(s),Global.setBut(s),s.addEventListener(egret.TouchEvent.TOUCH_TAP,e.sendHandler,e),e.txtMail=new egret.TextField,e.txtMail.width=260,e.txtMail.fontFamily="微软雅黑",e.txtMail.type=egret.TextFieldType.INPUT,e.txtMail.x=40,e.txtMail.y=283,e.txtMail.text="请输入邮箱帐号",e.txtMail.size=24,e.txtMail.textColor=12830150,e.txtMail.maxChars=50,e.addChild(e.txtMail),e.txtMail.addEventListener(egret.FocusEvent.FOCUS_IN,e.mailFocusInHandler,e),e.txtMail.addEventListener(egret.FocusEvent.FOCUS_OUT,e.mailFocusOutHandler,e),e}return __extends(e,t),e.prototype.downHandler=function(){},e.prototype.downloadFile=function(t){try{var e=document.createElement("iframe");e.src=t,e.style.display="none",document.body.appendChild(e)}catch(i){}},e.prototype.sendHandler=function(){var t=this.txtMail.text,e=/^([a-zA-Z0-9_\.\-])+@([a-zA-Z0-9_-])+((.[a-zA-Z0-9_-]{2,3}){1,2})$/;t&&"请输入邮箱帐号"!=t?e.test(t)?(Message.show("即将发送!"),$.ajax({type:"POST",dataType:"json",url:Main.USER_INFO_API,data:{type:"report",email:t,ticket:Main.USER_TICKET},success:function(t){0==t.result?(console.log(t),Message.show("发送成功!")):Message.show("发送失败!")},error:function(){},async:!0})):Message.show("邮箱格式不正确!"):Message.show("请输入邮箱帐号!")},e.prototype.mailFocusInHandler=function(){"请输入邮箱帐号"==this.txtMail.text&&(this.txtMail.text="")},e.prototype.mailFocusOutHandler=function(){""==this.txtMail.text&&(this.txtMail.text="请输入邮箱帐号")},e}(egret.DisplayObjectContainer);__reflect(DownView.prototype,"DownView");var SelectLoginPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.loginOK=function(){PopManager.hidePop("SelectLoginPop"),PopManager.showPop("SelectPop")},e}(LoginPop);__reflect(SelectLoginPop.prototype,"SelectLoginPop");var SelectPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setData=function(e){t.prototype.setData.call(this,e);var i=new egret.Shape;i.graphics.beginFill(16777215),i.graphics.drawRect(0,0,StageUtils.SW,StageUtils.SH),i.graphics.endFill(),this.addChild(i),this.initContent()},e.prototype.initContent=function(){this.sp1=new egret.Sprite,this.sp1.graphics.beginFill(0,.001),this.sp1.graphics.drawRect(0,0,320,95),this.sp1.graphics.endFill(),this.addChild(this.sp1),this.txtContent1=new egret.TextField,this.txtContent1.text="付款明细",this.txtContent1.size=36,this.txtContent1.x=this.sp1.width-this.txtContent1.width>>1,this.txtContent1.y=this.sp1.height-this.txtContent1.height>>1,this.txtContent1.textColor=16730368,this.sp1.addChild(this.txtContent1),this.sp2=new egret.Sprite,this.sp2.graphics.beginFill(0,.001),this.sp2.graphics.drawRect(0,0,320,95),this.sp2.graphics.endFill(),this.sp2.x=320,this.addChild(this.sp2),this.txtContent2=new egret.TextField,this.txtContent2.text="下载表格",this.txtContent2.size=36,this.txtContent2.x=this.sp2.width-this.txtContent2.width>>1,this.txtContent2.y=this.sp2.height-this.txtContent2.height>>1,this.txtContent2.textColor=3291453,this.sp2.addChild(this.txtContent2),this.sp1.touchEnabled=!0,this.sp2.touchEnabled=!0,this.sp1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.spHandler,this),this.sp2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.spHandler,this);var t=Global.createBitmapByName("line_2_png");t.x=0,t.y=91,this.addChild(t),this.line1=Global.createBitmapByName("line_1_png"),this.line1.x=0,this.line1.y=95,this.addChild(this.line1),this.txtName=new egret.TextField,this.txtName.width=StageUtils.SW,this.txtName.x=0,this.txtName.y=150,this.txtName.textColor=469575,this.txtName.textAlign="center",this.addChild(this.txtName),this.txtName.text="【账户名：华美】",this.showView(0)},e.prototype.spHandler=function(t){t.target==this.sp1?(this.txtContent1.textColor=16730368,this.txtContent2.textColor=3291453,this.line1.x=0,this.showView(0)):(this.txtContent1.textColor=3291453,this.txtContent2.textColor=16730368,this.line1.x=320,this.showView(1))},e.prototype.showView=function(t){0==t?(this.detail||(this.detail=new DetailView,this.detail.x=StageUtils.SW-this.detail.width>>1,this.detail.y=240,this.addChild(this.detail)),this.detail.visible=!0,this.down&&(this.down.visible=!1)):(this.down||(this.down=new DownView,this.down.x=StageUtils.SW-this.down.width>>1,this.down.y=240,this.addChild(this.down)),this.down.visible=!0,this.detail&&(this.detail.visible=!1))},e}(PopView);__reflect(SelectPop.prototype,"SelectPop");var TipsPop=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.show=function(){var t=new egret.Shape;t.graphics.beginFill(0,.7),t.graphics.drawRect(0,0,StageUtils.stage.stageWidth,StageUtils.stage.stageHeight),t.graphics.endFill(),this.addChildAt(t,0),t.alpha=0,Global.fadeIn(t),UIManager.instance.popLayer.addChild(this),this.touchEnabled=!0},e.prototype.setData=function(e){t.prototype.setData.call(this,e);var i=Global.createBitmapByName(e.url);i.x=StageUtils.SW-i.width>>1,i.y=StageUtils.SH-i.height>>1,this.addChild(i),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchHandler,this)},e.prototype.touchHandler=function(){PopManager.hidePop("TipsPop"),this.data.callback&&this.data.callback()},e}(PopView);__reflect(TipsPop.prototype,"TipsPop");